<!-- TNT — /laws/index.html
     LAWS · CANONICAL (7 LAWS) · 4 LENSES · 3 LANG (EN/中文/ES) · MOBILE SAFE · DENSE
     LENSES (NO NEW gd_* KEYS):
       - INFORMAL   = style=informal & depth=explore
       - FORMAL     = style=formal   & depth=explore
       - PLATFORM   = style=informal & depth=learn
       - ENGINEERING= style=formal   & depth=learn
     RULES:
       - Accordion only (no modals/overlays)
       - Single-open accordion (auto-close others)
       - Red signal gradient + diamond markers
       - Canon state carry: lang/style/time/depth via URL + LS gd_*
       - Uses ui.css + branch.css + instruments.js
       - Does NOT style html/body background (ui.css owns field)
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>LAWS · Canonical</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
body::before,body::after{pointer-events:none!important}

/* ===== TOKENS ===== */
:root{
  --dockH:92px;

  /* dark opal + red signal (no washed-out blue) */
  --opalA:rgba(210,190,255,.14);
  --opalB:rgba(120,70,255,.10);
  --sigR:rgba(255,70,70,.18);
  --sigR2:rgba(255,70,70,.12);
  --goldSoft:rgba(212,175,55,.32);

  --inkA:rgba(12,22,38,.92);
  --inkB:rgba(6,10,16,.96);

  --stroke:rgba(255,255,255,.12);
  --stroke2:rgba(255,255,255,.10);

  --txt:rgba(255,255,255,.90);
  --mut:rgba(255,255,255,.78);
  --mut2:rgba(255,255,255,.70);

  --fsH:28px;   /* typographic expansion */
  --fsP:14.5px;
  --fsS:13px;
}

/* ===== TOP CONTROLS ===== */
.top{
  position:fixed;top:16px;left:0;right:0;
  padding:0 16px;
  display:flex;justify-content:space-between;align-items:center;
  gap:12px;
  z-index:240;
  pointer-events:none;
}
.top .left,.top .right{
  display:flex;gap:10px;align-items:center;
  flex-wrap:nowrap;white-space:nowrap;
  pointer-events:auto;
}
.top .btn{white-space:nowrap}

/* ===== PAGE ===== */
.page{
  width:min(1120px,94vw);
  margin:0 auto;
  padding:84px 0 calc(var(--dockH) + 18px);
  display:flex;
  flex-direction:column;
  gap:12px;
  position:relative;
  z-index:10;
}

/* ===== HEADER ===== */
.header{
  border:1px solid var(--stroke);
  border-radius:22px;
  background:
    radial-gradient(circle at 18% 22%, var(--opalA), transparent 72%),
    radial-gradient(circle at 82% 30%, var(--opalB), transparent 74%),
    radial-gradient(circle at 55% 110%, var(--sigR2), transparent 62%),
    linear-gradient(160deg, rgba(0,0,0,.30), rgba(0,0,0,.14));
  backdrop-filter:blur(10px);
  box-shadow:0 24px 80px rgba(0,0,0,.55);
  padding:16px 16px 14px;
  position:relative;
  overflow:hidden;
}
.header::before{
  content:"";
  position:absolute;inset:0;padding:1px;border-radius:22px;
  background:linear-gradient(120deg, transparent 0%, rgba(255,90,90,.28) 50%, transparent 100%);
  opacity:.45;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.k{margin:0 0 6px;font-size:11px;letter-spacing:4px;text-transform:uppercase;opacity:.74}
.t{margin:0;font-weight:950;font-size:var(--fsH);letter-spacing:.7px;line-height:1.12}
.s{margin:10px 0 0;font-size:var(--fsP);opacity:.92;line-height:1.55;color:var(--txt);max-width:980px}
.fine{margin-top:10px;font-size:12.5px;opacity:.74;line-height:1.45;color:var(--mut)}
.rule{
  margin-top:12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 22% 18%, rgba(255,255,255,.08), transparent 58%),
    linear-gradient(160deg, rgba(12,22,38,.55), rgba(6,10,16,.70));
  padding:12px 12px 10px;
  color:rgba(255,255,255,.86);
  font-size:13px;
  line-height:1.5;
}

/* ===== LENSES (4) ===== */
.lensRow{
  margin-top:12px;
  display:flex;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.pills{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:linear-gradient(145deg, rgba(17,22,28,.92), rgba(11,15,20,.96));
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;
  font-weight:950;
  letter-spacing:.2px;
  color:#fff;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}
.pill.active{
  border-color:rgba(255,90,90,.55);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 16px var(--sigR);
}
.pill.dim{border-color:rgba(212,175,55,.22)}
.pill.dim.active{
  border-color:rgba(255,90,90,.55);
}

/* ===== BAND ===== */
.band{
  padding:10px 12px;
  border-radius:18px;
  border:1px solid var(--stroke2);
  background:rgba(0,0,0,.14);
  font-weight:950;
  letter-spacing:.2px;
  color:rgba(255,255,255,.88);
}

/* ===== ACCORDION ===== */
.list{display:flex;flex-direction:column;gap:12px}

.row{
  position:relative;
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:
    radial-gradient(circle at 22% 18%, rgba(255,255,255,.10), transparent 58%),
    radial-gradient(circle at 78% 30%, rgba(210,190,255,.10), transparent 62%),
    radial-gradient(circle at 62% 92%, rgba(255,70,70,.06), transparent 64%),
    linear-gradient(145deg, rgba(17,22,28,.86), rgba(11,15,20,.92));
  box-shadow:0 16px 52px rgba(0,0,0,.60);
  overflow:hidden;
}
.head{
  display:flex;align-items:flex-start;justify-content:space-between;
  gap:10px;
  padding:14px 16px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.left{display:flex;align-items:flex-start;gap:12px;min-width:0}
.marker{
  display:flex;flex-direction:column;align-items:center;gap:8px;
  margin-top:2px;flex:0 0 auto;
}
.diamond{
  width:10px;height:10px;border-radius:3px;transform:rotate(45deg);
  background:var(--c);
  box-shadow:0 0 0 1px rgba(255,255,255,.14), 0 0 14px rgba(0,0,0,.35);
}
.bar{
  width:6px;height:22px;border-radius:99px;background:var(--c);
  box-shadow:0 0 18px rgba(0,0,0,.25);
}
.titleBlock{min-width:0}
.title{
  font-weight:950;
  letter-spacing:.25px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  font-size:16px;
}
.sub{
  margin-top:6px;
  font-size:13px;
  opacity:.84;
  line-height:1.38;
  max-width:92ch;
  color:rgba(255,255,255,.86);
}
.chev{font-size:16px;opacity:.75;flex:0 0 auto;margin-top:2px}

.body{
  display:none;
  padding:14px 16px 16px;
  border-top:1px solid rgba(255,255,255,.08);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
}
.row.open .body{display:block}

.p{
  margin:0;
  color:rgba(255,255,255,.90);
  line-height:1.7;
  font-size:14.25px;
}
.p + .p{margin-top:10px}
.ul{
  margin:10px 0 0 18px;padding:0;
  color:rgba(255,255,255,.82);
  line-height:1.55;
  font-size:13.5px;
}
.ul li{margin:6px 0}

.smallband{
  margin-top:12px;
  padding:9px 10px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.14);
  font-weight:950;
  letter-spacing:.15px;
  color:rgba(255,255,255,.86);
  font-size:13px;
}

.actions{
  display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;margin-top:12px;
}
.actions .btn{padding:10px 12px;border-radius:999px;white-space:nowrap}

/* ===== DOCK ===== */
.dock{
  position:fixed;left:50%;
  bottom:max(10px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:220;
  width:min(980px,94vw);
  padding:10px 12px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  backdrop-filter:blur(10px);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  display:grid;
  grid-template-columns:repeat(4, minmax(0,1fr));
  gap:10px;
}
.dock .btn{width:100%;padding:10px 10px;border-radius:999px;white-space:nowrap}
@media (max-width:520px){
  :root{--dockH:104px;--fsH:27px;--fsP:14.25px}
  .dock{grid-template-columns:repeat(3, minmax(0,1fr))}
  .title{font-size:15.5px}
}
</style>
</head>

<body>

<div class="top" aria-label="Top controls">
  <div class="left">
    <a class="btn" id="btnDoor" href="/door/">DOOR</a>
    <a class="btn" id="btnPrelude" href="/prelude/">PRELUDE</a>
    <a class="btn" id="btnHome" href="/home/">HOME</a>
  </div>
  <div class="right" aria-label="Language">
    <button class="btn" id="btnEN" type="button">EN</button>
    <button class="btn" id="btnZH" type="button">中文</button>
    <button class="btn" id="btnES" type="button">ES</button>
  </div>
</div>

<div class="page">

  <div class="header" aria-label="Header">
    <p class="k" id="hk">LAWS</p>
    <h1 class="t" id="ht">THE RULES THAT KEEP BIG IDEAS HONEST</h1>
    <p class="s" id="hs"></p>
    <div class="rule" id="ruleTop"></div>
    <div class="fine" id="fine"></div>

    <div class="lensRow" aria-label="Lenses">
      <div class="pills">
        <button class="pill active" id="pillInformal" type="button">INFORMAL</button>
        <button class="pill" id="pillFormal" type="button">FORMAL</button>
        <button class="pill dim" id="pillPlatform" type="button">PLATFORM</button>
        <button class="pill dim" id="pillEngineering" type="button">ENGINEERING</button>
      </div>
      <div class="pills">
        <span class="fine" id="lensState">—</span>
      </div>
    </div>
  </div>

  <div class="band" id="band">CANONICAL LAWS (7)</div>
  <div class="list" id="list"></div>

</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="dockIndex" href="/index.html">INDEX</a>
  <a class="btn" id="dockExplore" href="/explore/">EXPLORE</a>
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<script>
(function(){
  // ===== canonical state (NO NEW gd_* KEYS) =====
  var qs=new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "informal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  var depth = qs.get("depth") || localStorage.getItem("gd_depth") || "explore";

  if(lang!=="en" && lang!=="zh" && lang!=="es") lang="en";
  if(style!=="formal" && style!=="informal") style="informal";
  if(time==="trajectory") time="post";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";
  if(depth!=="explore" && depth!=="learn") depth="explore";

  try{
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);
    localStorage.setItem("gd_depth",depth);
  }catch(e){}

  document.documentElement.lang=(lang==="zh")?"zh":(lang==="es")?"es":"en";

  // ===== lens mapping (4 lenses using existing keys only) =====
  // INFORMAL    => style=informal depth=explore
  // FORMAL      => style=formal   depth=explore
  // PLATFORM    => style=informal depth=learn
  // ENGINEERING => style=formal   depth=learn
  function lensKey(){
    if(style==="formal" && depth==="learn") return "engineering";
    if(style==="informal" && depth==="learn") return "platform";
    if(style==="formal") return "formal";
    return "informal";
  }

  function setLens(k){
    if(k==="engineering"){ style="formal"; depth="learn"; }
    else if(k==="platform"){ style="informal"; depth="learn"; }
    else if(k==="formal"){ style="formal"; depth="explore"; }
    else { style="informal"; depth="explore"; }

    try{
      localStorage.setItem("gd_style",style);
      localStorage.setItem("gd_depth",depth);
    }catch(e){}

    // update URL without losing other state
    window.location.href = window.location.pathname + q();
  }

  function q(over){
    var L=(over&&over.lang)?over.lang:lang;
    var S=(over&&over.style)?over.style:style;
    var T=(over&&over.time)?over.time:time;
    var D=(over&&over.depth)?over.depth:depth;
    return "?lang="+encodeURIComponent(L)+
           "&style="+encodeURIComponent(S)+
           "&time="+encodeURIComponent(T)+
           "&depth="+encodeURIComponent(D);
  }

  // ===== wire nav =====
  function wire(id,path){
    var el=document.getElementById(id);
    if(el) el.href = path + q();
  }
  wire("btnDoor","/door/");
  wire("btnPrelude","/prelude/");
  wire("btnHome","/home/");

  wire("dockIndex","/index.html");
  wire("dockExplore","/explore/");
  wire("dockProducts","/products/");
  wire("dockGauges","/gauges/");

  // ===== language toggle (reload same path) =====
  var btnEN=document.getElementById("btnEN");
  var btnZH=document.getElementById("btnZH");
  var btnES=document.getElementById("btnES");

  function paintLang(){
    btnEN.classList.toggle("active", lang==="en");
    btnZH.classList.toggle("active", lang==="zh");
    btnES.classList.toggle("active", lang==="es");
  }
  paintLang();

  function setLang(next){
    if(next!=="en" && next!=="zh" && next!=="es") next="en";
    lang=next;
    try{ localStorage.setItem("gd_lang",lang); }catch(e){}
    window.location.href = window.location.pathname + q({lang:lang});
  }
  btnEN.addEventListener("click", function(){ setLang("en"); });
  btnZH.addEventListener("click", function(){ setLang("zh"); });
  btnES.addEventListener("click", function(){ setLang("es"); });

  // ===== lens buttons =====
  var pillInformal=document.getElementById("pillInformal");
  var pillFormal=document.getElementById("pillFormal");
  var pillPlatform=document.getElementById("pillPlatform");
  var pillEngineering=document.getElementById("pillEngineering");

  function paintLens(){
    var k=lensKey();
    pillInformal.classList.toggle("active", k==="informal");
    pillFormal.classList.toggle("active", k==="formal");
    pillPlatform.classList.toggle("active", k==="platform");
    pillEngineering.classList.toggle("active", k==="engineering");

    var label = (lang==="zh")
      ? (k==="informal"?"通俗":"") + (k==="formal"?"正式":"") + (k==="platform"?"平台":"") + (k==="engineering"?"工程":"")
      : (lang==="es")
        ? (k==="informal"?"INFORMAL":k==="formal"?"FORMAL":k==="platform"?"PLATAFORMA":"INGENIERÍA")
        : (k==="informal"?"INFORMAL":k==="formal"?"FORMAL":k==="platform"?"PLATFORM":"ENGINEERING");

    document.getElementById("lensState").textContent =
      (lang==="zh") ? ("当前透镜："+label) :
      (lang==="es") ? ("Lente actual: "+label) :
      ("Current lens: "+label);
  }
  paintLens();

  pillInformal.addEventListener("click", function(){ setLens("informal"); });
  pillFormal.addEventListener("click", function(){ setLens("formal"); });
  pillPlatform.addEventListener("click", function(){ setLens("platform"); });
  pillEngineering.addEventListener("click", function(){ setLens("engineering"); });

  // ===== COPY PACKS =====
  function P(en,zh,es){ return {en:en, zh:zh, es:es}; }
  function pick(o){ return (lang==="zh")?o.zh:(lang==="es")?(o.es||o.en):o.en; }

  var HEAD = {
    en:{
      hs:"What’s the loudest claim you can make *without lying*? That question is the whole point of this site. These laws keep every big idea support-bounded—so curiosity can scale without collapsing into hype.",
      rule:"Rule: big claims are welcome. Unbounded claims are not. Every upgrade requires receipts. Every correction creates a new epoch.",
      fine:"Tip: Use the lens buttons above. Informal is TED-style. Formal is specification. Platform is user-flow + navigation contracts. Engineering is boundary-first constraints."
    },
    zh:{
      hs:"什么是你能说出的最大主张，却又不会撒谎？这就是本网站的核心。以下法则把一切大想法都锁在“可支撑边界”内，让好奇心可以扩张而不会坍塌成噱头。",
      rule:"规则：欢迎大主张；不允许无界主张。任何升级都需要收据；任何修正都会开启新纪元。",
      fine:"提示：上方透镜可切换。通俗=TED式；正式=规格；平台=用户路径/导航契约；工程=边界优先约束。"
    },
    es:{
      hs:"¿Cuál es la afirmación más grande que puedes hacer *sin mentir*? Esa es la idea central. Estas leyes mantienen todo acotado por soporte para que la curiosidad escale sin colapsar en hype.",
      rule:"Regla: se permiten ideas grandes. No se permiten afirmaciones sin límites. Toda mejora requiere recibos. Toda corrección crea nueva época.",
      fine:"Consejo: usa los lentes. Informal = TED. Formal = especificación. Plataforma = flujo/contratos. Ingeniería = límites/constraints."
    }
  };

  // 7 laws (canonical) — each provides: title/sub + per-lens paragraphs + bullets + binds
  var LAWS = [
    {
      id:"coherence",
      c:"#EF4444",
      t:P("Coherence Constraint Law","一致性约束法则","Ley de Restricción de Coherencia"),
      s:P("You can’t project more trust outward than you hold inward—under the same evidence.","同证据下：外部信任不可能超过内部自洽。","No puedes proyectar más confianza hacia afuera de la que sostienes adentro—con la misma evidencia."),
      blocks:{
        informal:{
          p:[
            "If your words and actions don’t match, the world eventually notices—especially under pressure. Coherence is not a vibe. It’s the measurable gap between what you say, what you do, and what happens next.",
            "This law is the ‘gravity’ behind the whole stack: it tells you how far you can go before your own mismatch pulls you back down."
          ],
          ul:["Signal: mismatch grows when you scale.","Signal: confusion accelerates instability once present.","Output: contain first when mismatch rises."],
          bind:"Binds to: Diagnostic · Laws · Gauges."
        },
        formal:{
          p:[
            "Coherence is bounded by preservation of declared invariants under declared measurement rules. External trust, honesty, and respect cannot exceed internal self-consistency under identical scope and evidence.",
            "Confusion is an accelerator once instability exists. Fragmentation (value/action/outcome mismatch) is the measurable marker of coherence loss."
          ],
          ul:["Invariant: same evidence → same admissibility.","No intent inference: observed behavior only.","Correction ⇒ new epoch; no retroactive edits."],
          bind:"Binds to: Observer-invariant evaluation · Receipt chain."
        },
        platform:{
          p:[
            "Platform lens: coherence is how the site stays calm. Every page must route you to the next clean step: proof (Laws) or measurement (Gauges) or adoption (Products). No loops that inflate meaning.",
            "If a page can be misread, it will be misread. This law forces the UI to be honest: one tap, one outcome, with state preserved."
          ],
          ul:["Contract: stable labels across pages.","Contract: state carry is mandatory.","Contract: no silent remaps or hidden layers."],
          bind:"Binds to: DOOR/INDEX routing contract · state keys gd_*."
        },
        engineering:{
          p:[
            "Engineering lens: coherence is a constraint boundary. The system is admissible only if declared invariants are preserved across transitions under declared evidence streams.",
            "Violation is not ‘bad behavior’—it is a detectable mismatch that amplifies under correlated exposure. Containment prevents cascade."
          ],
          ul:["Boundary: invariants must be explicit.","Boundary: no compensation-by-weighting.","Boundary: correlated exposure dominates risk at scale."],
          bind:"Binds to: containment protocols · rollback discipline."
        }
      }
    },

    {
      id:"noncontradiction",
      c:"#D4AF37",
      t:P("Non-Contradiction Law","不矛盾法则","Ley de No-Contradicción"),
      s:P("Same scope + same receipts can’t produce two different truths.","同范围同收据不可能产出两种相反结论。","Mismo alcance + mismos recibos no pueden producir dos verdades distintas."),
      blocks:{
        informal:{
          p:[
            "If two people look at the same receipts and reach opposite conclusions, one of two things is true: the scope is different, or the rules are different. Otherwise the system is broken.",
            "This law kills ‘interpretation wars’ by forcing the disagreement to become structural: scope, evidence, or rules."
          ],
          ul:["Disagreement ⇒ check scope first.","Then check missing receipts.","Then check rule version."],
          bind:"Binds to: replayable receipts · versioned rules."
        },
        formal:{
          p:[
            "Within fixed scope and fixed measurement rules, admissibility must be deterministic. Identical (scope, manifests, evidence) implies identical classification output.",
            "Any deviation indicates mis-specified rules, hidden scope mutation, or evidence inconsistency."
          ],
          ul:["Determinism requirement.","No silent scope changes.","No post-hoc semantic swaps."],
          bind:"Binds to: scope locks · manifest locks."
        },
        platform:{
          p:[
            "Platform lens: the UI must not allow two ‘truths’ via two paths. If two navigation routes lead to different interpretations, the page design failed.",
            "We prevent this with stable state carry and explicit jump points."
          ],
          ul:["One meaning per label.","One route per intent.","State preserved on every jump."],
          bind:"Binds to: navigation-first contract."
        },
        engineering:{
          p:[
            "Engineering lens: classification is a function of inputs. If outputs diverge under identical inputs, the function is non-deterministic and inadmissible.",
            "Fix is not debate; fix is specification and version bump."
          ],
          ul:["Function must be deterministic.","Inputs include scope + evidence hash.","Fix requires epoch bump."],
          bind:"Binds to: epoch protocol."
        }
      }
    },

    {
      id:"scope",
      c:"#60A5FA",
      t:P("Scope Precedes Authority","范围先于权力","El Alcance Precede a la Autoridad"),
      s:P("Before you claim, define the map you’re claiming inside.","先定地图，再谈主张。","Antes de afirmar, define el mapa donde afirmas."),
      blocks:{
        informal:{
          p:[
            "Most bad arguments are just missing scope. People are debating inside two different maps and calling it disagreement.",
            "Scope is the fastest honesty tool: it tells you what you’re allowed to say *and what you must not say yet*."
          ],
          ul:["Define boundaries first.","If scope moves, restart.","No ‘infinite away’ thinking."],
          bind:"Binds to: the first paragraph on every serious page."
        },
        formal:{
          p:[
            "Admissibility requires declared scope: epoch bounds, active lanes, active anchors, and measurement rules. Scope mutation invalidates conclusions under that scope.",
            "Scope is an input. It is not a rhetorical flourish."
          ],
          ul:["Scope is part of evidence.","Mutation ⇒ new epoch.","No retroactive widening."],
          bind:"Binds to: scope declaration schema."
        },
        platform:{
          p:[
            "Platform lens: the site must make scope easy. Users should know where they are, what the page is doing, and what it refuses to do.",
            "That’s why every card ends with a jump."
          ],
          ul:["Headers must state posture.","Footers must state bounds.","Jump points prevent wandering."],
          bind:"Binds to: DOOR / PRELUDE / HUB posture."
        },
        engineering:{
          p:[
            "Engineering lens: scope defines the admissible measurement domain. Without explicit scope, any metric is undefined and any output is garbage.",
            "Scope must be machine-checkable, not poetic."
          ],
          ul:["Scope must be explicit.","Metrics require declared rules.","Undefined scope ⇒ output UNDETERMINED."],
          bind:"Binds to: measurement contracts."
        }
      }
    },

    {
      id:"admissibility",
      c:"#93C5FD",
      t:P("Admissibility Law","可采信法则","Ley de Admisibilidad"),
      s:P("Upgrades require receipts. Missing receipts block escalation.","升级需要收据；缺收据就禁止升级。","Las mejoras requieren recibos; sin recibos no hay escalación."),
      blocks:{
        informal:{
          p:[
            "This is the anti-hype law. You don’t get to level up because you feel confident. You level up because the receipts are there.",
            "It’s not pessimism. It’s safety—because scale amplifies error."
          ],
          ul:["Receipts-first.","If missing: hold/contain.","No storytelling upgrades."],
          bind:"Binds to: every ‘OPEN’ button that claims anything."
        },
        formal:{
          p:[
            "Admissibility is a binary gate under declared scope and rules. Claims may not exceed the evidence stream. Missing receipts force output to remain NOT MEASURED / UNDETERMINED.",
            "Reason codes must be emitted for every block."
          ],
          ul:["Binary gating under rules.","Reason-coded outputs.","No inference without data."],
          bind:"Binds to: classifier outputs."
        },
        platform:{
          p:[
            "Platform lens: the site must teach people the difference between ‘interesting’ and ‘admissible.’ The UI does that by separating Vision, Products, Laws, and Gauges.",
            "Vision can be big. Products can be usable. Laws bound meaning. Gauges show signals."
          ],
          ul:["Keep lanes separate.","Don’t collapse routes.","Every lane has a return."],
          bind:"Binds to: navigation architecture."
        },
        engineering:{
          p:[
            "Engineering lens: escalation is forbidden unless the receipt set satisfies the gate conditions. Gates are deterministic under identical inputs.",
            "If a gate is bypassable, the system is insecure."
          ],
          ul:["No bypass paths.","No hidden overrides.","Audit logs required for changes."],
          bind:"Binds to: gate design."
        }
      }
    },

    {
      id:"calibration",
      c:"#34D399",
      t:P("Calibration Authority Law","校准权威法则","Ley de Autoridad de Calibración"),
      s:P("Calibration authority is exclusive. Non-authority input is data only.","校准权威是唯一的；非权威输入只能算数据。","La autoridad de calibración es exclusiva; la entrada no-autorizada es solo dato."),
      blocks:{
        informal:{
          p:[
            "If everyone can ‘calibrate’ the ruler, the ruler becomes a weapon. This law protects the instrument from becoming politics.",
            "You can contribute data all day. But you cannot redefine the measuring stick unless you hold calibration authority."
          ],
          ul:["Authority is explicit.","Inputs are welcome, but labeled.","Ruler can’t be crowdsourced."],
          bind:"Binds to: instrument integrity."
        },
        formal:{
          p:[
            "Calibration authority is exclusive by definition. Parameter tuning, threshold selection, and rule specification are restricted to the authorized calibrator. All other inputs remain non-authoritative evidence only.",
            "Violation is a capture risk and invalidates outputs."
          ],
          ul:["Authority separation.","No silent tuning.","Capture resistance requirement."],
          bind:"Binds to: governance + audit separation."
        },
        platform:{
          p:[
            "Platform lens: the UI must never imply that crowds can redefine standards. The interface must distinguish ‘submit evidence’ from ‘change rules.’",
            "That’s why the site uses clear posture labels and avoids ambiguous controls."
          ],
          ul:["Separate ‘data’ from ‘rules’.","Separate ‘feedback’ from ‘calibration’.","Show status plainly."],
          bind:"Binds to: admin surfaces (future)."
        },
        engineering:{
          p:[
            "Engineering lens: calibration is a protected configuration surface. Threat model includes unauthorized tuning, silent parameter drift, and inconsistent threshold application.",
            "Mitigation: versioned configs, signed releases, audit logs, and explicit epoch rollover."
          ],
          ul:["Signed releases.","Audit logging.","Epoch bump on changes."],
          bind:"Binds to: release discipline."
        }
      }
    },

    {
      id:"stability",
      c:"#A3A3A3",
      t:P("Measurable Stability Law","可测稳定法则","Ley de Estabilidad Medible"),
      s:P("Instability is not a feeling. It’s a measurable mismatch that accelerates under scale.","不稳定不是感觉，而是可测的错配，在规模下加速。","La inestabilidad no es un sentimiento: es un desajuste medible que acelera al escalar."),
      blocks:{
        informal:{
          p:[
            "People say ‘something feels off.’ This law says: great—now measure it. Where is the mismatch? What changed? What is moving together that shouldn’t?",
            "Stability is built by making the invisible visible, then fixing the smallest real cause."
          ],
          ul:["Measure before you argue.","Find mismatch + trend.","Fix the smallest real cause."],
          bind:"Binds to: Dot.Grid + Gauges."
        },
        formal:{
          p:[
            "Stability is evaluated as preserved alignment between declared values, observed actions, and outcomes under fixed scope. Instability is the measurable divergence vector and its acceleration over a defined window.",
            "Once instability exists, ambiguity increases failure propagation speed."
          ],
          ul:["Windowed evaluation.","Trend/acceleration matters.","Ambiguity is an accelerator."],
          bind:"Binds to: windowed collapse tests."
        },
        platform:{
          p:[
            "Platform lens: the site must translate ‘off’ into ‘here is what changed.’ That’s why every product page points to measurement surfaces.",
            "Users shouldn’t be forced into theory. They should be routed to the right signal."
          ],
          ul:["Signal-first UX.","Jump to measurement.","Avoid narrative loops."],
          bind:"Binds to: page contracts."
        },
        engineering:{
          p:[
            "Engineering lens: stability requires variance bands, correlation checks, and deterministic rollback paths. Drift is detected by adjacency deltas and dependency mutation under identical naming.",
            "If naming shifts silently, comparability collapses."
          ],
          ul:["Variance bands.","Correlation checks.","Naming lock for comparability."],
          bind:"Binds to: Dot.Grid indexing discipline."
        }
      }
    },

    {
      id:"containment",
      c:"#F59E0B",
      t:P("Containment Prevents Cascade","隔离阻断级联","La Contención Evita la Cascada"),
      s:P("Keep failure local. Rollback beats collapse.","把失败变小：回滚胜过崩塌。","Mantén el fallo local. Rollback vence al colapso."),
      blocks:{
        informal:{
          p:[
            "The fastest way to lose everything is to let one failure spread. Containment is not fear; it’s intelligence.",
            "A contained failure becomes a lesson. An uncontained failure becomes a disaster."
          ],
          ul:["Isolate early.","Rollback fast.","Learn without burning the system."],
          bind:"Binds to: deployment + operations."
        },
        formal:{
          p:[
            "Containment is segmentation plus rollback discipline. It limits blast radius and preserves invariants under fault. Cascade risk increases with correlated exposure.",
            "Containment decisions must be reason-coded and logged."
          ],
          ul:["Segmentation.","Rollback discipline.","Reason-coded actions."],
          bind:"Binds to: resilience engineering."
        },
        platform:{
          p:[
            "Platform lens: routes must avoid trap loops. Every page needs a clean exit and a clean return. If the user can’t back out safely, the platform is unsafe.",
            "Containment is navigation, not just engineering."
          ],
          ul:["Every open has a return.","Back must not ‘fall through.’","No dead ends."],
          bind:"Binds to: back buttons + state carry."
        },
        engineering:{
          p:[
            "Engineering lens: containment is an explicit failure mode design. System must support rollback to last stable receipt state, zone independence, and kill/exit paths.",
            "No timer gates. No hidden dependency chains."
          ],
          ul:["Rollback to stable state.","Zone independence.","Exit paths required."],
          bind:"Binds to: execution contracts."
        }
      }
    }
  ];

  // ===== apply header =====
  var H = HEAD[lang] || HEAD.en;
  document.getElementById("hs").textContent = H.hs;
  document.getElementById("ruleTop").textContent = H.rule;
  document.getElementById("fine").textContent = H.fine;

  // ===== i18n small labels =====
  if(lang==="zh"){
    document.getElementById("hk").textContent="法则";
    document.getElementById("ht").textContent="让大想法保持诚实的规则";
    document.getElementById("band").textContent="规范法则（7）";
    document.getElementById("dockIndex").textContent="索引";
    document.getElementById("dockExplore").textContent="探索";
    document.getElementById("dockProducts").textContent="产品";
    document.getElementById("dockGauges").textContent="量规";
    pillInformal.textContent="通俗";
    pillFormal.textContent="正式";
    pillPlatform.textContent="平台";
    pillEngineering.textContent="工程";
  }else if(lang==="es"){
    document.getElementById("hk").textContent="LEYES";
    document.getElementById("ht").textContent="REGLAS QUE MANTIENEN HONESTAS LAS IDEAS GRANDES";
    document.getElementById("band").textContent="LEYES CANÓNICAS (7)";
    document.getElementById("dockIndex").textContent="ÍNDICE";
    document.getElementById("dockExplore").textContent="EXPLORAR";
    document.getElementById("dockProducts").textContent="PRODUCTOS";
    document.getElementById("dockGauges").textContent="MEDIDORES";
    pillInformal.textContent="INFORMAL";
    pillFormal.textContent="FORMAL";
    pillPlatform.textContent="PLATAFORMA";
    pillEngineering.textContent="INGENIERÍA";
  }

  // ===== render accordion (single-open) =====
  var list=document.getElementById("list");

  function openLabel(){
    return (lang==="zh")?"打开":(lang==="es")?"ABRIR":"OPEN";
  }

  function lensBlockKey(){ return lensKey(); }

  function makeRow(L, idx){
    var row=document.createElement("div");
    row.className="row";
    row.style.setProperty("--c", L.c);

    var head=document.createElement("div");
    head.className="head";
    head.setAttribute("role","button");
    head.setAttribute("tabindex","0");

    var left=document.createElement("div");
    left.className="left";

    var marker=document.createElement("div");
    marker.className="marker";
    var diamond=document.createElement("div");
    diamond.className="diamond";
    diamond.style.background=L.c;
    var bar=document.createElement("div");
    bar.className="bar";
    bar.style.background=L.c;
    marker.appendChild(diamond);
    marker.appendChild(bar);

    var tb=document.createElement("div");
    tb.className="titleBlock";
    var title=document.createElement("div");
    title.className="title";
    title.textContent=pick(L.t);
    var sub=document.createElement("div");
    sub.className="sub";
    sub.textContent=pick(L.s);
    tb.appendChild(title);
    tb.appendChild(sub);

    left.appendChild(marker);
    left.appendChild(tb);

    var chev=document.createElement("div");
    chev.className="chev";
    chev.textContent="▸";

    head.appendChild(left);
    head.appendChild(chev);

    var body=document.createElement("div");
    body.className="body";

    var small=document.createElement("div");
    small.className="smallband";
    small.textContent =
      (lang==="zh") ? ("当前透镜："+(lensBlockKey()==="informal"?"通俗":lensBlockKey()==="formal"?"正式":lensBlockKey()==="platform"?"平台":"工程")) :
      (lang==="es") ? ("Lente: "+(lensBlockKey()==="informal"?"INFORMAL":lensBlockKey()==="formal"?"FORMAL":lensBlockKey()==="platform"?"PLATAFORMA":"INGENIERÍA")) :
      ("Lens: "+(lensBlockKey()==="informal"?"INFORMAL":lensBlockKey()==="formal"?"FORMAL":lensBlockKey()==="platform"?"PLATFORM":"ENGINEERING"));

    body.appendChild(small);

    var k=lensBlockKey();
    var blk = L.blocks[k] || L.blocks.informal;

    (blk.p||[]).forEach(function(txt){
      var p=document.createElement("p");
      p.className="p";
      p.textContent=txt;
      body.appendChild(p);
    });

    if(blk.ul && blk.ul.length){
      var ul=document.createElement("ul");
      ul.className="ul";
      blk.ul.forEach(function(x){
        var li=document.createElement("li");
        li.textContent=x;
        ul.appendChild(li);
      });
      body.appendChild(ul);
    }

    var bind=document.createElement("p");
    bind.className="p";
    bind.style.opacity=".86";
    bind.textContent=blk.bind || "";
    body.appendChild(bind);

    var actions=document.createElement("div");
    actions.className="actions";

    var a1=document.createElement("a");
    a1.className="btn";
    a1.textContent=openLabel()+": "+((lang==="zh")?"量规":(lang==="es")?"GAUGES":"GAUGES");
    a1.href="/gauges/"+q();
    actions.appendChild(a1);

    var a2=document.createElement("a");
    a2.className="btn";
    a2.textContent=openLabel()+": "+((lang==="zh")?"产品":(lang==="es")?"PRODUCTS":"PRODUCTS");
    a2.href="/products/"+q();
    actions.appendChild(a2);

    body.appendChild(actions);

    function closeAll(){
      list.querySelectorAll(".row").forEach(function(x){
        x.classList.remove("open");
        var c=x.querySelector(".chev");
        if(c) c.textContent="▸";
      });
    }

    function toggle(){
      var willOpen = !row.classList.contains("open");
      closeAll();
      if(willOpen){
        row.classList.add("open");
        chev.textContent="▾";
      }
    }

    head.addEventListener("click", toggle);
    head.addEventListener("keydown", function(e){
      if(e.key==="Enter"||e.key===" "){ e.preventDefault(); toggle(); }
    });

    row.appendChild(head);
    row.appendChild(body);

    if(idx===0){
      row.classList.add("open");
      chev.textContent="▾";
    }

    return row;
  }

  function render(){
    list.innerHTML="";
    paintLens();
    for(var i=0;i<LAWS.length;i++){
      list.appendChild(makeRow(LAWS[i], i));
    }
  }

  render();
})();
</script>

</body>
</html>
