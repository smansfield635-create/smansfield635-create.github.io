<!-- TNT — /home/index.html
     HUB A · 12-DIRECTION INDEX · NARRATIVE ACCORDION (NO MODALS)
     LOCKS:
       - CANON KEYS ONLY: gd_lang / gd_style / gd_time (query + localStorage)
       - NO language selector UI (gd_lang controls EN-only / 中文-only)
       - NO mirror UI
       - 12 directions in fixed order: N, NNE, ENE, E, ESE, SSE, S, SSW, WSW, W, WNW, NNW
       - Per direction: 2 narrative bubbles (FORMAL + INFORMAL)
       - Each narrative bubble expands to 3 inner bubbles (Concept/Live/Roadmap) = 3 paragraphs
       - 6 paragraphs per direction total
       - One Jump per narrative (href "#" until you set targets; no guessing)
       - ui.css owns field (no html/body background styling)
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HUB · Index</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
/* DO NOT TOUCH FIELD — ui.css owns html/body background */
body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
a{color:inherit;text-decoration:none}

/* Buttons */
.btn,.crp-btn{
  display:inline-flex;align-items:center;justify-content:center;
  padding:10px 14px;border-radius:14px;
  background:linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  color:#fff;border:1px solid rgba(255,255,255,.10);
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;font-weight:900;letter-spacing:.2px;
  -webkit-tap-highlight-color:transparent;
}
.btn:hover,.crp-btn:hover{box-shadow:0 18px 50px rgba(0,0,0,.9),0 0 14px rgba(212,175,55,.20)}
.btn:active,.crp-btn:active{transform:translateY(1px)}

/* Page frame */
.wrap{width:min(1040px,94vw);margin:0 auto;padding:14px 0 110px;display:flex;flex-direction:column;gap:14px}
.topbar{position:sticky;top:0;z-index:50;padding:12px 0;backdrop-filter:blur(8px)}
.toprow{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
.brand{
  display:flex;flex-direction:column;gap:4px;
  padding:10px 14px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);
}
.brand .k{font-size:12px;letter-spacing:3px;text-transform:uppercase;opacity:.78;margin:0}
.brand .t{font-weight:950;font-size:18px;letter-spacing:.2px;margin:0}
.brand .s{font-size:12px;opacity:.78;margin:0}

.hintCard{
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:linear-gradient(145deg, rgba(17,22,28,.80), rgba(11,15,20,.88));
  box-shadow:0 18px 60px rgba(0,0,0,.70);
  padding:14px 16px;
}
.hintCard h2{margin:0 0 6px;font-weight:950;letter-spacing:.2px;font-size:16px}
.hintCard p{margin:0;color:rgba(255,255,255,.84);line-height:1.45;font-size:13px}

/* Direction groups */
.group{
  --c:#93C5FD;
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
  box-shadow:0 16px 52px rgba(0,0,0,.60);
  overflow:hidden;
}
.ghead{
  display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08);
}
.gleft{display:flex;align-items:flex-start;gap:12px;min-width:0}
.diamond{
  width:14px;height:14px;margin-top:3px;
  transform:rotate(45deg);
  border-radius:4px;
  background:var(--c);
  box-shadow:0 0 0 1px rgba(255,255,255,.14), 0 0 18px rgba(0,0,0,.35);
  flex:0 0 auto;
  pointer-events:none;
}
.gtitle{min-width:0}
.gtitle .name{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.gtitle .desc{margin-top:4px;font-size:12px;opacity:.74;line-height:1.35}

/* Narrative rows */
.rows{display:flex;flex-direction:column;gap:10px;padding:12px 12px 14px}
.row{
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  background:linear-gradient(145deg, rgba(17,22,28,.78), rgba(11,15,20,.86));
  box-shadow:0 12px 40px rgba(0,0,0,.55);
  overflow:hidden;
}
.rhead{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:12px 14px;cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.rleft{display:flex;align-items:center;gap:10px;min-width:0}
.pip{
  width:8px;height:18px;border-radius:99px;background:var(--c);
  flex:0 0 auto;opacity:.85;
  pointer-events:none;
}
.rname{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.rsub{font-size:12px;opacity:.70;margin-left:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.chev{font-size:16px;opacity:.75;flex:0 0 auto}

/* Inner bubbles */
.rbody{display:none;padding:12px 14px 14px;border-top:1px solid rgba(255,255,255,.08)}
.row.open .rbody{display:block}
.pstack{display:flex;flex-direction:column;gap:10px}
.pbub{
  padding:12px 14px;border-radius:16px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.06), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
  box-shadow:0 10px 32px rgba(0,0,0,.45), inset 0 2px 0 rgba(255,255,255,.05);
}
.pbub .pt{margin:0 0 6px;font-weight:950;letter-spacing:.2px;font-size:13px}
.pbub .pp{margin:0;color:rgba(255,255,255,.86);line-height:1.55;font-size:13px}

.jump{display:flex;justify-content:flex-end;margin-top:10px}

/* Dock */
.dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:120;
  width:min(980px,94vw);
  display:flex;justify-content:center;
  gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);
  backdrop-filter:blur(8px);
}

@media (max-width:560px){
  .brand .t{font-size:16px}
}
</style>
</head>

<body>

<div class="topbar">
  <div class="wrap">
    <div class="toprow">
      <div class="brand" aria-hidden="true">
        <p class="k" id="bk">CARDINAL AXIS</p>
        <p class="t" id="bt">HUB · Index</p>
        <p class="s" id="bs">12 directions · 2 narratives each · Concept/Live/Roadmap</p>
      </div>
    </div>
  </div>
</div>

<div class="wrap">
  <div class="hintCard">
    <h2 id="hH">Cardinality index</h2>
    <p id="hP">Each direction contains two narratives: Formal and Informal. Tap a narrative to reveal Concept · Live · Roadmap. One jump per narrative.</p>
  </div>

  <div id="groups"></div>
</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="dockHub" href="/home/">HUB</a>
  <a class="btn" id="dockExplore" href="/explore/">EXPLORE</a>
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<script>
(function(){
  // ===== CANON KEYS ONLY =====
  var qs = new URLSearchParams(location.search);
  var gd_lang  = qs.get("gd_lang")  || localStorage.getItem("gd_lang")  || "en";
  var gd_style = qs.get("gd_style") || localStorage.getItem("gd_style") || "informal";
  var gd_time  = qs.get("gd_time")  || localStorage.getItem("gd_time")  || "now";

  if(gd_lang!=="en" && gd_lang!=="zh") gd_lang="en";
  if(gd_style!=="formal" && gd_style!=="informal") gd_style="informal";
  if(gd_time==="trajectory") gd_time="post";
  if(gd_time!=="origin" && gd_time!=="now" && gd_time!=="post") gd_time="now";

  try{
    localStorage.setItem("gd_lang", gd_lang);
    localStorage.setItem("gd_style", gd_style);
    localStorage.setItem("gd_time", gd_time);
  }catch(e){}

  document.documentElement.lang = (gd_lang==="zh") ? "zh" : "en";

  function q(){
    var p=new URLSearchParams();
    p.set("gd_lang", gd_lang);
    p.set("gd_style", gd_style);
    p.set("gd_time", gd_time);
    return "?"+p.toString();
  }

  // Wire dock (state preserved)
  document.getElementById("dockHub").href="/home/"+q();
  document.getElementById("dockExplore").href="/explore/"+q();
  document.getElementById("dockProducts").href="/products/"+q();
  document.getElementById("dockLaws").href="/laws/"+q();
  document.getElementById("dockGauges").href="/gauges/"+q();

  // Header i18n (render-only)
  function setText(id, txt){ var el=document.getElementById(id); if(el) el.textContent=txt; }
  if(gd_lang==="zh"){
    setText("bk","基轴体系");
    setText("bt","枢纽 · 索引");
    setText("bs","12方向 · 每方向2叙述 · 概念/现况/路线图");
    setText("hH","基数索引");
    setText("hP","每个方向包含两条叙述：正式与非正式。点击叙述展开概念·现况·路线图。每条叙述一个跳转。");
  }

  // 12-face colors (LOCK)
  var COLORS = {
    N:"#1F3A8A",
    NNE:"#2C3EAF",
    ENE:"#4B3FBF",
    E:"#0EA5E9",
    ESE:"#14B8A6",
    SSE:"#22C55E",
    S:"#F59E0B",
    SSW:"#EA580C",
    WSW:"#DC2626",
    W:"#7F1D1D",
    WNW:"#9333EA",
    NNW:"#334155"
  };

  // 12 directions in fixed order (LOCK)
  var ORDER = ["N","NNE","ENE","E","ESE","SSE","S","SSW","WSW","W","WNW","NNW"];

  // Helper: pick text by language + narrative type
  function T(en, zh){ return (gd_lang==="zh") ? zh : en; }

  // DATA: placeholders (replace later). Structure is locked.
  // Each direction has:
  // - name, desc
  // - 2 narratives: formal + informal
  // Each narrative has concept/live/roadmap paragraphs + jump href
  var DATA = {
    N:{
      name:T("N · DEFINITIONS","N · 定义"),
      desc:T("Meaning before measurement.","测量之前先定含义。"),
      formal:{
        label:T("Formal narrative","正式叙述"),
        sub:T("Objective, bounded, falsifiable posture.","客观、有界、可证伪姿态。"),
        concept:T("Definitions pin semantics so claims remain admissible under declared scope.","定义钉住语义，使主张在声明范围内可采信。"),
        live:T("Shared terms remain stable across pages; disputes route to definitions.","术语跨页面一致；争议回到定义。"),
        roadmap:T("Expand registry without mutating geometry.","扩展注册表但不改变几何。"),
        href:"#"
      },
      informal:{
        label:T("Informal narrative","非正式叙述"),
        sub:T("TED-style delivery inside the boundary.","边界内的TED式表达。"),
        concept:T("Lock meanings first so nothing drifts.","先把词钉死，后面就不漂。"),
        live:T("When it’s fuzzy, you route—don’t argue.","模糊就跳转，不争论。"),
        roadmap:T("Grow the dictionary, keep the compass.","词典变大，罗盘不变。"),
        href:"#"
      }
    },

    NNE:{name:T("NNE","NNE"),desc:T("Definitions→Products blend.","定义→产品过渡。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Bridge semantics into execution.","把语义桥接到执行。"),
        concept:T("Transitional definitions remain bounded and cite the spine.","过渡定义保持有界并引用脊柱。"),
        live:T("Execution inherits limits from definitions.","执行继承定义边界。"),
        roadmap:T("Refine projection without creating new geometry.","细化投影但不新增几何。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Make meaning become tool.","让含义变成工具。"),
        concept:T("Turn clarity into something you can use.","把清晰变成能用的东西。"),
        live:T("You don’t argue—your system routes.","你不争论，系统会路由。"),
        roadmap:T("More scale, same compass.","规模更大，罗盘不变。"),href:"#"}
    },

    ENE:{name:T("ENE","ENE"),desc:T("Definitions→Products transition.","定义→产品转换。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Contract to surface.","从契约到执行面。"),
        concept:T("Convert declared meaning into stable execution surfaces.","把声明含义转为稳定执行面。"),
        live:T("Deployment remains comparable across instances.","部署在实例间保持可比。"),
        roadmap:T("Publish boundaries without recipes.","公开边界不泄密。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("From words to action.","从词到行动。"),
        concept:T("Make it executable—without losing integrity.","变可执行，但不丢完整性。"),
        live:T("Same rules, different scale.","同规则，不同规模。"),
        roadmap:T("Clone the ramp, don’t reinvent it.","复制匝道，不重造。"),href:"#"}
    },

    E:{name:T("E · PRODUCTS","E · 产品"),desc:T("Execution surfaces under constraint.","在约束内的执行面。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Bounded adoption ramps.","有界采纳匝道。"),
        concept:T("Products are bounded adoption ramps that preserve navigation contracts.","产品是有界采纳匝道，必须保持导航契约。"),
        live:T("Claims route to verification surfaces, not persuasion.","主张跳转核查面，而不是靠说服。"),
        roadmap:T("Scale by replication, not redesign.","复制扩张，不重造。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Tools that hold the line.","守规矩的工具。"),
        concept:T("Build tools that can’t drift while they scale.","做能扩张也不漂移的工具。"),
        live:T("Proof has an address—use it.","证据有地址，直接用。"),
        roadmap:T("Multiply without chaos.","倍增而不混乱。"),href:"#"}
    },

    ESE:{name:T("ESE","ESE"),desc:T("Products→Constraints blend.","产品→约束过渡。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Power meets gate.","能力遇到闸门。"),
        concept:T("Execution must satisfy admissibility gates.","执行必须满足可采信闸门。"),
        live:T("Products route to gates before scale.","产品扩张前先过闸门。"),
        roadmap:T("Publish readiness checklists.","公开就绪清单。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Dreams with guardrails.","有护栏的梦想。"),
        concept:T("Big ideas stay safe when the gates are visible.","闸门可见，大想法才安全。"),
        live:T("No gate, no growth.","没闸门就别扩张。"),
        roadmap:T("Turn hype into prerequisites.","把噱头变成先决条件。"),href:"#"}
    },

    SSE:{name:T("SSE","SSE"),desc:T("Products→Constraints transition.","产品→约束转换。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Readiness before invitation.","先就绪再邀请。"),
        concept:T("‘When’ equals prerequisites, not dates.","“何时”=先决条件，不是日期。"),
        live:T("Pressure reveals weak gates; tighten with evidence.","压力暴露闸门薄弱；用证据收紧。"),
        roadmap:T("Phase gates become auditable checklists.","阶段闸门变为可审计清单。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Stop guessing. Gate it.","别猜了，上闸门。"),
        concept:T("If you can’t state prerequisites, you’re not ready.","说不清先决条件，就没准备好。"),
        live:T("Pressure doesn’t lie.","压力不会撒谎。"),
        roadmap:T("Make readiness obvious.","让就绪一眼可见。"),href:"#"}
    },

    S:{name:T("S · CONSTRAINTS","S · 约束"),desc:T("Admissibility gates prevent drift.","闸门防漂移。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("No scope, no claim.","无范围，不主张。"),
        concept:T("Claims are refused without scope, receipts, and falsifiers.","无范围/无收据/无证伪条件则拒绝主张。"),
        live:T("Gate enforcement blocks shortcut traversal and inflation.","闸门执行阻止抄近道与膨胀。"),
        roadmap:T("Tighten only with evidence; never loosen by story.","只用证据收紧；绝不靠叙事放松。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Hard no saves lives.","硬拒绝救命。"),
        concept:T("If it isn’t bounded, it isn’t real.","不有界，就不真实。"),
        live:T("Shortcuts are where drift is born.","捷径是漂移的出生地。"),
        roadmap:T("Make ‘no’ a feature.","把“不行”做成特性。"),href:"#"}
    },

    SSW:{name:T("SSW","SSW"),desc:T("Constraints→Containment blend.","约束→隔离过渡。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Refusal + isolation cooperate.","拒绝+隔离协同。"),
        concept:T("Containment complements refusal to prevent cascade.","隔离与拒绝互补防级联。"),
        live:T("Safe ‘no’ plus clean return paths.","安全拒绝+干净返回。"),
        roadmap:T("Reduce cascade risk as scale increases.","规模化降低级联风险。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Say no, then contain.","先拒绝，再隔离。"),
        concept:T("A clean ‘no’ is kindness.","干净的拒绝是善意。"),
        live:T("Exit paths keep you sane.","出口让你保持清醒。"),
        roadmap:T("Bigger system, tighter containment.","越大越要隔离。"),href:"#"}
    },

    WSW:{name:T("WSW","WSW"),desc:T("Constraints→Containment transition.","约束→隔离转换。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Segment failure vectors.","分段失败向量。"),
        concept:T("Segmentation prevents scale amplifying single failure modes.","分段防止规模放大单点失败。"),
        live:T("Evidence chains keep integrity enforceable.","证据链让完整性可执行。"),
        roadmap:T("Audit posture strengthens without recipes.","强化审计姿态但不泄密。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Don’t let one crack ruin the whole wall.","别让一条裂缝毁整面墙。"),
        concept:T("Contain fast. Fix clean.","快隔离，干净修。"),
        live:T("Receipts keep people honest.","收据让人诚实。"),
        roadmap:T("Audit without drama.","审计不需要戏。"),href:"#"}
    },

    W:{name:T("W · CONTAINMENT","W · 隔离"),desc:T("Isolation prevents cascade.","隔离防级联。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Local failure must stay local.","局部失败必须局部化。"),
        concept:T("Failures must be segmented so local breaks do not become global collapse.","失败必须分段，局部破损不能变全局崩塌。"),
        live:T("Return paths remain available; state remains coherent.","返回路径可用；状态保持一致。"),
        roadmap:T("Add containment gauges as the system scales.","规模化时增加隔离量规。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Keep damage small.","把损伤变小。"),
        concept:T("Contain it before it spreads.","先隔离，别扩散。"),
        live:T("Always keep an exit.","永远有出口。"),
        roadmap:T("Measure spillover, don’t guess.","测外溢，别猜。"),href:"#"}
    },

    WNW:{name:T("WNW","WNW"),desc:T("Containment→Definitions blend.","隔离→定义过渡。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Audit feeds definitions via versioning.","审计通过版本化反哺定义。"),
        concept:T("Containment feedback clarifies definitions and tightens registries.","隔离反馈澄清定义并收紧注册表。"),
        live:T("Audits drive corrections without silent edits.","审计推动修正，避免静默改义。"),
        roadmap:T("Shorten returns as lookup points grow.","查表点越多返回越短。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Containment teaches you what words really mean.","隔离让你知道词到底啥意思。"),
        concept:T("Reality sharpens language.","现实会磨尖语言。"),
        live:T("Fix it with versions, not vibes.","用版本修，不靠感觉。"),
        roadmap:T("More lookup, less confusion.","更多查表，更少困惑。"),href:"#"}
    },

    NNW:{name:T("NNW","NNW"),desc:T("Containment→Definitions transition.","隔离→定义转换。"),
      formal:{label:T("Formal narrative","正式叙述"),sub:T("Reset without drift.","不漂移的重置。"),
        concept:T("Return paths restore coherence under pressure.","返回路径在压力下恢复一致性。"),
        live:T("Re-entry preserves state; semantics do not swap silently.","重入保留状态；语义不静默偷换。"),
        roadmap:T("Add lookup points to reduce confusion under scale.","增加查表点减少规模化困惑。"),href:"#"},
      informal:{label:T("Informal narrative","非正式叙述"),sub:T("Breathe. Reset. Continue.","呼吸，重置，继续。"),
        concept:T("A clean reset is power.","干净重置就是力量。"),
        live:T("No silent swaps.","不许悄悄换。"),
        roadmap:T("Make returns shorter over time.","让返回越来越短。"),href:"#"}
    }
  };

  // Build UI
  var groups=document.getElementById("groups");

  function mkPara(label, text){
    var pb=document.createElement("div");
    pb.className="pbub";
    var pt=document.createElement("p");
    pt.className="pt";
    pt.textContent=label;
    var pp=document.createElement("p");
    pp.className="pp";
    pp.textContent=text;
    pb.appendChild(pt);
    pb.appendChild(pp);
    return pb;
  }

  function mkRow(faceKey, narKey, nar){
    var row=document.createElement("div");
    row.className="row";

    var head=document.createElement("div");
    head.className="rhead";

    var left=document.createElement("div");
    left.className="rleft";

    var pip=document.createElement("div");
    pip.className="pip";

    var name=document.createElement("div");
    name.className="rname";
    name.textContent = nar.label;

    var sub=document.createElement("div");
    sub.className="rsub";
    sub.textContent = nar.sub;

    left.appendChild(pip);
    left.appendChild(name);
    left.appendChild(sub);

    var chev=document.createElement("div");
    chev.className="chev";
    chev.textContent="▸";

    head.appendChild(left);
    head.appendChild(chev);

    var body=document.createElement("div");
    body.className="rbody";

    var stack=document.createElement("div");
    stack.className="pstack";

    var Lc = T("Concept","概念");
    var Ln = T("Live","现况");
    var Lr = T("Roadmap","路线图");

    stack.appendChild(mkPara(Lc, nar.concept));
    stack.appendChild(mkPara(Ln, nar.live));
    stack.appendChild(mkPara(Lr, nar.roadmap));

    var jump=document.createElement("div");
    jump.className="jump";
    var a=document.createElement("a");
    a.className="btn";
    a.textContent = T("JUMP","跳转");
    a.href = nar.href;
    if(nar.href !== "#"){
      a.href = nar.href + (nar.href.indexOf("?")>=0 ? "" : q());
    }
    jump.appendChild(a);

    body.appendChild(stack);
    body.appendChild(jump);

    head.addEventListener("click", function(){
      var open=row.classList.toggle("open");
      chev.textContent = open ? "▾" : "▸";
    });

    row.appendChild(head);
    row.appendChild(body);

    // Optional default open: only first direction, only the lens selected
    return row;
  }

  function mkGroup(faceKey){
    var pack=DATA[faceKey];
    var group=document.createElement("section");
    group.className="group";
    group.style.setProperty("--c", COLORS[faceKey] || "#93C5FD");

    var ghead=document.createElement("div");
    ghead.className="ghead";

    var gleft=document.createElement("div");
    gleft.className="gleft";

    var d=document.createElement("div");
    d.className="diamond";

    var gt=document.createElement("div");
    gt.className="gtitle";
    var n=document.createElement("div");
    n.className="name";
    n.textContent=pack.name;
    var ds=document.createElement("div");
    ds.className="desc";
    ds.textContent=pack.desc;

    gt.appendChild(n);
    gt.appendChild(ds);

    gleft.appendChild(d);
    gleft.appendChild(gt);

    ghead.appendChild(gleft);

    var rows=document.createElement("div");
    rows.className="rows";

    // Two narratives per direction (FORMAL + INFORMAL)
    var r1 = mkRow(faceKey,"formal",pack.formal);
    var r2 = mkRow(faceKey,"informal",pack.informal);

    rows.appendChild(r1);
    rows.appendChild(r2);

    // Default open behavior (allowed): first face only, one narrative based on gd_style
    if(faceKey==="N"){
      if(gd_style==="formal"){
        r1.classList.add("open");
        r1.querySelector(".chev").textContent="▾";
      }else{
        r2.classList.add("open");
        r2.querySelector(".chev").textContent="▾";
      }
    }

    group.appendChild(ghead);
    group.appendChild(rows);
    return group;
  }

  // Render in fixed order
  ORDER.forEach(function(k){
    if(DATA[k]) groups.appendChild(mkGroup(k));
  });

})();
</script>

</body>
</html>
