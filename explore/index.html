<!-- TNT — /explore/index.html
     EXPLORE · PRODUCTS & INNOVATION (LAYER 2)
     FIX (NO DRIFT):
       - INFO section moved ABOVE jump bands (info first, jump second)
       - PRODUCTS band = EXACTLY 4 cards + 4 OPEN buttons:
           1) Energy                → /products/energy/
           2) Coherence Diagnostic  → /products/coherence-diagnostic/
           3) Dot.Grid              → /products/dot-grid/
           4) SSG                   → /products/ssg/
       - INNOVATION band kept separate (3 cards):
           Frontier → /explore/frontier/
           Language → /explore/innovation/language/
           Roadmap  → /explore/roadmap/
       - NO modals, NO overlays, accordion in-place
       - 3 languages (EN / 中文 / ES) page-level only
       - Language toggle reloads SAME PATH (GH Pages safe)
       - State carry: lang/style/time/depth preserved on every jump
     LOCKS:
       - Uses /assets/ui.css + /assets/branch.css + /assets/instruments.js
       - No html/body background styling
       - Tap-safe
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>EXPLORE · Products & Innovation</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
:root{--dockH:86px}

/* page */
.page{
  width:min(1100px,94vw);
  margin:0 auto;
  padding:14px 0 calc(var(--dockH) + 18px);
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* top controls */
.top-left{
  position:fixed;left:16px;top:16px;z-index:140;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}
.top-right{
  position:fixed;right:16px;top:16px;z-index:140;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}

/* header */
.header{
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:
    radial-gradient(circle at 30% 25%, rgba(210,190,255,.14), transparent 70%),
    radial-gradient(circle at 75% 60%, rgba(120,70,255,.10), transparent 72%),
    rgba(0,0,0,.14);
  backdrop-filter:blur(10px);
  padding:14px 16px;
  box-shadow:0 24px 80px rgba(0,0,0,.55);
}
.k{font-size:11px;letter-spacing:4px;text-transform:uppercase;opacity:.72;margin:0 0 6px}
.t{font-weight:950;font-size:26px;letter-spacing:.6px;margin:0 0 6px}
.s{font-size:13.5px;opacity:.86;line-height:1.5;margin:0;max-width:980px}
.fine{margin-top:10px;font-size:12.25px;opacity:.70;line-height:1.45}

/* band label */
.band{
  padding:10px 12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.12);
  font-weight:950;
  letter-spacing:.2px;
  color:rgba(255,255,255,.86);
}

/* list */
.stackList{display:flex;flex-direction:column;gap:12px}
.stackRow{
  --domc:#93C5FD;
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:linear-gradient(145deg, rgba(17,22,28,.86), rgba(11,15,20,.92));
  box-shadow:0 16px 52px rgba(0,0,0,.60);
  overflow:hidden;
}
.stackHead{
  display:flex;align-items:flex-start;justify-content:space-between;
  gap:10px;padding:14px 16px;cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}
.stackLeft{display:flex;align-items:flex-start;gap:12px;min-width:0}
.stackBar{width:6px;height:22px;border-radius:99px;background:var(--domc);flex:0 0 auto;margin-top:2px}
.stackTitle{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.stackSub{margin-top:6px;font-size:12.75px;opacity:.80;line-height:1.35;max-width:92ch}
.stackChevron{font-size:16px;opacity:.75;flex:0 0 auto;margin-top:2px}
.stackBody{
  display:none;
  padding:14px 16px 16px;
  border-top:1px solid rgba(255,255,255,.08);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
}
.stackRow.open .stackBody{display:block}
.pdesc{margin:0;color:rgba(255,255,255,.86);line-height:1.55;font-size:13.25px}
.actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;margin-top:12px}
.actions .btn{padding:10px 12px;border-radius:999px;white-space:nowrap}

/* dock */
.dock{
  position:fixed;left:50%;
  bottom:max(10px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:220;
  width:min(980px,94vw);
  padding:10px 12px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  backdrop-filter:blur(10px);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  display:grid;
  grid-template-columns:repeat(4, minmax(0,1fr));
  gap:10px;
}
.dock .btn{width:100%;padding:10px 10px;border-radius:999px;white-space:nowrap}
@media (max-width:520px){
  :root{--dockH:98px}
  .dock{grid-template-columns:repeat(3, minmax(0,1fr))}
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnDoor" href="/door/">DOOR</a>
  <a class="btn" id="btnIndex" href="/index.html">INDEX</a>
</div>

<div class="top-right" aria-label="Language">
  <button class="btn" id="btnEN" type="button">EN</button>
  <button class="btn" id="btnZH" type="button">中文</button>
  <button class="btn" id="btnES" type="button">ES</button>
</div>

<div class="page">

  <div class="header">
    <p class="k" id="hk">EXPLORE</p>
    <h1 class="t" id="ht">PRODUCTS & INNOVATION</h1>
    <p class="s" id="hs">Open a card. Read one paragraph. Jump when you’re ready.</p>
    <div class="fine" id="fine">Fine print: deeper theory lives under Laws and Gauges.</div>
  </div>

  <!-- INFO FIRST -->
  <div class="band" id="bandInfo">INFO</div>
  <div class="stackList" id="listInfo"></div>

  <!-- PRODUCTS -->
  <div class="band" id="bandA">PRODUCTS</div>
  <div class="stackList" id="listA"></div>

  <!-- INNOVATION -->
  <div class="band" id="bandB">INNOVATION</div>
  <div class="stackList" id="listB"></div>

</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="dockHome" href="/home/">HOME</a>
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<script>
(function(){
  // ===== state =====
  var qs=new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  var depth = qs.get("depth") || localStorage.getItem("gd_depth") || "explore";

  if(lang!=="en" && lang!=="zh" && lang!=="es") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time==="trajectory") time="post";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";
  if(depth!=="explore" && depth!=="learn") depth="explore";

  try{
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);
    localStorage.setItem("gd_depth",depth);
  }catch(e){}
  document.documentElement.lang=(lang==="zh")?"zh":(lang==="es")?"es":"en";

  function q(){
    return "?lang="+encodeURIComponent(lang)+
           "&style="+encodeURIComponent(style)+
           "&time="+encodeURIComponent(time)+
           "&depth="+encodeURIComponent(depth);
  }

  function wire(id,path){
    var el=document.getElementById(id);
    if(el) el.href = path + q();
  }
  wire("btnDoor","/door/");
  wire("btnIndex","/index.html");
  wire("dockHome","/home/");
  wire("dockProducts","/products/");
  wire("dockLaws","/laws/");
  wire("dockGauges","/gauges/");

  // ===== language toggle (reload SAME PATH) =====
  var btnEN=document.getElementById("btnEN");
  var btnZH=document.getElementById("btnZH");
  var btnES=document.getElementById("btnES");
  function paintLang(){
    btnEN.classList.toggle("active", lang==="en");
    btnZH.classList.toggle("active", lang==="zh");
    btnES.classList.toggle("active", lang==="es");
  }
  paintLang();
  function setLang(next){
    if(next!=="en" && next!=="zh" && next!=="es") next="en";
    lang=next;
    try{ localStorage.setItem("gd_lang",lang); }catch(e){}
    window.location.href = window.location.pathname + q();
  }
  btnEN.addEventListener("click", function(){ setLang("en"); });
  btnZH.addEventListener("click", function(){ setLang("zh"); });
  btnES.addEventListener("click", function(){ setLang("es"); });

  // ===== i18n header =====
  function renderHeader(){
    if(lang==="zh"){
      document.getElementById("hk").textContent="探索";
      document.getElementById("ht").textContent="产品与创新";
      document.getElementById("hs").textContent="打开一张卡。读一段话。准备好就跳转。";
      document.getElementById("fine").textContent="细则：更深的理论在法则与量规中。";
      document.getElementById("bandInfo").textContent="信息";
      document.getElementById("bandA").textContent="产品";
      document.getElementById("bandB").textContent="创新";
      document.getElementById("btnDoor").textContent="门";
      document.getElementById("btnIndex").textContent="索引";
      document.getElementById("dockHome").textContent="主页";
      document.getElementById("dockProducts").textContent="产品";
      document.getElementById("dockLaws").textContent="法则";
      document.getElementById("dockGauges").textContent="量规";
    }else if(lang==="es"){
      document.getElementById("hk").textContent="EXPLORAR";
      document.getElementById("ht").textContent="PRODUCTOS E INNOVACIÓN";
      document.getElementById("hs").textContent="Abre una tarjeta. Lee un párrafo. Salta cuando estés listo.";
      document.getElementById("fine").textContent="Letra pequeña: la teoría vive en Leyes y Medidores.";
      document.getElementById("bandInfo").textContent="INFO";
      document.getElementById("bandA").textContent="PRODUCTOS";
      document.getElementById("bandB").textContent="INNOVACIÓN";
      document.getElementById("btnDoor").textContent="PUERTA";
      document.getElementById("btnIndex").textContent="ÍNDICE";
      document.getElementById("dockHome").textContent="INICIO";
      document.getElementById("dockProducts").textContent="PRODUCTOS";
      document.getElementById("dockLaws").textContent="LEYES";
      document.getElementById("dockGauges").textContent="MEDIDORES";
    }else{
      document.getElementById("hk").textContent="EXPLORE";
      document.getElementById("ht").textContent="PRODUCTS & INNOVATION";
      document.getElementById("hs").textContent="Open a card. Read one paragraph. Jump when you’re ready.";
      document.getElementById("fine").textContent="Fine print: deeper theory lives under Laws and Gauges.";
      document.getElementById("bandInfo").textContent="INFO";
      document.getElementById("bandA").textContent="PRODUCTS";
      document.getElementById("bandB").textContent="INNOVATION";
      document.getElementById("btnDoor").textContent="DOOR";
      document.getElementById("btnIndex").textContent="INDEX";
      document.getElementById("dockHome").textContent="HOME";
      document.getElementById("dockProducts").textContent="PRODUCTS";
      document.getElementById("dockLaws").textContent="LAWS";
      document.getElementById("dockGauges").textContent="GAUGES";
    }
  }
  renderHeader();

  // ===== DATA =====
  var INFO = [
    {
      c:"#D4AF37",
      t:{en:"How this hub works",zh:"本枢纽怎么用",es:"Cómo funciona este hub"},
      s:{en:"Info first, jump second. Every card ends with a jump.",zh:"先信息，后跳转；每张卡末尾都有跳转。",es:"Info primero, salto después. Cada tarjeta termina con un salto."},
      p:{en:"This page is a launch surface. Products are usable tools. Innovation is bounded exploration. If you want proof posture, go to Laws. If you want measured outputs, go to Gauges. Use the Open button to jump cleanly.",
         zh:"此页是发射台。产品是可用工具；创新是有界探索。要“证明姿态”去法则；要“测量输出”去量规。点“打开”即可清晰跳转。",
         es:"Esta página es una lanzadera. Productos = herramientas. Innovación = exploración acotada. Prueba en Leyes; medición en Medidores. Usa ABRIR para saltar limpio."},
      href:"/prelude/"
    }
  ];

  var PRODUCTS = [
    {
      c:"#F59E0B",
      t:{en:"Energy",zh:"能源",es:"Energía"},
      s:{en:"Industrial posture (C). No gain claims.",zh:"工业姿态（C）。无增益主张。",es:"Postura industrial (C). Sin ganancias."},
      p:{en:"Thermal substitution surfaces with staged discipline and containment-first interfaces.",
         zh:"热替代执行面：阶段化纪律与隔离优先接口。",
         es:"Superficies de sustitución térmica con disciplina por fases y contención primero."},
      href:"/products/energy/"
    },
    {
      c:"#93C5FD",
      t:{en:"Coherence Diagnostic",zh:"一致性诊断",es:"Diagnóstico de coherencia"},
      s:{en:"Decision support and classification surfaces.",zh:"决策支持与分类执行面。",es:"Soporte de decisión y clasificación."},
      p:{en:"One diagnostic surface with bounded posture. Doctrine lives under Laws; measured outputs live under Gauges.",
         zh:"一个有界诊断面：教义边界在法则，测量输出在量规。",
         es:"Una superficie diagnóstica acotada. Doctrina en Leyes; salidas medidas en Medidores."},
      href:"/products/coherence-diagnostic/"
    },
    {
      c:"#0EA5E9",
      t:{en:"Dot.Grid",zh:"Dot.Grid",es:"Dot.Grid"},
      s:{en:"256-state indexing and sweep surfaces.",zh:"256态索引与扫掠面。",es:"Indexación 256-estados y barridos."},
      p:{en:"Index and sweep surfaces used to organize state, traversal, and references without collapsing routes into one page.",
         zh:"索引与扫掠执行面：组织状态、遍历与引用，不把路由坍缩到单一页面。",
         es:"Superficies de indexación y barrido para organizar estado y referencias sin colapsar rutas."},
      href:"/products/dot-grid/"
    },
    {
      c:"#A3A3A3",
      t:{en:"SSG",zh:"SSG",es:"SSG"},
      s:{en:"Constraint syntax geometry platform.",zh:"约束语法几何平台。",es:"Plataforma de sintaxis geométrica."},
      p:{en:"Execution geometry for expressing behavior via resources, stores, constraints, goals, and guards.",
         zh:"执行几何：用资源/存储/约束/目标/守卫表达行为。",
         es:"Geometría de ejecución: recursos, stores, restricciones, objetivos y guards."},
      href:"/products/ssg/"
    }
  ];

  var INNOV = [
    {
      c:"#93C5FD",
      t:{en:"Frontier",zh:"前沿",es:"Frontera"},
      s:{en:"Concept lab and readiness pathways.",zh:"概念实验室与就绪路径。",es:"Laboratorio de conceptos y preparación."},
      p:{en:"Big ideas are allowed here, but claims remain bounded. Anything measurable routes to Gauges.",
         zh:"允许大想法，但主张必须有界。可测内容跳到量规。",
         es:"Ideas grandes, pero afirmaciones acotadas. Lo medible va a Medidores."},
      href:"/explore/frontier/"
    },
    {
      c:"#D4AF37",
      t:{en:"Language",zh:"语言",es:"Lenguaje"},
      s:{en:"Shared terms and structural encoding.",zh:"共用术语与结构编码。",es:"Términos compartidos y codificación."},
      p:{en:"Keeps terminology stable so meaning does not drift across pages.",
         zh:"稳定术语，防止跨页含义漂移。",
         es:"Mantiene términos estables para evitar deriva semántica."},
      href:"/explore/innovation/language/"
    },
    {
      c:"#334155",
      t:{en:"Roadmap",zh:"路线图",es:"Hoja de ruta"},
      s:{en:"Future surfaces and gated expansion.",zh:"未来执行面与阶段化扩展。",es:"Superficies futuras y expansión por fases."},
      p:{en:"Bounded planning surface. No promises. Only prerequisites and gates.",
         zh:"有界规划面：不承诺，只列先决条件与闸门。",
         es:"Planificación acotada: sin promesas, solo prerrequisitos y compuertas."},
      href:"/explore/roadmap/"
    }
  ];

  function pick(o){ return (lang==="zh")?o.zh:(lang==="es")?(o.es||o.en):o.en; }

  function makeRow(item){
    var row=document.createElement("div");
    row.className="stackRow";
    row.style.setProperty("--domc", item.c);

    var head=document.createElement("div");
    head.className="stackHead";

    var left=document.createElement("div");
    left.className="stackLeft";

    var bar=document.createElement("div");
    bar.className="stackBar";
    bar.style.background=item.c;

    var block=document.createElement("div");
    block.style.minWidth="0";

    var title=document.createElement("div");
    title.className="stackTitle";
    title.textContent=pick(item.t);

    var sub=document.createElement("div");
    sub.className="stackSub";
    sub.textContent=pick(item.s);

    block.appendChild(title);
    block.appendChild(sub);

    left.appendChild(bar);
    left.appendChild(block);

    var chev=document.createElement("div");
    chev.className="stackChevron";
    chev.textContent="▸";

    head.appendChild(left);
    head.appendChild(chev);

    var body=document.createElement("div");
    body.className="stackBody";

    var p=document.createElement("p");
    p.className="pdesc";
    p.textContent=pick(item.p);

    var acts=document.createElement("div");
    acts.className="actions";

    var open=document.createElement("a");
    open.className="btn";
    open.textContent = (lang==="zh") ? "打开" : (lang==="es") ? "ABRIR" : "OPEN";
    open.href = item.href + q();
    acts.appendChild(open);

    body.appendChild(p);
    body.appendChild(acts);

    head.addEventListener("click", function(){
      var openNow=row.classList.toggle("open");
      chev.textContent = openNow ? "▾" : "▸";
    });

    row.appendChild(head);
    row.appendChild(body);
    return row;
  }

  function mount(listId, arr){
    var list=document.getElementById(listId);
    list.innerHTML="";
    arr.forEach(function(it,i){
      var el=makeRow(it);
      list.appendChild(el);
      if(i===0){
        el.classList.add("open");
        el.querySelector(".stackChevron").textContent="▾";
      }
    });
  }

  mount("listInfo", INFO);
  mount("listA", PRODUCTS);
  mount("listB", INNOV);

})();
</script>

</body>
</html>
