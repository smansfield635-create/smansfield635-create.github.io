<!-- TNT — /door/index.html
     DOOR · GEOMETRY ONLY (HARD RESET)
     RULE:
       - No ui.css
       - No backgrounds, no gradients, no glass, no effects
       - Only geometry + routing
     ROUTES:
       - TOP diamond → /home/
       - BOTTOM diamond → /prelude/
     STATE:
       - Carries ?lang=&style=&time=&depth=
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>DOOR</title>

<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
/* Layout only. No field ownership. No materials. */
html,body{margin:0;padding:0;height:100%}
a{color:inherit;text-decoration:none}

.door{
  height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.stack{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:28px;
  padding:24px;
}

/* Minimal visibility so geometry is clickable/legible without “design”. */
.gd-diamond{
  border:1px solid rgba(0,0,0,.25);
  box-sizing:border-box;
  cursor:pointer;
}

/* Ensure the label is upright (branch.css already rotates inner span) */
.gd-diamond span{
  font-weight:800;
  letter-spacing:.6px;
  text-transform:uppercase;
}
.gd-diamond small{
  font-weight:600;
  letter-spacing:.3px;
  text-transform:none;
}
</style>
</head>

<body>

<div class="door">
  <div class="stack">

    <!-- ENTER -->
    <a class="gd-diamond" id="enter" href="/home/">
      <span>ENTER<small>Go inside</small></span>
    </a>

    <!-- MAP -->
    <a class="gd-diamond" id="map" href="/prelude/">
      <span>MAP<small>Get oriented</small></span>
    </a>

  </div>
</div>

<script>
(function(){
  var qs=new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  var depth = qs.get("depth") || localStorage.getItem("gd_depth") || "explore";

  if(lang!=="en" && lang!=="zh" && lang!=="es") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time==="trajectory") time="post";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";
  if(depth!=="explore" && depth!=="learn") depth="explore";

  try{
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);
    localStorage.setItem("gd_depth",depth);
  }catch(e){}

  function q(){
    return "?lang="+encodeURIComponent(lang)+
           "&style="+encodeURIComponent(style)+
           "&time="+encodeURIComponent(time)+
           "&depth="+encodeURIComponent(depth);
  }

  // Carry state into routes
  document.getElementById("enter").href="/home/"+q();
  document.getElementById("map").href="/prelude/"+q();

  // Minimal language swap (labels only). No UI added.
  if(lang==="zh"){
    document.querySelector("#enter span").childNodes[0].nodeValue="进入";
    document.querySelector("#enter small").textContent="直接进入";
    document.querySelector("#map span").childNodes[0].nodeValue="地图";
    document.querySelector("#map small").textContent="先看结构";
  }else if(lang==="es"){
    document.querySelector("#enter span").childNodes[0].nodeValue="ENTRAR";
    document.querySelector("#enter small").textContent="Ir adentro";
    document.querySelector("#map span").childNodes[0].nodeValue="MAPA";
    document.querySelector("#map small").textContent="Orientarse";
  }
})();
</script>

</body>
</html>
