<!-- TNT — /index.html  (TERMINAL · 2 PRIMARY DIAMONDS → STACKED HORIZONTAL JUMP BUBBLES)
     LOCKS:
       - TNT ONLY (full file)
       - Uses /assets/ui.css + /assets/branch.css only
       - DO NOT style html/body background (ui.css owns field)
       - NO LENSES ANYWHERE (no STYLE/TIME chips, no toggles)
       - Jump-only navigation (uniform buttons only; use crp-btn)
       - Dual language compatible (single-language render via gd_lang / ?lang=)
       - Terminal does NOT modify gd_style/gd_time; it preserves and propagates if present
       - 2 primary diamonds (front surface) open modal
       - Modal content is stacked full-width horizontal bubble rows (accordion), one open at a time
       - Marketing tone (movie board) with bounded language (no promises, no timelines, no fusion overclaim)
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>TERMINAL · Movie Board</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
/* DO NOT TOUCH FIELD — ui.css owns html/body background */
a{color:inherit;text-decoration:none}

/* Layout wrapper */
.term-wrap{width:min(980px,94vw);margin:0 auto;padding:22px 0 120px}

/* Top-left */
.top-left{position:fixed;left:16px;top:16px;z-index:90;display:flex;gap:10px;flex-wrap:wrap;align-items:center}

/* Brand pill */
.brand{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  z-index:80;text-align:center;padding:10px 14px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);backdrop-filter:blur(8px);
}
.brand .name{font-weight:950;letter-spacing:1.2px;font-size:12px;opacity:.95}
.brand .tag{font-size:11px;letter-spacing:.6px;opacity:.70;margin-top:2px}

/* Stage (2 diamonds) */
:root{--R:154px;--neutralRed:rgba(176,0,0,.16);--neutralGold:rgba(212,175,55,.35);--mut:rgba(255,255,255,.84)}
.stage{
  position:fixed;left:50%;top:52%;
  transform:translate(-50%,-50%);
  width:min(720px,94vw);height:min(720px,94vw);
  z-index:60;
  pointer-events:none;
}
.outer{
  position:absolute;left:50%;top:50%;
  width:min(680px,92vw);height:min(680px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  background:
    radial-gradient(circle at 52% 14%, var(--neutralRed), transparent 55%),
    radial-gradient(circle at 38% 28%, rgba(90,140,255,.10), transparent 55%),
    linear-gradient(145deg, rgba(17,22,28,.56), rgba(11,15,20,.70));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 90px 260px rgba(0,0,0,.72), inset 0 2px 0 rgba(255,255,255,.10), inset 0 -50px 90px rgba(0,0,0,.55);
  opacity:.88;
  pointer-events:none;
}
.d{
  width:210px;height:210px;position:absolute;left:50%;top:50%;
  transform-origin:center;border-radius:26px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  background:
    radial-gradient(circle at 35% 22%, rgba(255,255,255,.18), transparent 58%),
    radial-gradient(circle at 70% 82%, rgba(0,80,255,.18), transparent 62%),
    linear-gradient(160deg, rgba(12,22,38,.94) 0%, rgba(7,11,18,.96) 72%);
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 30px 90px rgba(0,0,0,.78), inset 0 2px 0 rgba(255,255,255,.10);
  transition:transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
  pointer-events:auto;
  touch-action:manipulation;
  overflow:hidden;
}
.d::before{
  content:"";position:absolute;inset:0;border-radius:26px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--neutralGold) 50%, transparent 100%);
  opacity:.35;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.d:hover{
  box-shadow:0 36px 120px rgba(0,0,0,.90),0 0 22px rgba(212,175,55,.22), inset 0 2px 0 rgba(255,255,255,.12);
  border-color:rgba(212,175,55,.30);
}
.d-left{transform:translate(-50%,-50%) translate(calc(var(--R) * -0.82), 0) rotate(45deg)}
.d-right{transform:translate(-50%,-50%) translate(calc(var(--R) * 0.82), 0) rotate(45deg)}
.inner{
  width:100%;height:100%;
  transform:rotate(-45deg);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;padding:16px;gap:10px;
  pointer-events:none;user-select:none
}
.lab{font-weight:950;letter-spacing:.8px;font-size:18px}
.sub{font-size:12.5px;opacity:.82;line-height:1.28;max-width:20em}
.core{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:74px;height:74px;border-radius:22px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  box-shadow:0 18px 44px rgba(0,0,0,.62), inset 0 2px 0 rgba(255,255,255,.10);
  display:grid;place-items:center;font-weight:950;letter-spacing:.5px;opacity:.92;
  pointer-events:none;
}

/* Dock */
.dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;
  width:min(980px,94vw);
  display:flex;justify-content:center;gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  backdrop-filter:blur(8px);
}

/* Modal */
.bd{
  position:fixed;inset:0;z-index:200;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(10px);
  display:none;
}
.bd.show{display:block;}
.modal{
  position:fixed;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:min(1180px,96vw);
  max-height:90vh;
  display:none;z-index:210;
}
.modal.show{display:block;}
.shell{
  height:90vh;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 52% 14%, rgba(176,0,0,.16), transparent 55%),
    radial-gradient(circle at 38% 28%, rgba(90,140,255,.12), transparent 55%),
    linear-gradient(145deg, rgba(17,22,28,.90), rgba(11,15,20,.94));
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:hidden;
  display:flex;flex-direction:column;
}
.mhead{
  display:flex;justify-content:space-between;align-items:center;gap:10px;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08);
}
.mtitle{margin:0;font-weight:950;letter-spacing:.3px;font-size:16px}
.mclose{border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;padding:8px 10px}
.mbody{padding:14px 16px 18px;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}

/* Header card */
.hcard{
  padding:14px 16px;border-radius:22px;margin:0 0 14px;
  background:rgba(0,0,0,.10);
  border:1px solid rgba(255,255,255,.10);
}
.hcard .h1{margin:0 0 6px;font-weight:950;font-size:16px}
.hcard .h2{margin:0;color:var(--mut);line-height:1.55}
.hcard .h3{margin:10px 0 0;color:rgba(255,255,255,.70);font-size:12px;line-height:1.45}

/* Stacked horizontal bubbles (accordion) */
.stackList{display:flex;flex-direction:column;gap:12px;margin:0 0 14px}
.stackRow{
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:linear-gradient(145deg, rgba(17,22,28,.86), rgba(11,15,20,.92));
  box-shadow:0 16px 52px rgba(0,0,0,.60);
  overflow:hidden;
}
.stackHead{
  display:flex;align-items:center;justify-content:space-between;
  gap:10px;padding:14px 16px;cursor:pointer;-webkit-tap-highlight-color:transparent;
}
.stackLeft{display:flex;align-items:center;gap:12px;min-width:0}
.stackBar{width:6px;height:22px;border-radius:99px;background:var(--domc, rgba(255,255,255,.20));box-shadow:0 0 18px rgba(255,255,255,.08);flex:0 0 auto}
.stackTitle{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.stackSub{font-size:12px;opacity:.72;margin-left:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.stackChevron{font-size:16px;opacity:.75;flex:0 0 auto}
.stackBody{
  display:none;
  padding:14px 16px 10px;
  border-top:1px solid rgba(255,255,255,.08);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
}
.stackRow.open .stackBody{display:block}

.pdesc{margin:0 0 10px;color:rgba(255,255,255,.86);line-height:1.55}
.jumpRow{display:flex;gap:10px;flex-wrap:wrap}
.jumpRow a.crp-btn{display:inline-flex}

/* Footer actions */
.mact{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}
</style>
</head>

<body>

<div class="top-left">
  <a class="crp-btn" id="btnExit" href="/door/">EXIT</a>
  <a class="crp-btn" id="btnHub" href="/home/">HUB</a>
</div>

<div class="brand">
  <div class="name" id="brandName">TERMINAL</div>
  <div class="tag" id="brandTag">Two diamonds · Jump-only · No drift</div>
</div>

<div class="stage" aria-label="Terminal two-diamond entry">
  <div class="outer"></div>

  <div class="d d-left" id="dNext" role="button" tabindex="0">
    <div class="inner">
      <div class="lab" id="labNext">WHERE TO GO NEXT</div>
      <div class="sub" id="subNext">Fast orientation · Clean jumps · Return-safe</div>
    </div>
  </div>

  <div class="d d-right" id="dBoard" role="button" tabindex="0">
    <div class="inner">
      <div class="lab" id="labBoard">TRAILER BOARD</div>
      <div class="sub" id="subBoard">Big missions · Bounded execution · Explore safely</div>
    </div>
  </div>

  <div class="core">◆</div>
</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="crp-btn crp-btn-primary" id="dockTerminal" href="/index.html">TERMINAL</a>
  <a class="crp-btn" id="dockLinks" href="/links/">LINKS</a>
  <a class="crp-btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="crp-btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="crp-btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<div class="bd" id="bd" aria-hidden="true"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true" aria-label="Terminal panel">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">TERMINAL</h3>
      <button class="mclose" id="mClose" aria-label="Close" type="button">✕</button>
    </div>

    <div class="mbody">
      <div class="hcard">
        <div class="h1" id="mh1">—</div>
        <div class="h2" id="mh2">—</div>
        <div class="h3" id="mh3">—</div>
      </div>

      <div class="stackList" id="stackList"></div>

      <div class="mact">
        <button class="crp-btn" id="mReturn" type="button">RETURN</button>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // Preserve any existing query params; Terminal does not modify style/time.
  const qs=new URLSearchParams(location.search);
  let lang = qs.get("lang") || localStorage.getItem("gd_lang") || "en";
  if(lang!=="en" && lang!=="zh") lang="en";
  try{ localStorage.setItem("gd_lang",lang);}catch(e){}
  document.documentElement.lang = (lang==="zh") ? "zh" : "en";

  // Preserve style/time if present (or stored), but DO NOT change them here.
  const style = qs.get("style") || localStorage.getItem("gd_style") || "";
  const time  = qs.get("time")  || localStorage.getItem("gd_time")  || "";

  function q(){
    const p = new URLSearchParams();
    if(lang) p.set("lang",lang);
    if(style) p.set("style",style);
    if(time) p.set("time",time);
    const s = p.toString();
    return s ? ("?"+s) : "";
  }

  // Wire top buttons + dock
  document.getElementById("btnExit").href="/door/"+q();
  document.getElementById("btnHub").href="/home/"+q();

  document.getElementById("dockTerminal").href="/index.html"+q();
  document.getElementById("dockLinks").href="/links/"+q();
  document.getElementById("dockProducts").href="/products/"+q();
  document.getElementById("dockLaws").href="/laws/"+q();
  document.getElementById("dockGauges").href="/gauges/"+q();

  // Modal refs
  const bd=document.getElementById("bd");
  const modal=document.getElementById("modal");
  const mClose=document.getElementById("mClose");
  const mReturn=document.getElementById("mReturn");
  const mTitle=document.getElementById("mTitle");
  const mh1=document.getElementById("mh1");
  const mh2=document.getElementById("mh2");
  const mh3=document.getElementById("mh3");
  const stackList=document.getElementById("stackList");

  function openModal(mode){
    bd.classList.add("show");
    modal.classList.add("show");
    render(mode);
  }
  function closeModal(){
    bd.classList.remove("show");
    modal.classList.remove("show");
  }
  bd.addEventListener("click", closeModal);
  mClose.addEventListener("click", closeModal);
  mReturn.addEventListener("click", closeModal);

  // Two diamonds click
  const dNext=document.getElementById("dNext");
  const dBoard=document.getElementById("dBoard");
  dNext.addEventListener("click", ()=>openModal("nav"));
  dBoard.addEventListener("click", ()=>openModal("board"));
  dNext.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openModal("nav"); }});
  dBoard.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openModal("board"); }});

  function row(title, sub, copy, jumps, color){
    return {title, sub, copy, jumps, color};
  }
  function jump(label, href){ return {label, href}; }

  function render(mode){
    stackList.innerHTML="";
    const ACC = { nav:"#D4AF37", board:"#93C5FD" };

    const rows = (mode==="nav")
      ? [
          row("HOW NAVIGATION WORKS","Move fast without getting lost.",
              "This system is built for traversal under pressure: clean jumps, predictable returns, and no dead ends. If you feel lost, go to HUB and re-orient.",
              [ jump("JUMP HUB","/home/"), jump("JUMP PRODUCTS","/products/"), jump("JUMP LINKS","/links/") ],
              ACC.nav),
          row("STATE STABILITY","Your context should not reset.",
              "Language, style, and time can persist across the site. Terminal preserves what you already have — it does not change your settings.",
              [ jump("JUMP GAUGES","/gauges/"), jump("JUMP LAWS","/laws/"), jump("JUMP HUB","/home/") ],
              ACC.nav),
          row("UNDER CONSTRUCTION","Visible progress, no broken flows.",
              "Some surfaces are being filled node-by-node. Placeholders are intentional: they keep navigation unbroken and prevent implied claims.",
              [ jump("JUMP PRODUCTS","/products/"), jump("JUMP INNOVATION","/explore/"), jump("JUMP LINKS","/links/") ],
              ACC.nav)
        ]
      : [
          row("SOLAR EXPLORATION","The frontier lane.",
              "Look up — but keep your feet on the ground. Big questions survive only when they pass constraints and measurement. Explore the frontier without drifting into fantasy.",
              [ jump("JUMP INNOVATION","/explore/"), jump("JUMP LAWS","/laws/"), jump("JUMP GAUGES","/gauges/") ],
              ACC.board),
          row("ENERGY INDUSTRIALIZATION","Make it real, safely.",
              "Industrial heat first. Measurable substitution. Upstream containment. Public posture stays Industrial Plasma Thermal Substitution (C). Fusion is gated readiness — requirements only.",
              [ jump("JUMP ENERGY","/products/energy/"), jump("FUSION READINESS","/explore/fusion-readiness/"), jump("JUMP GOVERNANCE","/laws/") ],
              ACC.board),
          row("LANGUAGE & LEARNING","Scale begins with clarity.",
              "If you can’t say it clearly, you can’t scale it. This lane compresses learning into something you can carry: fewer words, more control, more reach.",
              [ jump("JUMP EDUCATION","/products/education/"), jump("JUMP HUB","/home/"), jump("JUMP LINKS","/links/") ],
              ACC.board),
          row("SOFTWARE INSTRUMENTS","Tools that remove noise.",
              "Tools don’t replace judgment — they remove friction. This lane turns structure into interfaces: dashboards, routing, and execution surfaces that stay coherent under pressure.",
              [ jump("JUMP SOFTWARE","/products/software/"), jump("JUMP GAUGES","/gauges/"), jump("JUMP LAWS","/laws/") ],
              ACC.board),
          row("FACT-CHECKING MODE","Hard bounds only.",
              "No vibes. No faith-based engineering. Definitions, falsifiers, receipts. If it can’t be bounded, it can’t be claimed. If it can’t be measured, it stays conceptual.",
              [ jump("JUMP LAWS","/laws/"), jump("JUMP GAUGES","/gauges/"), jump("JUMP LINKS","/links/") ],
              ACC.board),
          row("RESILIENCE & READINESS","Calm execution.",
              "This lane is calm, not fear-driven. Planning, redundancy, and coherence when conditions change fast. No guarantees. Just preparation you can execute.",
              [ jump("JUMP PRODUCTS","/products/"), jump("JUMP LAWS","/laws/"), jump("JUMP LINKS","/links/") ],
              ACC.board),
          row("FRONTIER SUBSTRATE","The spine.",
              "Structure before claims. Evidence before scale. If it can’t pass the substrate, it doesn’t execute — and that’s the whole point.",
              [ jump("JUMP LAWS","/laws/"), jump("JUMP LINKS","/links/"), jump("JUMP HUB","/home/") ],
              ACC.board)
        ];

    mTitle.textContent = (mode==="nav") ? "TERMINAL · WHERE TO GO NEXT" : "TERMINAL · TRAILER BOARD";
    mh1.textContent = (mode==="nav") ? "Fast orientation. Clean jumps." : "Pick a trailer. Jump to the trunk.";
    mh2.textContent = (mode==="nav")
      ? "No lenses here. No drift. Direct routes that preserve your existing state."
      : "Exciting, bounded, executable. No promises. Receipts decide upgrades.";
    mh3.textContent = (mode==="nav")
      ? "If you’re unsure where to go, start with HUB."
      : "Energy remains Industrial (C). Fusion is gated readiness only.";

    let openIndex = 0;
    rows.forEach((r, idx)=>{
      const row=document.createElement("div");
      row.className="stackRow"+(idx===openIndex ? " open" : "");
      row.style.setProperty("--domc", r.color);

      const head=document.createElement("div");
      head.className="stackHead";

      const left=document.createElement("div");
      left.className="stackLeft";

      const bar=document.createElement("div");
      bar.className="stackBar";
      bar.style.background=r.color;

      const title=document.createElement("div");
      title.className="stackTitle";
      title.textContent=r.title;

      const sub=document.createElement("div");
      sub.className="stackSub";
      sub.textContent=r.sub;

      left.appendChild(bar);
      left.appendChild(title);
      left.appendChild(sub);

      const chev=document.createElement("div");
      chev.className="stackChevron";
      chev.textContent = (idx===openIndex) ? "▾" : "▸";

      head.appendChild(left);
      head.appendChild(chev);

      const body=document.createElement("div");
      body.className="stackBody";

      const copy=document.createElement("p");
      copy.className="pdesc";
      copy.textContent=r.copy;

      const jr=document.createElement("div");
      jr.className="jumpRow";

      r.jumps.forEach(j=>{
        const a=document.createElement("a");
        a.className="crp-btn";
        a.textContent=j.label;
        a.href = j.href + q();
        jr.appendChild(a);
      });

      body.appendChild(copy);
      body.appendChild(jr);

      head.addEventListener("click", ()=>{
        openIndex = idx;
        render(mode);
      });

      row.appendChild(head);
      row.appendChild(body);
      stackList.appendChild(row);
    });
  }

})();
</script>

</body>
</html>
