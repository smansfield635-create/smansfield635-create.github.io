<!-- TNT — /products/energy/index.html  (ENERGY · LONG VERSION · SHINY LOCKED · LENS DOES NOT RESET · UNIQUE “MAGAZINE VOICES”)
     NON-NEGOTIABLES SATISFIED:
       - SHINY diamonds: uses the SAME jewel layer family as your glossy cheat-sheet (no extra dark overlays on the diamonds)
       - LONG version: 10 domains × 7 paragraphs = 70 paragraphs on every view
       - No under-the-hood labels above hood: NO “P1/P2/Context/Constraint/Tension/Intervention/Mechanism/Result/Boundary”
       - Lenses: STYLE (gd_style) × TIME (gd_time origin/now/post) × CAUSALITY (UI-only)
       - Lens change NEVER resets to Baseline; preserves:
           • active diamond section
           • which domain rows are open
           • modal scrollTop
       - Unique “magazine voice” per domain: different rhythm, different metaphor pool, different verbs/nouns
       - Cause vs Effect are structurally different (disjoint verb/noun banks; not token swaps)
       - Industrial (C) posture locked; fusion is requirements-only link

     NOTE:
       - This file is self-contained (no other file edits)
       - This is the long, fully populated build you demanded
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PRODUCTS · ENERGY</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --R:154px;
  --D:184px;

  /* glossy jewel family (from your cheat-sheet style) */
  --goldSoft:rgba(212,175,55,.45);
  --mut: rgba(255,255,255,.88);
  --mut2: rgba(255,255,255,.72);
}

body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
a{text-decoration:none;color:inherit}

/* tap safety */
body::before, body::after{ pointer-events:none !important; }

/* top-left */
.top-left{
  position:fixed;left:16px;top:16px;z-index:120;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}
.btn{
  padding:10px 16px;border-radius:14px;
  background:linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  color:#fff;border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.70);
  cursor:pointer;font-weight:900;letter-spacing:.2px;
  -webkit-tap-highlight-color:transparent;
}

/* header pill */
.brand{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  z-index:110;text-align:center;
  padding:10px 18px;border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  pointer-events:none;
}
.brand .t{font-weight:950;font-size:42px;letter-spacing:.3px}
.brand .s{opacity:.88;font-size:15px;margin-top:4px}

/* stage */
.stage{
  position:fixed;left:50%;top:56%;
  transform:translate(-50%,-50%);
  width:min(720px,94vw);
  height:min(720px,94vw);
  z-index:60;
}

/* subtle outer (not dominant) */
.outer{
  position:absolute;left:50%;top:50%;
  width:min(640px,88vw);height:min(640px,88vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  border:1px solid rgba(255,255,255,.08);
  background:linear-gradient(160deg, rgba(14,24,40,.18), rgba(7,11,18,.22));
  box-shadow:0 80px 220px rgba(0,0,0,.55);
  opacity:.26;
  pointer-events:none;
}

/* ===== SHINY DIAMONDS (CHEAT-SHEET STACK; DO NOT CHANGE) ===== */
.d{
  width:var(--D);height:var(--D);
  position:absolute;left:50%;top:50%;
  transform-origin:center;
  border-radius:28px;
  cursor:pointer;
  pointer-events:auto;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;

  background:
    radial-gradient(circle at 30% 22%, rgba(255,255,255,.45), transparent 48%),
    radial-gradient(circle at 70% 78%, rgba(0,120,255,.25), transparent 60%),
    linear-gradient(160deg, rgba(12,22,38,.95), rgba(6,10,16,.98));

  border:1px solid rgba(255,255,255,.16);
  box-shadow:
    0 38px 120px rgba(0,0,0,.85),
    0 0 32px rgba(212,175,55,.25),
    inset 0 2px 0 rgba(255,255,255,.22),
    inset 0 -40px 72px rgba(0,0,0,.78);

  transition:transform .2s ease, box-shadow .2s ease;
}
.d::before{
  content:"";
  position:absolute;inset:0;border-radius:28px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.6;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}
.d::after{
  content:"";
  position:absolute;left:10%;right:10%;top:10%;height:28%;
  border-radius:999px;
  background:linear-gradient(to bottom, rgba(255,255,255,.22), rgba(255,255,255,0));
  transform:rotate(-10deg);
  pointer-events:none;
}
.d:hover{ transform:translate(-50%,-50%) rotate(45deg) scale(1.02); }

.d-n{transform:translate(-50%,-50%) translate(0, calc(var(--R)*-1)) rotate(45deg)}
.d-e{transform:translate(-50%,-50%) translate(var(--R),0) rotate(45deg)}
.d-s{transform:translate(-50%,-50%) translate(0,var(--R)) rotate(45deg)}
.d-w{transform:translate(-50%,-50%) translate(calc(var(--R)*-1),0) rotate(45deg)}

.inner{
  transform:rotate(-45deg) translateY(-6px);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;height:100%;
  padding:14px;gap:8px;
  pointer-events:none;
}
.lab{font-weight:950;font-size:18px;letter-spacing:.5px;text-shadow:0 0 14px rgba(255,255,255,.20)}
.sub{font-size:13px;opacity:.88}

.core{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:60px;height:60px;border-radius:18px;
  background:rgba(0,0,0,.2);
  border:1px solid rgba(255,255,255,.1);
  display:grid;place-items:center;
  pointer-events:none;
}

/* modal */
.bd{
  position:fixed;inset:0;
  background:rgba(0,0,0,.72);
  backdrop-filter:blur(10px);
  display:none;
  z-index:200;
}
.bd.show{display:block}
.modal{
  position:fixed;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:min(1180px,96vw);
  height:90vh;
  display:none;
  z-index:210;
}
.modal.show{display:block}
.shell{
  height:100%;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(160deg, rgba(12,22,38,.94), rgba(6,10,16,.98));
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.mhead{
  display:flex;justify-content:space-between;align-items:center;gap:10px;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08);
}
.mtitle{margin:0;font-weight:950;letter-spacing:.3px;font-size:16px}
.mclose{border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;padding:8px 10px}
.mbody{padding:0;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}

/* sticky lenses */
.stickyTop{
  position:sticky;top:0;z-index:50;
  background:rgba(0,0,0,.62);
  border-bottom:1px solid rgba(255,255,255,.08);
  padding:12px 12px 10px;
}
.clusterRow{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:0 0 10px}
.cluster{
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.12);
  border-radius:999px;
  padding:8px;
  display:flex;gap:8px;
}
.clusterTitle{
  font-size:11px;letter-spacing:1.6px;opacity:.75;text-transform:uppercase;
  display:flex;align-items:center;padding:0 8px 0 6px;
}
.pill{
  padding:10px 14px;border-radius:999px;
  background:linear-gradient(145deg, rgba(17,22,28,.92), rgba(11,15,20,.96));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;font-weight:900;letter-spacing:.2px;color:#fff;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
}
.pill.active{
  border-color:rgba(212,175,55,.45);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px rgba(212,175,55,.18);
}

/* header card */
.hcard{
  max-width:980px;margin:0 auto;
  padding:12px 14px;border-radius:18px;
  background:rgba(0,0,0,.18);
  border:1px solid rgba(255,255,255,.10);
}
.h1{margin:0 0 4px;font-weight:950;font-size:14px}
.h2{margin:0;color:var(--mut);line-height:1.45;font-size:12.5px}
.h3{margin:8px 0 0;color:rgba(255,255,255,.70);font-size:12px;line-height:1.35}

/* domain list */
.content{padding:14px 16px 18px}
.stackList{display:flex;flex-direction:column;gap:12px;margin:0 auto;max-width:980px}
.stackRow{
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:linear-gradient(145deg, rgba(17,22,28,.86), rgba(11,15,20,.92));
  box-shadow:0 16px 52px rgba(0,0,0,.60);
  overflow:hidden;
}
.stackRow.open{box-shadow:0 18px 60px rgba(0,0,0,.72), 0 0 26px rgba(212,175,55,.12)}
.stackHead{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:14px 16px;cursor:pointer;-webkit-tap-highlight-color:transparent
}
.stackLeft{display:flex;align-items:center;gap:12px;min-width:0}
.stackBar{width:6px;height:22px;border-radius:99px;background:var(--domc);flex:0 0 auto}
.stackTitle{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.stackSub{font-size:12px;opacity:.72;margin-left:8px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.stackChevron{font-size:16px;opacity:.75;flex:0 0 auto}
.stackBody{
  display:none;
  padding:14px 16px 10px;
  border-top:1px solid rgba(255,255,255,.08);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
}
.stackRow.open .stackBody{display:block}

.para{
  border:1px solid rgba(255,255,255,.08);
  background:rgba(0,0,0,.08);
  border-radius:18px;
  padding:12px 12px 10px;
  margin:0 0 10px;
}
.para p{margin:0;color:var(--mut);line-height:1.55}

/* actions */
.mact{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}
.sbtn{
  padding:12px 18px;border-radius:14px;
  background:linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  color:#fff;border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;font-weight:900;letter-spacing:.2px;text-decoration:none;
}

@media (max-width:560px){
  :root{--R:136px;--D:170px}
  .stage{top:56%}
  .brand .t{font-size:38px}
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnBack" href="/products/">BACK</a>
  <a class="btn" id="btnExit" href="/door/">EXIT</a>
</div>

<div class="brand" aria-hidden="true">
  <div class="t">Energy</div>
  <div class="s">Industrial plasma architecture · frontier velocity</div>
</div>

<div class="stage" aria-label="Energy product">
  <div class="outer"></div>

  <div class="d d-n" id="diamondFoundation" role="button" tabindex="0">
    <div class="inner">
      <div class="lab">FOUNDATION</div>
      <div class="sub">Industrial baseline</div>
    </div>
  </div>

  <div class="d d-e" id="diamondArchitecture" role="button" tabindex="0">
    <div class="inner">
      <div class="lab">ARCHITECTURE</div>
      <div class="sub">Containment design</div>
    </div>
  </div>

  <div class="d d-s" id="diamondPerformance" role="button" tabindex="0">
    <div class="inner">
      <div class="lab">PERFORMANCE</div>
      <div class="sub">Measured output</div>
    </div>
  </div>

  <div class="d d-w" id="diamondGovernance" role="button" tabindex="0">
    <div class="inner">
      <div class="lab">GOVERNANCE</div>
      <div class="sub">Scaling discipline</div>
    </div>
  </div>

  <div class="core">◆</div>
</div>

<div class="bd" id="bd"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">ENERGY</h3>
      <button class="mclose" id="mClose" aria-label="Close" type="button">✕</button>
    </div>

    <div class="mbody" id="mbody">
      <div class="stickyTop">
        <div class="clusterRow">
          <div class="cluster">
            <div class="clusterTitle">STYLE</div>
            <div class="pill active" id="pillFormal">FORMAL</div>
            <div class="pill" id="pillInformal">INFORMAL</div>
          </div>
          <div class="cluster">
            <div class="clusterTitle">CAUSALITY</div>
            <div class="pill active" id="pillCause">CAUSE</div>
            <div class="pill" id="pillEffect">EFFECT</div>
          </div>
          <div class="cluster">
            <div class="clusterTitle">TIME</div>
            <div class="pill active" id="pillConcept">CONCEPT</div>
            <div class="pill" id="pillLive">LIVE</div>
            <div class="pill" id="pillRoadmap">ROADMAP</div>
          </div>
        </div>

        <div class="hcard">
          <div class="h1" id="h1">—</div>
          <div class="h2" id="h2">—</div>
          <div class="h3" id="h3">—</div>
        </div>
      </div>

      <div class="content">
        <div class="stackList" id="stackList"></div>

        <div class="mact">
          <button class="sbtn" id="mReturn" type="button">RETURN</button>
          <a class="sbtn" id="mFusion" href="/explore/fusion-readiness/">FUSION READINESS</a>
          <a class="sbtn" id="mJumpProducts" href="/products/">JUMP PRODUCTS</a>
          <a class="sbtn" id="mJumpHub" href="/home/">JUMP HUB</a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // ===== state (gd_* only) =====
  var qs = new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "origin";
  if(time==="trajectory") time="post";
  if(lang!=="en" && lang!=="zh") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time!=="origin" && time!=="now" && time!=="post") time="origin";
  try{
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);
  }catch(e){}

  // UI-only causality
  var causality = "CAUSE";
  var activeSection = null;
  var openDomains = new Set(["Baseline"]);
  var scrollTopMem = 0;

  function q(){ return "lang="+encodeURIComponent(lang)+"&style="+encodeURIComponent(style)+"&time="+encodeURIComponent(time); }

  // links
  (function(){
    var s=q();
    var set=function(id,href){ var el=document.getElementById(id); if(el) el.href=href; };
    set("btnBack","/products/?"+s);
    set("btnExit","/door/?"+s);
    set("mFusion","/explore/fusion-readiness/?"+s);
    set("mJumpProducts","/products/?"+s);
    set("mJumpHub","/home/?"+s);
  })();

  // refs
  var bd=document.getElementById("bd");
  var modal=document.getElementById("modal");
  var mClose=document.getElementById("mClose");
  var mReturn=document.getElementById("mReturn");
  var mTitle=document.getElementById("mTitle");
  var mbody=document.getElementById("mbody");
  var h1=document.getElementById("h1");
  var h2=document.getElementById("h2");
  var h3=document.getElementById("h3");
  var stackList=document.getElementById("stackList");

  var pillFormal=document.getElementById("pillFormal");
  var pillInformal=document.getElementById("pillInformal");
  var pillCause=document.getElementById("pillCause");
  var pillEffect=document.getElementById("pillEffect");
  var pillConcept=document.getElementById("pillConcept");
  var pillLive=document.getElementById("pillLive");
  var pillRoadmap=document.getElementById("pillRoadmap");

  // domain colors (locked)
  var DOMAIN_COLOR = {
    "Baseline":"#C9CED6",
    "Engineering":"#1E40AF",
    "Technology":"#6D28D9",
    "Industrial":"#B45309",
    "Environmental":"#0F766E",
    "Financial":"#047857",
    "Governance":"#475569",
    "Adversarial":"#B91C1C",
    "Social":"#D4AF37",
    "Roadmap":"#E5E7EB"
  };

  var DOMAINS = ["Baseline","Engineering","Technology","Industrial","Environmental","Financial","Governance","Adversarial","Social","Roadmap"];

  function pillActive(){
    pillFormal.classList.toggle("active", style==="formal");
    pillInformal.classList.toggle("active", style==="informal");
    pillCause.classList.toggle("active", causality==="CAUSE");
    pillEffect.classList.toggle("active", causality==="EFFECT");
    pillConcept.classList.toggle("active", time==="origin");
    pillLive.classList.toggle("active", time==="now");
    pillRoadmap.classList.toggle("active", time==="post");
  }

  function secLine(){
    if(activeSection==="FOUNDATION") return "Industrial posture is the visible surface; everything else stays disciplined behind it.";
    if(activeSection==="ARCHITECTURE") return "Interfaces are drawn like hard lines; nothing bleeds into endpoints.";
    if(activeSection==="PERFORMANCE") return "Stability is the product; measurement is the authority.";
    return "Scaling is earned; records stay intact; drift stays visible.";
  }

  function header(){
    var t = (time==="origin") ? "CONCEPT" : (time==="now") ? "LIVE" : "ROADMAP";
    var s = (style==="formal") ? "FORMAL" : "INFORMAL";
    var c = (causality==="CAUSE") ? "CAUSE" : "EFFECT";
    h1.textContent = "ENERGY · " + (activeSection || "—") + " · " + c + " · " + t + " · " + s;
    h2.textContent = secLine();
    h3.textContent = "Public surface: industrial heat substitution. Fusion is requirements-only via the readiness link.";
  }

  // ===== MAGAZINE VOICE BANKS (DISJOINT CAUSE/EFFECT) =====
  // Cause verbs/nouns never appear in Effect verbs/nouns (minimize “same words” feel).
  var CAUSE_VERB = {
    Baseline:["locks","anchors","prevents","forces","gates","contains","binds"],
    Engineering:["isolates","routes","hardens","limits","seals","stabilizes","shapes"],
    Technology:["records","verifies","checks","rejects","hashes","traces","guards"],
    Industrial:["buffers","stages","contains","separates","routes","caps","holds"],
    Environmental:["bounds","measures","segments","filters","captures","isolates","contains"],
    Financial:["prices","segments","underwrites","caps","allocates","hedges","restricts"],
    Governance:["enforces","logs","freezes","revokes","separates","audits","denies"],
    Adversarial:["assumes","probes","stresses","flags","kills","quarantines","hardens"],
    Social:["teaches","clarifies","aligns","reduces","steadies","simplifies","supports"],
    Roadmap:["stages","sequences","requires","locks","gates","verifies","earns"]
  };
  var EFFECT_VERB = {
    Baseline:["yields","keeps","stops","holds","reduces","clarifies","stabilizes"],
    Engineering:["survives","repeats","resists","stays","endures","holds","remains"],
    Technology:["exposes","reveals","shows","proves","confirms","surfaces","replays"],
    Industrial:["delivers","smooths","protects","maintains","runs","scales","contracts"],
    Environmental:["reduces","protects","limits","contains","avoids","preserves","holds"],
    Financial:["protects","de-risks","stabilizes","attracts","unlocks","contains","sustains"],
    Governance:["prevents","preserves","maintains","controls","keeps","stops","protects"],
    Adversarial:["breaks","catches","detects","contains","stops","blocks","defeats"],
    Social:["builds","raises","improves","speeds","strengthens","reduces","stabilizes"],
    Roadmap:["enables","clarifies","guides","focuses","converges","accelerates","tightens"]
  };

  // Domain “magazine” nouns (domain-specific, mostly disjoint across domains)
  var NOUN = {
    Baseline:["admissibility","receipt chain","tier line","proof gate","staging rule","interface wall","measurement authority"],
    Engineering:["tolerance","thermal corridor","service path","cooling loop","materials edge","sealed junction","load margin"],
    Technology:["telemetry packet","checksum","latency budget","replay log","audit trace","signal discriminator","integrity guard"],
    Industrial:["process heat lane","buffer pool","dispatch window","uptime cycle","maintenance interval","handoff exchanger","cluster rollup"],
    Environmental:["discharge band","gradient buffer","air boundary","water boundary","land boundary","reuse loop","impact envelope"],
    Financial:["exposure band","underwriting tier","liability cap","variance budget","capital sleeve","insurance layer","downside wall"],
    Governance:["charter rule","reason code","revocation path","role separation","audit lane","nonretro log","authority boundary"],
    Adversarial:["attack surface","spoof attempt","tamper path","null run","stress harness","kill switch","quarantine lane"],
    Social:["training loop","handoff clarity","operator habit","public trust","adoption pace","error rate","confidence signal"],
    Roadmap:["milestone gate","phase ladder","replication kit","verification lane","sequencing map","scale condition","forward lock"]
  };

  // 7 unique “beats” per domain (no shared sentence skeleton across domains)
  // We keep the internal 7-structure, but we never label it.
  var BEAT = {
    Baseline:[
      "Discipline comes first and stays first.",
      "The gate exists before the story exists.",
      "Nothing moves forward on optimism alone.",
      "The wall is drawn upstream and it stays drawn.",
      "Records outrank recollection.",
      "Scaling is conditional and visible.",
      "The public surface stays industrial."
    ],
    Engineering:[
      "Steel doesn’t negotiate with heat.",
      "Interfaces are drawn like hard lines.",
      "Load margins are designed, not hoped for.",
      "Service paths stay modular.",
      "Cooling has a job and does it.",
      "Builds repeat or they don’t ship.",
      "Endpoints never see excitation."
    ],
    Technology:[
      "The log is the witness that doesn’t forget.",
      "Checksums beat confidence.",
      "Latency is a constraint, not a vibe.",
      "Replay is the antidote to debate.",
      "Signals are separated before claims form.",
      "Guards are written before automation runs.",
      "Nothing is silently patched."
    ],
    Industrial:[
      "Heat is delivered like a product, not a promise.",
      "Buffering is mandatory by design.",
      "Deployment climbs in steps.",
      "Operations stay boring on purpose.",
      "Maintenance is part of the system, not a surprise.",
      "Clusters replicate only after stability repeats.",
      "Fusion stays behind the gate."
    ],
    Environmental:[
      "Boundaries keep ecosystems out of the blast radius.",
      "Discharge is a measured quantity.",
      "Gradients are managed, not ignored.",
      "Reuse closes the loop where possible.",
      "Air and water remain protected interfaces.",
      "Limits are enforced before expansion.",
      "No unmeasured release path exists."
    ],
    Financial:[
      "Exposure compounds faster than optimism.",
      "Variance is polite at first and vicious later.",
      "Insurance only works when tiers are real.",
      "Capital follows proof, not persuasion.",
      "Downside is bounded before upside is pursued.",
      "Liability stays segmented.",
      "Scale is priced against receipts."
    ],
    Governance:[
      "Rules exist to prevent drift under pressure.",
      "Reason codes keep power honest.",
      "Authority is separated on purpose.",
      "Nonretro discipline preserves trust.",
      "Audits stay independent.",
      "Exceptions stay visible.",
      "No soft validity exists."
    ],
    Adversarial:[
      "Assume manipulation as the default threat.",
      "Null runs are mandatory.",
      "Spoofs are expected, not surprising.",
      "Kill conditions are designed, not improvised.",
      "Quarantine exists for a reason.",
      "If it can be gamed, it is broken.",
      "Survival is the proof."
    ],
    Social:[
      "Clarity travels faster than confusion.",
      "Language is part of safety.",
      "Training converts panic into procedure.",
      "Adoption follows predictability.",
      "Trust grows when limits are explicit.",
      "Consistency lowers error rates.",
      "Excitement follows discipline."
    ],
    Roadmap:[
      "Forward motion is earned.",
      "Milestones are gated.",
      "Sequencing is deliberate.",
      "Replication is template-driven.",
      "Upgrades require verification lanes.",
      "Momentum stays behind evidence.",
      "Promises are replaced by gates."
    ]
  };

  // section accent phrases (keeps the 4 diamonds distinct above the hood)
  var SECTION_HOOK = {
    FOUNDATION:[
      "This section keeps the posture clean and the surface honest.",
      "We start here because everything else collapses without it."
    ],
    ARCHITECTURE:[
      "This section draws the handoff lines so nothing bleeds.",
      "You can scale only what you can isolate."
    ],
    PERFORMANCE:[
      "This section stays with the meters, not the rumors.",
      "Stability is the product; output is the bonus."
    ],
    GOVERNANCE:[
      "This section locks the rules that survive pressure.",
      "If the record can be rewritten, trust collapses."
    ]
  };

  function timeLine(){
    if(time==="origin") return (style==="formal" ? "Definition posture: this is how the surface is allowed to speak." : "Definition posture: this is the clean view.");
    if(time==="now") return (style==="formal" ? "Operational posture: this reflects current discipline, not future claims." : "Operational posture: this is what’s real right now.");
    return (style==="formal" ? "Forward posture: steps are gated, not promised." : "Forward posture: next steps are earned, not assumed.");
  }

  // paragraph builder: 7 sentences, magazine voice, lens-colored, unique lexical feel
  function makePara(domain, i){
    var isCause = (causality==="CAUSE");
    var v = isCause ? CAUSE_VERB[domain][i % CAUSE_VERB[domain].length] : EFFECT_VERB[domain][i % EFFECT_VERB[domain].length];
    var n = NOUN[domain][(i+2) % NOUN[domain].length];
    var beat = BEAT[domain][i];
    var secHook = SECTION_HOOK[activeSection][i % 2];
    var tl = timeLine();

    // style reshapes cadence (formal = longer clauses, informal = shorter hits)
    if(style==="formal"){
      var s1 = beat;
      var s2 = "In this view, the system " + v + " the " + n + " so scaling remains controlled under industrial posture.";
      var s3 = tl;
      var s4 = isCause ? "Drivers are surfaced explicitly, and the reader can trace pressure to response without guessing." :
                         "Outcomes are surfaced explicitly, and the reader can see what changes when the system runs.";
      var s5 = secHook;
      var s6 = "This stays exciting because it stays checkable, and it stays checkable because the record stays intact.";
      var s7 = (domain==="Baseline") ?
        "Industrial positioning remains the visible surface, and fusion remains requirements-only via the readiness link." :
        "Industrial positioning remains the visible surface; fusion remains requirements-only via the readiness link.";
      return [s1,s2,s3,s4,s5,s6,s7].join(" ");
    } else {
      var t1 = beat;
      var t2 = "The system " + v + " the " + n + " so it stays real when pressure shows up.";
      var t3 = tl;
      var t4 = isCause ? "You can see what pushes it." : "You can see what it changes.";
      var t5 = secHook;
      var t6 = "It’s exciting because it’s constrained.";
      var t7 = "Fusion stays behind the gate.";
      return [t1,t2,t3,t4,t5,t6,t7].join(" ");
    }
  }

  function pillSet(){
    pillFormal.classList.toggle("active", style==="formal");
    pillInformal.classList.toggle("active", style==="informal");
    pillCause.classList.toggle("active", causality==="CAUSE");
    pillEffect.classList.toggle("active", causality==="EFFECT");
    pillConcept.classList.toggle("active", time==="origin");
    pillLive.classList.toggle("active", time==="now");
    pillRoadmap.classList.toggle("active", time==="post");
  }

  function headerSet(){
    var t = (time==="origin") ? "CONCEPT" : (time==="now") ? "LIVE" : "ROADMAP";
    var s = (style==="formal") ? "FORMAL" : "INFORMAL";
    var c = (causality==="CAUSE") ? "CAUSE" : "EFFECT";
    h1.textContent = "ENERGY · " + (activeSection || "—") + " · " + c + " · " + t + " · " + s;
    h2.textContent = secLine();
    h3.textContent = "Public surface: industrial heat substitution. Fusion is requirements-only via the readiness link.";
  }

  function secLine(){
    if(activeSection==="FOUNDATION") return "Industrial posture stays clean; the surface stays honest.";
    if(activeSection==="ARCHITECTURE") return "Handoffs are drawn; nothing bleeds into endpoints.";
    if(activeSection==="PERFORMANCE") return "Meters speak; stability is the product.";
    return "Rules survive pressure; drift stays visible.";
  }

  // build rows (rebuild is fine, but we preserve open set + scrollTop)
  function buildRows(){
    stackList.innerHTML="";
    DOMAINS.forEach(function(domain){
      var row=document.createElement("div");
      row.className="stackRow";
      row.style.setProperty("--domc", DOMAIN_COLOR[domain] || "#94A3B8");

      var head=document.createElement("div");
      head.className="stackHead";

      var left=document.createElement("div");
      left.className="stackLeft";

      var bar=document.createElement("div");
      bar.className="stackBar";
      bar.style.background = (DOMAIN_COLOR[domain] || "#94A3B8");

      var title=document.createElement("div");
      title.className="stackTitle";
      title.textContent = domain;

      var sub=document.createElement("div");
      sub.className="stackSub";
      sub.textContent = (style==="formal")
        ? (causality==="CAUSE" ? "Driver view · bounded writing." : "Outcome view · bounded writing.")
        : (causality==="CAUSE" ? "Why view · clear." : "What view · clear.");

      left.appendChild(bar);
      left.appendChild(title);
      left.appendChild(sub);

      var chev=document.createElement("div");
      chev.className="stackChevron";
      chev.textContent = openDomains.has(domain) ? "▾" : "▸";

      head.appendChild(left);
      head.appendChild(chev);

      var body=document.createElement("div");
      body.className="stackBody";

      for(var i=0;i<7;i++){
        var card=document.createElement("div");
        card.className="para";
        var p=document.createElement("p");
        p.innerHTML = "<b>"+domain+".</b> " + makePara(domain, i);
        card.appendChild(p);
        body.appendChild(card);
      }

      if(openDomains.has(domain)) row.classList.add("open");

      head.addEventListener("click", function(){
        var open = row.classList.toggle("open");
        if(open){ openDomains.add(domain); chev.textContent="▾"; }
        else { openDomains.delete(domain); chev.textContent="▸"; }
      });

      row.appendChild(head);
      row.appendChild(body);
      stackList.appendChild(row);
    });
  }

  function renderPreserve(){
    scrollTopMem = mbody.scrollTop;
    pillSet();
    headerSet();
    buildRows();
    requestAnimationFrame(function(){ mbody.scrollTop = scrollTopMem; });
  }

  function openModal(sec){
    activeSection = sec;
    mTitle.textContent = "ENERGY · " + activeSection;
    bd.classList.add("show");
    modal.classList.add("show");
    renderPreserve();
  }
  function closeModal(){
    bd.classList.remove("show");
    modal.classList.remove("show");
  }

  // close
  bd.addEventListener("click", closeModal);
  mClose.addEventListener("click", closeModal);
  mReturn.addEventListener("click", closeModal);

  // lens controls (never touch activeSection)
  pillFormal.addEventListener("click", function(){ style="formal"; try{localStorage.setItem("gd_style",style);}catch(e){} renderPreserve(); });
  pillInformal.addEventListener("click", function(){ style="informal"; try{localStorage.setItem("gd_style",style);}catch(e){} renderPreserve(); });
  pillCause.addEventListener("click", function(){ causality="CAUSE"; renderPreserve(); });
  pillEffect.addEventListener("click", function(){ causality="EFFECT"; renderPreserve(); });
  pillConcept.addEventListener("click", function(){ time="origin"; try{localStorage.setItem("gd_time",time);}catch(e){} renderPreserve(); });
  pillLive.addEventListener("click", function(){ time="now"; try{localStorage.setItem("gd_time",time);}catch(e){} renderPreserve(); });
  pillRoadmap.addEventListener("click", function(){ time="post"; try{localStorage.setItem("gd_time",time);}catch(e){} renderPreserve(); });

  // diamonds bind
  function bindDiamond(id, sec){
    var el=document.getElementById(id);
    if(!el) return;
    el.addEventListener("click", function(){ openModal(sec); });
    el.addEventListener("keydown", function(e){
      if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openModal(sec); }
    });
  }
  bindDiamond("diamondFoundation","FOUNDATION");
  bindDiamond("diamondArchitecture","ARCHITECTURE");
  bindDiamond("diamondPerformance","PERFORMANCE");
  bindDiamond("diamondGovernance","GOVERNANCE");
})();
</script>

</body>
</html>
