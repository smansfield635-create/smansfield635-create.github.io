/* ============================================================
   CRP BRANCH GEOMETRY OWNER — SNOWFLAKE (6+1)
   FILE: /assets/branch.css
   OWNERSHIP:
   - Owns: geometry layouts + modal overlay/panel only
   - MUST NOT: define html/body background/field (ui.css owns that)
   - MUST NOT: redefine :root variables
   ============================================================ */

/* -----------------------------
   TERMINAL: 4 DIAMOND OPTIONS
   ----------------------------- */
.crp-terminal-grid{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:16px;
  width:100%;
  max-width:760px;
  margin:0 auto;
  padding:8px 0;
}
@media (max-width:520px){
  .crp-terminal-grid{ grid-template-columns:1fr; }
}
.crp-diamond{
  position:relative;
  display:grid;
  place-items:center;
  min-height:110px;
  width:100%;
  border:1px solid rgba(255,255,255,.22);
  background:rgba(0,0,0,.18);
  color:inherit;
  text-decoration:none;
  border-radius:16px;
  cursor:pointer;
  user-select:none;
  -webkit-tap-highlight-color:transparent;
  transition:transform .08s ease, background .12s ease, border-color .12s ease;
}
.crp-diamond:hover{ background:rgba(0,0,0,.24); border-color:rgba(255,255,255,.30); }
.crp-diamond:active{ transform:scale(.99); }
.crp-diamond:focus{ outline:none; }
.crp-diamond:focus-visible{
  box-shadow:0 0 0 3px rgba(255,255,255,.18);
  border-color:rgba(255,255,255,.38);
}
.crp-diamond::before{
  content:"";
  position:absolute;
  inset:12px;
  border:1px solid rgba(255,255,255,.16);
  border-radius:14px;
  transform:rotate(45deg);
  pointer-events:none;
}
.crp-diamond-label{
  font-weight:900;
  letter-spacing:.35px;
  font-size:18px;
}

/* ============================================================
   COMPASS: SNOWFLAKE (6 AXES + 1 NUCLEUS)
   Structure expectation in /home/index.html:
   <section class="crp-snowflake">
     <button class="crp-nucleus">DIAMOND</button>
     <button class="crp-axis" data-axis="rho">ρ</button>
     <button class="crp-axis" data-axis="tc">TC</button>
     <button class="crp-axis" data-axis="delta">Δ</button>
     <button class="crp-axis" data-axis="hip">HIP</button>
     <button class="crp-axis" data-axis="lambda">λ</button>
     <button class="crp-axis" data-axis="cert">CERT</button>
   </section>
   ============================================================ */

.crp-snowflake{
  /* fixed nucleus + 6 equidistant spokes (hex symmetry) */
  width:100%;
  max-width:980px;
  margin:0 auto;
  padding:10px 8px 24px;

  display:grid;
  place-items:center;

  /* the “board” */
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.14);
  border-radius:22px;
  box-shadow:0 10px 28px rgba(0,0,0,.20);

  /* positioning context */
  position:relative;

  /* responsive sizing */
  --sf-size: min(760px, 92vw);
  --sf-radius: calc(var(--sf-size) * 0.34);
  --sf-node: clamp(84px, 14vw, 128px);
  --sf-core: clamp(112px, 18vw, 160px);

  width:var(--sf-size);
  aspect-ratio: 1 / 1;

  /* tap safety */
  pointer-events:auto;
}

@media (max-width:520px){
  .crp-snowflake{
    --sf-radius: calc(var(--sf-size) * 0.36);
    --sf-node: clamp(78px, 19vw, 118px);
    --sf-core: clamp(108px, 22vw, 150px);
  }
}

/* Optional mesh lines (purely visual) */
.crp-snowflake::before{
  content:"";
  position:absolute;
  inset:10%;
  border-radius:999px;
  border:1px dashed rgba(255,255,255,.10);
  pointer-events:none;
}
.crp-snowflake::after{
  content:"";
  position:absolute;
  inset:22%;
  border-radius:999px;
  border:1px dashed rgba(255,255,255,.08);
  pointer-events:none;
}

/* Nucleus */
.crp-nucleus{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);

  width:var(--sf-core);
  height:var(--sf-core);
  border-radius:24px;

  border:1px solid rgba(255,255,255,.24);
  background:rgba(0,0,0,.20);
  color:inherit;

  display:grid;
  place-items:center;
  text-align:center;

  font-weight:950;
  letter-spacing:.45px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;

  box-shadow:0 12px 34px rgba(0,0,0,.28);

  z-index:3;
  pointer-events:auto !important;
}
.crp-nucleus:hover{ background:rgba(0,0,0,.26); border-color:rgba(255,255,255,.32); }
.crp-nucleus:active{ transform:translate(-50%,-50%) scale(.99); }
.crp-nucleus:focus{ outline:none; }
.crp-nucleus:focus-visible{ box-shadow:0 0 0 3px rgba(255,255,255,.18), 0 12px 34px rgba(0,0,0,.28); }

/* Axis nodes */
.crp-axis{
  position:absolute;
  left:50%;
  top:50%;
  width:var(--sf-node);
  height:var(--sf-node);
  border-radius:18px;

  border:1px solid rgba(255,255,255,.20);
  background:rgba(0,0,0,.18);
  color:inherit;

  display:grid;
  place-items:center;
  text-align:center;

  font-weight:900;
  letter-spacing:.25px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  transition:transform .08s ease, background .12s ease, border-color .12s ease;

  z-index:2;
  pointer-events:auto !important;
}
.crp-axis:hover{ background:rgba(0,0,0,.24); border-color:rgba(255,255,255,.30); }
.crp-axis:active{ transform:translate(-50%,-50%) translate(var(--dx), var(--dy)) scale(.99); }
.crp-axis:focus{ outline:none; }
.crp-axis:focus-visible{ box-shadow:0 0 0 3px rgba(255,255,255,.18); }

/* Position the 6 axes at 60° increments (hex symmetry)
   NOTE: We use CSS variables --dx/--dy for clean reuse in :active.
*/
.crp-axis[data-axis="rho"]{
  --dx: 0px;
  --dy: calc(var(--sf-radius) * -1);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}
.crp-axis[data-axis="tc"]{
  --dx: calc(var(--sf-radius) * 0.866);
  --dy: calc(var(--sf-radius) * -0.5);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}
.crp-axis[data-axis="delta"]{
  --dx: calc(var(--sf-radius) * 0.866);
  --dy: calc(var(--sf-radius) * 0.5);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}
.crp-axis[data-axis="hip"]{
  --dx: 0px;
  --dy: var(--sf-radius);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}
.crp-axis[data-axis="lambda"]{
  --dx: calc(var(--sf-radius) * -0.866);
  --dy: calc(var(--sf-radius) * 0.5);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}
.crp-axis[data-axis="cert"]{
  --dx: calc(var(--sf-radius) * -0.866);
  --dy: calc(var(--sf-radius) * -0.5);
  transform:translate(-50%,-50%) translate(var(--dx), var(--dy));
}

/* Small sublabel within nodes (optional) */
.crp-axis .crp-axis-kicker{
  font-size:12px;
  opacity:.78;
  font-weight:800;
  margin-top:2px;
}
.crp-axis .crp-axis-title{
  font-size:18px;
  font-weight:950;
  letter-spacing:.35px;
}

/* ============================================================
   MODAL OVERLAY (NO SCROLL-JUMP)
   ============================================================ */
.crp-modal{
  position:fixed;
  inset:0;
  z-index:9999;
  display:block;
  pointer-events:auto;
}
.crp-modal[hidden]{ display:none; }

.crp-modal-backdrop{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.55);
  backdrop-filter:blur(6px);
  pointer-events:auto;
}

.crp-modal-panel{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);

  width:min(760px, calc(100% - 28px));
  max-height:calc(100% - 28px);
  overflow:auto;

  border:1px solid rgba(255,255,255,.20);
  background:rgba(12,12,12,.92);
  color:inherit;
  border-radius:18px;
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  pointer-events:auto;
}

.crp-modal-header{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  padding:14px 14px 10px;
  border-bottom:1px solid rgba(255,255,255,.12);
}

.crp-modal-titlewrap{ min-width:0; }
.crp-modal-kicker{
  font-size:12px;
  opacity:.78;
  letter-spacing:.3px;
  margin:0 0 2px;
}
.crp-modal-title{
  margin:0;
  font-size:18px;
  font-weight:900;
  letter-spacing:.2px;
}

.crp-modal-close{
  border:1px solid rgba(255,255,255,.20);
  background:rgba(0,0,0,.22);
  color:inherit;
  border-radius:12px;
  width:40px;
  height:40px;
  display:grid;
  place-items:center;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  position:relative;
  z-index:2;
  pointer-events:auto !important;
}
.crp-modal-close:hover{ background:rgba(0,0,0,.30); border-color:rgba(255,255,255,.30); }
.crp-modal-close:focus{ outline:none; }
.crp-modal-close:focus-visible{ box-shadow:0 0 0 3px rgba(255,255,255,.18); }

.crp-modal-body{ padding:14px; }
.crp-modal-hint{ margin:0 0 10px; opacity:.85; }

.crp-modal-footer{
  padding:10px 14px 14px;
  border-top:1px solid rgba(255,255,255,.12);
  opacity:.9;
}

/* Fruits */
.crp-fruits{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:10px;
}
@media (max-width:520px){
  .crp-fruits{ grid-template-columns:1fr; }
}
.crp-fruit{
  width:100%;
  border:1px solid rgba(255,255,255,.20);
  background:rgba(0,0,0,.18);
  color:inherit;
  border-radius:12px;
  padding:12px 10px;
  font-weight:900;
  text-align:center;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  transition:transform .08s ease, background .12s ease, border-color .12s ease;

  position:relative;
  z-index:2;
  pointer-events:auto !important;
}
.crp-fruit:hover{ background:rgba(0,0,0,.24); border-color:rgba(255,255,255,.30); }
.crp-fruit:active{ transform:scale(.99); }
.crp-fruit:focus{ outline:none; }
.crp-fruit:focus-visible{ box-shadow:0 0 0 3px rgba(255,255,255,.18); }

/* Resolution */
.crp-resolution-paragraph{ margin:0 0 10px; line-height:1.45; }
.crp-resolution-bullets{ margin:0 0 12px 18px; padding:0; }
.crp-resolution-implication{
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.16);
  border-radius:14px;
  padding:12px;
  margin:0 0 14px;
}
.crp-resolution-implication-label{
  font-size:12px;
  font-weight:900;
  letter-spacing:.35px;
  opacity:.85;
  margin:0 0 6px;
}
.crp-resolution-implication-text{ margin:0; line-height:1.45; }
