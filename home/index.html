<!-- TNT FILE: /door/index.html -->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Door · Geodiametrics</title>

<link rel="stylesheet" href="/assets/ui.css?v=9005"/>
<link rel="stylesheet" href="/assets/branch.css?v=9005"/>
<script defer src="/assets/instrument.js?v=9005"></script>
</head>

<body>
<div class="page">
  <div class="wrap">

    <div class="hero" style="text-align:center;">
      <h1>DOOR</h1>
      <p style="margin-top:12px;">Choose your route.</p>

      <div class="pills" style="justify-content:center; margin-top:12px;">
        <span class="pill">LANG: <span id="langLabel">EN</span></span>
        <span class="pill">DEPTH: <span id="depthLabel">EXPLORE</span></span>
      </div>

      <div class="pills" style="justify-content:center; margin-top:12px;">
        <button class="pill btn" id="setEN">EN</button>
        <button class="pill btn" id="setZH">中文</button>
        <a class="pill btn" href="/">BACK</a>
      </div>
    </div>

    <div class="stage" style="margin-top:18px;">
      <div class="platform">

        <a class="diamond top gold" id="goExplore" href="/home/?depth=explore">
          <span><b>Explore</b><small>Surface</small></span>
        </a>

        <a class="diamond right" id="goLearn" href="/home/?depth=learn">
          <span><b>Learn</b><small>Deep</small></span>
        </a>

        <a class="diamond bottom" id="goHome" href="/home/">
          <span><b>Home</b><small>Enter hub</small></span>
        </a>

        <a class="diamond left" id="goLinks" href="/links/">
          <span><b>Links</b><small>Identity</small></span>
        </a>

      </div>
    </div>

    <div class="ink">GEODIAMETRICS</div>
    <div class="footer">CANONICAL · STABLE · © GEODIAMETRICS</div>
  </div>
</div>

<script>
(() => {
  const get = (k) => { try { return localStorage.getItem(k); } catch(e){ return null; } };
  const set = (k,v) => { try { localStorage.setItem(k, v); } catch(e){} };

  const qs = new URLSearchParams(location.search || "");
  const normalizeLang = (v) => (String(v||"").toLowerCase().startsWith("zh") ? "zh" : "en");
  const normalizeDepth = (v) => (String(v||"").toLowerCase() === "learn" ? "learn" : "explore");

  const lang = normalizeLang(qs.get("lang") || get("gd_lang") || "en");
  const depth = normalizeDepth(qs.get("depth") || get("gd_depth") || "explore");

  set("gd_lang", lang);
  set("gd_depth", depth);

  const stamp = (url) => {
    const u = new URL(url, location.origin);
    u.searchParams.set("lang", lang);
    return u.pathname + "?" + u.searchParams.toString();
  };

  function render(){
    document.getElementById("langLabel").textContent = (lang === "zh" ? "中文" : "EN");
    document.getElementById("depthLabel").textContent = depth.toUpperCase();

    document.getElementById("setEN").classList.toggle("active", lang === "en");
    document.getElementById("setZH").classList.toggle("active", lang === "zh");

    document.getElementById("goExplore").href = stamp("/home/?depth=explore");
    document.getElementById("goLearn").href = stamp("/home/?depth=learn");
    document.getElementById("goHome").href = stamp("/home/?depth="+depth);
    document.getElementById("goLinks").href = stamp("/links/");
  }

  document.getElementById("setEN").addEventListener("click", ()=>{ set("gd_lang","en"); location.href="/door/?lang=en&depth="+depth; });
  document.getElementById("setZH").addEventListener("click", ()=>{ set("gd_lang","zh"); location.href="/door/?lang=zh&depth="+depth; });

  render();
})();
</script>
</body>
</html>
