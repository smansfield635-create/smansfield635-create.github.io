<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Explore ¬∑ Diamond 2</title>

  <link rel="stylesheet" href="/assets/ui.css?v=EXPLORE_D2_3"/>
  <link rel="stylesheet" href="/assets/branch.css?v=EXPLORE_D2_3"/>
  <script defer src="/assets/instrument.js?v=EXPLORE_D2_3"></script>

  <style>
    .d2-wrap{max-width:980px;margin:0 auto; padding-bottom:140px;} /* space for fixed dock */
    .d2-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-top:12px}
    @media (max-width:820px){ .d2-grid{grid-template-columns:1fr;} }
    .d2-tile{min-height:104px;display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 16px}
    .d2-left{display:flex;flex-direction:column;gap:4px;text-align:left}
    .d2-code{font-weight:950;letter-spacing:.3px}
    .d2-desc{opacity:.82;line-height:1.25}
    .d2-tags{opacity:.70;font-size:12px;letter-spacing:.15px}
    .d2-go{opacity:.85;font-weight:900}
    .d2-mini{opacity:.72;font-size:12px;line-height:1.35;text-align:center;margin-top:10px}

    /* FIXED bottom compass dock (no overlap) */
    .dock{
      position:fixed;
      left:0;
      right:0;
      bottom: max(10px, env(safe-area-inset-bottom));
      display:flex;
      justify-content:center;
      z-index:50;
      pointer-events:none; /* only the dock itself is clickable */
    }
    .dock-card{
      pointer-events:auto;
      width:min(760px, 92vw);
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.22);
      box-shadow:0 16px 50px rgba(0,0,0,.45);
      padding:10px 12px;
      display:flex;
      justify-content:center;
      backdrop-filter: blur(8px);
    }

    .mini-compass{
      position:relative;
      width:min(360px, 78vw);
      height:84px;
      display:block;
    }

    .mini-node{
      position:absolute;
      width:54px;
      height:54px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.16);
      display:grid;
      place-items:center;
      text-decoration:none;
      color:#fff;
      font-weight:900;
      letter-spacing:.2px;
      -webkit-tap-highlight-color:transparent;
    }
    .mini-node:hover{ background:rgba(0,0,0,.24); border-color:rgba(255,255,255,.28); }

    /* Center (DIAMOND core) */
    .mini-core{
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width:62px;
      height:62px;
      border-radius:18px;
      background:linear-gradient(135deg, rgba(255,210,120,.20), rgba(255,150,60,.08));
      border-color:rgba(255,210,120,.32);
    }

    /* satellites */
    .mini-a{ left:0; top:50%; transform:translateY(-50%); }            /* ABOUT */
    .mini-l{ left:20%; top:5px; }                                      /* LINKS */
    .mini-w{ right:20%; top:5px; }                                     /* LAWS */
    .mini-g{ right:0; top:50%; transform:translateY(-50%); }           /* GAUGES */
    .mini-s{ left:50%; bottom:0; transform:translateX(-50%); }         /* START */

    .mini-ico{ font-size:13px; opacity:.92; }
  </style>
</head>

<body>
<main class="crp-shell">

  <header class="crp-header" style="text-align:center">
    <div class="crp-mark" data-i18n="global.brand">GEODIAMETRICS</div>
    <h1 class="crp-title" style="margin-bottom:6px">EXPLORE</h1>
    <p class="crp-subtitle" style="margin-bottom:8px">Diamond 2 ¬∑ Surface Map</p>

    <!-- Top lenses only (operational overlay) -->
    <div class="crp-topbar" style="margin:0 auto 8px;max-width:980px">
      <div class="crp-topbar-left" style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center;width:100%">
        <div class="crp-lens" role="group" aria-label="Style lens">
          <button class="crp-chip" type="button" data-style="formal">FORMAL</button>
          <button class="crp-chip" type="button" data-style="informal">INFORMAL</button>
        </div>
        <div class="crp-lens" role="group" aria-label="Time lens">
          <button class="crp-chip" type="button" data-time="origin">ORIGIN</button>
          <button class="crp-chip" type="button" data-time="now">NOW</button>
          <button class="crp-chip" type="button" data-time="trajectory">TRAJECTORY</button>
        </div>
      </div>
    </div>

    <p class="d2-mini">
      Explore is the transition diamond. It routes into the core/spine while preserving lenses.
    </p>
  </header>

  <section class="d2-wrap">
    <div class="d2-grid" aria-label="Diamond 2 quadrants">

      <!-- NW (definition) -->
      <a id="q-nw" class="crp-btn d2-tile" href="/home/" role="button">
        <div class="d2-left">
          <div class="d2-code">‚≠ê NW ¬∑ NORTHWEST</div>
          <div class="d2-desc"><b>Definition ¬∑ Language ¬∑ Structure</b></div>
          <div class="d2-tags">SSG ¬∑ Grammar ¬∑ DOT.GRID ¬∑ Acronyms</div>
        </div>
        <div class="d2-go">‚ñ∂</div>
      </a>

      <!-- NE (go deep) -->
      <a id="q-ne" class="crp-btn d2-tile" href="/home/" role="button">
        <div class="d2-left">
          <div class="d2-code">‚òÄÔ∏è NE ¬∑ NORTHEAST</div>
          <div class="d2-desc"><b>Execution ¬∑ Surfaces ¬∑ Examples</b></div>
          <div class="d2-tags">Products ¬∑ Demos ¬∑ Workflows</div>
        </div>
        <div class="d2-go">‚ñ∂</div>
      </a>

      <!-- SW (go deep) -->
      <a id="q-sw" class="crp-btn d2-tile" href="/home/" role="button">
        <div class="d2-left">
          <div class="d2-code">üî• SW ¬∑ SOUTHWEST</div>
          <div class="d2-desc"><b>Measurement ¬∑ Diagnostics ¬∑ Rules</b></div>
          <div class="d2-tags">UCI ¬∑ HIP Gates ¬∑ Alerts ¬∑ Reports</div>
        </div>
        <div class="d2-go">‚ñ∂</div>
      </a>

      <!-- SE (governance) -->
      <a id="q-se" class="crp-btn d2-tile" href="/home/" role="button">
        <div class="d2-left">
          <div class="d2-code">üåô SE ¬∑ SOUTHEAST</div>
          <div class="d2-desc"><b>Governance ¬∑ Capital ¬∑ Certification</b></div>
          <div class="d2-tags">CARES ¬∑ Charter ¬∑ Registry ¬∑ Audit</div>
        </div>
        <div class="d2-go">‚ñ∂</div>
      </a>

    </div>

    <footer class="crp-footer" style="text-align:center">
      <small class="crp-footnote">BUILD: <strong>EXPLORE_D2_3</strong></small>
    </footer>
  </section>

  <!-- Fixed bottom compass dock -->
  <div class="dock" aria-label="Compass dock">
    <div class="dock-card">
      <div class="mini-compass" aria-label="Mini compass navigation">
        <a id="dock-about" class="mini-node mini-a" href="/about/" title="About"><span class="mini-ico">ABOUT</span></a>
        <a id="dock-links" class="mini-node mini-l" href="/links/" title="Links"><span class="mini-ico">LINKS</span></a>
        <a id="dock-core"  class="mini-node mini-core" href="/home/" title="Core"><span class="mini-ico">‚óÜ</span></a>
        <a id="dock-laws"  class="mini-node mini-w" href="/laws/" title="Laws"><span class="mini-ico">LAWS</span></a>
        <a id="dock-gauges"class="mini-node mini-g" href="/gauges/" title="Gauges"><span class="mini-ico">GAUGES</span></a>
        <a id="dock-start" class="mini-node mini-s" href="/" title="Start"><span class="mini-ico">START</span></a>
      </div>
    </div>
  </div>

</main>

<script>
(function(){
  "use strict";

  var K_LANG="gd_lang", K_DEPTH="gd_depth", K_STYLE="gd_style", K_TIME="gd_time";
  var allowLang={en:1,zh:1};
  var allowDepth={explore:1,learn:1};
  var allowStyle={formal:1,informal:1};
  var allowTime={origin:1,now:1,trajectory:1};

  function qp(n){ try{return new URLSearchParams(location.search).get(n);}catch(e){return null;} }
  function lsGet(k){ try{return localStorage.getItem(k);}catch(e){return null;} }
  function lsSet(k,v){ try{localStorage.setItem(k,v);}catch(e){} }

  var state={
    lang:  qp("lang")  || lsGet(K_LANG)  || "en",
    depth: qp("depth") || lsGet(K_DEPTH) || "explore",
    style: qp("style") || lsGet(K_STYLE) || "formal",
    time:  qp("time")  || lsGet(K_TIME)  || "origin"
  };

  if(!allowLang[state.lang]) state.lang="en";
  if(!allowDepth[state.depth]) state.depth="explore";
  if(!allowStyle[state.style]) state.style="formal";
  if(!allowTime[state.time]) state.time="origin";

  lsSet(K_LANG,state.lang); lsSet(K_DEPTH,state.depth); lsSet(K_STYLE,state.style); lsSet(K_TIME,state.time);

  function setPressed(group, attr, value){
    var nodes=document.querySelectorAll(group+" .crp-chip["+attr+"]");
    for(var i=0;i<nodes.length;i++){
      var v=nodes[i].getAttribute(attr);
      nodes[i].setAttribute("aria-pressed", v===value ? "true":"false");
    }
  }
  setPressed("[aria-label='Style lens']","data-style",state.style);
  setPressed("[aria-label='Time lens']","data-time",state.time);

  // lens handlers
  var styleChips=document.querySelectorAll(".crp-chip[data-style]");
  for(var s=0;s<styleChips.length;s++){
    styleChips[s].addEventListener("click", function(e){
      var v=e.currentTarget.getAttribute("data-style");
      if(!allowStyle[v]) return;
      state.style=v; lsSet(K_STYLE,v);
      setPressed("[aria-label='Style lens']","data-style",v);
      rewrite();
    });
  }
  var timeChips=document.querySelectorAll(".crp-chip[data-time]");
  for(var t=0;t<timeChips.length;t++){
    timeChips[t].addEventListener("click", function(e){
      var v=e.currentTarget.getAttribute("data-time");
      if(!allowTime[v]) return;
      state.time=v; lsSet(K_TIME,v);
      setPressed("[aria-label='Time lens']","data-time",v);
      rewrite();
    });
  }

  function rewrite(){
    var q="lang="+encodeURIComponent(state.lang)+
          "&depth="+encodeURIComponent(state.depth)+
          "&style="+encodeURIComponent(state.style)+
          "&time="+encodeURIComponent(state.time);

    function set(id, href){
      var a=document.getElementById(id);
      if(a) a.setAttribute("href", href);
    }

    // Deep routing into Home with quadrant hint
    set("q-nw","/home/?"+q+"&axis=nw");
    set("q-ne","/home/?"+q+"&axis=ne");
    set("q-sw","/home/?"+q+"&axis=sw");
    set("q-se","/home/?"+q+"&axis=se");

    // Dock
    set("dock-core","/home/?"+q);
    set("dock-about","/about/?"+q);
    set("dock-links","/links/?"+q);
    set("dock-laws","/laws/?"+q);
    set("dock-gauges","/gauges/?"+q);
    set("dock-start","/?"+q);
  }

  rewrite();
})();
</script>

</body>
</html>
