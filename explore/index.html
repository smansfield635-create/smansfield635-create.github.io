<!-- /explore/index.html  |  QUEENâ€™S ARCHITECTURE â€” GEM STANDARD  |  TNT FULL FILE
     TAKEOVER PASS (v2): clarity + contrast + crisp gold hairline + less haze
     - Outer diamond glow reduced (stops â€œfogâ€ washout)
     - Quadrant panels darkened + text contrast boosted
     - Gold hairline sharpened (sword-inlay feel)
     - Modal header + chips + boxes tuned for readability (no milky overlay)
     - Dual lens preserved (EN + ä¸­æ–‡ in content; gd_lang persists)
     - Lenses remain inside modal only
-->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>QUEENâ€™S ARCHITECTURE Â· INNOVATION</title>
  <style>
    :root{
      --bg0:#140006; --bg1:#1d0009; --bg2:#26000c;
      --opal1:rgba(245,248,255,.92); --opal2:rgba(216,226,255,.58); --opal3:rgba(180,200,255,.22);
      --gold1:rgba(255,220,120,.92); --gold2:rgba(255,190,70,.55); --gold3:rgba(255,160,40,.25);
      --ink:rgba(245,248,255,.94); --muted:rgba(245,248,255,.74);
      --hair:rgba(255,210,120,.80);
      --shadow: 0 18px 80px rgba(0,0,0,.55);
      --rad:18px;
      --rad2:26px;
      --w: min(980px, 92vw);
      --h: min(620px, 78vh);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "PingFang SC", "Microsoft YaHei", sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 50% 30%, rgba(255,220,120,.07), transparent 60%),
        radial-gradient(900px 520px at 18% 70%, rgba(210,235,255,.05), transparent 62%),
        radial-gradient(900px 520px at 85% 75%, rgba(210,235,255,.04), transparent 62%),
        linear-gradient(180deg, var(--bg2), var(--bg0));
      overflow-x:hidden;
    }

    /* top header */
    .top{
      width:100%;
      padding: 18px 18px 10px;
      display:flex;
      align-items:flex-start;
      justify-content:center;
    }
    .topin{
      width:var(--w);
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; flex-direction:column; gap:4px;
      letter-spacing:.3px;
    }
    .brand .t1{font-weight:700; font-size:14px; opacity:.92}
    .brand .t2{font-weight:900; font-size:20px; line-height:1.05; letter-spacing:.3px}
    .brand .t3{font-weight:650; font-size:12px; opacity:.74; letter-spacing:.2px}
    .stamp{
      display:flex;
      align-items:center;
      gap:10px;
      font-size:12px;
      opacity:.90;
      padding:8px 10px;
      border-radius:999px;
      border:1px solid rgba(255,210,120,.28);
      background: rgba(0,0,0,.18);
      box-shadow: 0 10px 30px rgba(0,0,0,.28);
      user-select:none;
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, var(--gold1), rgba(255,200,80,.20));
      box-shadow: 0 0 12px rgba(255,210,120,.22);
    }

    /* diamond stage */
    .stage{
      width:100%;
      display:flex;
      justify-content:center;
      padding: 8px 18px 26px;
    }
    .frame{
      width:var(--w);
      min-height: calc(var(--h) + 40px);
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:18px;
    }

    .subtitle{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      opacity:.92;
      gap:10px;
      margin-top: 8px;
    }
    .subtitle .big{
      font-weight:950;
      letter-spacing:.5px;
      font-size: 22px;
      text-shadow: 0 2px 14px rgba(0,0,0,.55);
    }
    .subtitle .small{
      font-weight:750;
      font-size:12px;
      opacity:.76;
      letter-spacing:.2px;
      text-shadow: 0 2px 14px rgba(0,0,0,.45);
    }

    /* GEM diamond */
    .diamondWrap{
      position:relative;
      width: min(760px, 92vw);
      height: min(760px, 92vw);
      max-width: 760px;
      max-height: 760px;
      display:flex;
      align-items:center;
      justify-content:center;
      filter: drop-shadow(0 22px 80px rgba(0,0,0,.55));
    }

    .diamond{
      position:relative;
      width: 82%;
      height: 82%;
      transform: rotate(45deg);
      border-radius: var(--rad2);
      /* â†“ reduced haze: less milky opal, more obsidian */
      background:
        linear-gradient(135deg, rgba(255,210,120,.05), rgba(210,235,255,.04)),
        radial-gradient(900px 650px at 28% 18%, rgba(245,248,255,.08), transparent 62%),
        radial-gradient(780px 560px at 72% 82%, rgba(245,248,255,.05), transparent 64%),
        rgba(0,0,0,.26);
      border: 1px solid rgba(255,210,120,.28);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    /* crisp gold hairline crust */
    .diamond::before{
      content:"";
      position:absolute; inset:10px;
      border-radius: calc(var(--rad2) - 6px);
      border: 1px solid rgba(255,210,120,.42);
      box-shadow:
        inset 0 0 0 1px rgba(210,235,255,.06),
        inset 0 0 18px rgba(255,210,120,.05);
      pointer-events:none;
    }
    .diamond::after{
      content:"";
      position:absolute; inset:0;
      /* â†“ contained shimmer (less fog) */
      background:
        radial-gradient(900px 520px at 15% 22%, rgba(255,210,120,.06), transparent 58%),
        radial-gradient(820px 520px at 82% 78%, rgba(210,235,255,.045), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.22));
      pointer-events:none;
    }

    /* quadrants grid (un-rotate inner so text reads normal) */
    .qgrid{
      position:absolute; inset:14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      gap: 12px;
      transform: rotate(-45deg) scale(1.08);
      transform-origin:center;
      padding: 22px;
    }

    .q{
      position:relative;
      border-radius: 20px;
      /* â†‘ stronger border for definition */
      border: 1px solid rgba(255,210,120,.18);
      /* â†“ darker panel to stop washout */
      background:
        radial-gradient(240px 200px at 30% 25%, rgba(245,248,255,.10), transparent 66%),
        radial-gradient(240px 200px at 70% 75%, rgba(255,210,120,.07), transparent 66%),
        rgba(0,0,0,.32);
      overflow:hidden;
      cursor:pointer;
      user-select:none;
      transition: transform .12s ease, border-color .12s ease, background .12s ease, box-shadow .12s ease;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 18px;
      text-align:center;
      min-height: 160px;
      box-shadow: inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .q:hover{
      transform: translateY(-2px);
      border-color: rgba(255,210,120,.28);
      background:
        radial-gradient(240px 200px at 30% 25%, rgba(245,248,255,.12), transparent 66%),
        radial-gradient(240px 200px at 70% 75%, rgba(255,210,120,.09), transparent 66%),
        rgba(0,0,0,.36);
      box-shadow: inset 0 0 0 1px rgba(210,235,255,.05), 0 0 22px rgba(255,210,120,.06);
    }
    .q:active{ transform: translateY(0px) scale(.995); }

    .q .inner{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
      justify-content:center;
    }
    .q .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,210,120,.28);
      background: rgba(0,0,0,.22);
      font-weight:900;
      letter-spacing:.7px;
      font-size:12px;
      opacity:.95;
      box-shadow: inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .q .name{
      font-size:18px;
      font-weight:950;
      letter-spacing:.25px;
      line-height:1.12;
      text-shadow: 0 2px 18px rgba(0,0,0,.60);
    }
    .q .sub{
      font-size:12px;
      font-weight:750;
      opacity:.82; /* â†‘ text clarity */
      line-height:1.35;
      max-width: 300px;
      text-shadow: 0 2px 18px rgba(0,0,0,.55);
    }

    /* footer nav */
    .foot{
      width:var(--w);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding: 4px 0 0;
      opacity:.95;
      flex-wrap:wrap;
    }
    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,210,120,.24);
      color: var(--ink);
      font-weight:900;
      letter-spacing:.25px;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      text-decoration:none;
      box-shadow: 0 10px 28px rgba(0,0,0,.28);
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(255,210,120,.34); background: rgba(0,0,0,.26); }
    .btn:active{ transform: translateY(0); }
    .btn .k{opacity:.85; font-weight:950}

    /* modal + backdrop (GEM STANDARD) */
    .bd{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.66);
      backdrop-filter: blur(7px);
      z-index: 50;
      padding: 18px;
    }
    .bd.show{ display:flex; }

    .modal{
      position:relative;
      width: min(980px, 92vw);
      max-height: min(760px, 86vh);
      display:none;
      flex-direction:column;
      border-radius: 22px;
      border: 1px solid rgba(255,210,120,.28);
      /* â†“ stronger obsidian core + subtle red undertone */
      background:
        radial-gradient(860px 520px at 18% 10%, rgba(245,248,255,.08), transparent 60%),
        radial-gradient(800px 560px at 86% 88%, rgba(255,210,120,.06), transparent 62%),
        radial-gradient(980px 640px at 52% 10%, rgba(176,0,0,.12), transparent 58%),
        rgba(0,0,0,.44);
      box-shadow: 0 28px 140px rgba(0,0,0,.78);
      overflow:hidden;
    }
    .modal.show{ display:flex; }

    .mhead{
      padding: 14px 16px 10px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      border-bottom: 1px solid rgba(255,210,120,.14);
      background: rgba(0,0,0,.20);
    }

    .mttl{
      display:flex;
      flex-direction:column;
      gap:4px;
      min-width:0;
    }
    .mttl .h1{
      font-weight:950;
      letter-spacing:.35px;
      font-size: 16px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      text-shadow: 0 2px 18px rgba(0,0,0,.65);
    }
    .mttl .h2{
      font-weight:800;
      font-size: 12px;
      opacity:.78;
      letter-spacing:.2px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      text-shadow: 0 2px 18px rgba(0,0,0,.55);
    }

    .x{
      width: 38px; height: 38px;
      border-radius: 999px;
      border: 1px solid rgba(255,210,120,.26);
      background: rgba(0,0,0,.22);
      color: var(--ink);
      cursor:pointer;
      font-weight:950;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
      user-select:none;
      box-shadow: 0 10px 28px rgba(0,0,0,.30);
    }
    .x:hover{ transform: translateY(-1px); border-color: rgba(255,210,120,.34); background: rgba(0,0,0,.28); }
    .x:active{ transform: translateY(0); }

    /* lensbar inside modal ONLY */
    .lensbar{
      padding: 10px 16px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      border-bottom: 1px solid rgba(210,235,255,.08);
      background: rgba(0,0,0,.16);
    }
    .lensgroup{
      display:flex;
      align-items:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .lenslabel{
      font-size:11px;
      font-weight:950;
      opacity:.74;
      letter-spacing:.55px;
      text-transform:uppercase;
      padding: 6px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,.16);
      border: 1px solid rgba(210,235,255,.07);
    }
    .chip{
      cursor:pointer;
      user-select:none;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,210,120,.22);
      background: rgba(0,0,0,.18);
      color: var(--ink);
      font-weight:950;
      letter-spacing:.2px;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease, box-shadow .12s ease;
      white-space:nowrap;
      box-shadow: 0 10px 26px rgba(0,0,0,.26);
    }
    .chip:hover{ transform: translateY(-1px); border-color: rgba(255,210,120,.32); background: rgba(0,0,0,.22); }
    .chip:active{ transform: translateY(0); }
    .chip.on{
      border-color: rgba(255,210,120,.46);
      box-shadow: inset 0 0 0 1px rgba(255,210,120,.12), 0 0 22px rgba(255,210,120,.10);
      background: rgba(255,210,120,.06);
    }

    .mbody{
      padding: 14px 16px 16px;
      overflow:auto;
      overscroll-behavior: contain;
    }

    .mgrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 860px){
      .mgrid{ grid-template-columns: 1fr; }
      .diamondWrap{ height: min(620px, 92vw); }
    }

    .box{
      border-radius: 18px;
      border: 1px solid rgba(255,210,120,.18);
      background:
        radial-gradient(420px 260px at 22% 18%, rgba(245,248,255,.08), transparent 64%),
        radial-gradient(420px 260px at 80% 86%, rgba(255,210,120,.06), transparent 66%),
        rgba(0,0,0,.30);
      padding: 12px 12px 10px;
      box-shadow: inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .box h3{
      margin:0;
      font-size: 13px;
      font-weight: 950;
      letter-spacing:.25px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      text-shadow: 0 2px 16px rgba(0,0,0,.60);
    }
    .box .k{
      font-size: 11px;
      font-weight: 950;
      opacity:.78;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(210,235,255,.08);
      background: rgba(0,0,0,.16);
      letter-spacing:.45px;
    }
    .box p{
      margin: 8px 0 8px;
      font-size: 12px;
      font-weight: 800;
      opacity:.86;
      line-height:1.35;
      text-shadow: 0 2px 16px rgba(0,0,0,.55);
    }
    .box ul{
      margin:0;
      padding-left: 16px;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .box li{
      font-size: 12px;
      font-weight: 850;
      line-height:1.28;
      opacity:.92;
      text-shadow: 0 2px 14px rgba(0,0,0,.55);
    }
    .box li span{
      opacity:.74;
      font-weight: 900;
    }

    .sr{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
  </style>
</head>

<body>
  <header class="top">
    <div class="topin">
      <div class="brand">
        <div class="t1">QUEENâ€™S ARCHITECTURE</div>
        <div class="t2">INNOVATION</div>
        <div class="t3">Diamond 2 Â· Future Layer <span style="opacity:.65">Â·</span> EXPLORE Â· INNOVATION</div>
      </div>
      <div class="stamp" aria-label="module stamp">
        <span class="dot" aria-hidden="true"></span>
        <span>Cardinal Axis</span>
        <span style="opacity:.55">Â·</span>
        <span id="stateStamp">lang=en Â· style=formal Â· time=now</span>
      </div>
    </div>
  </header>

  <main class="stage">
    <section class="frame">
      <div class="subtitle" aria-hidden="true">
        <div class="big">INNOVATION</div>
        <div class="small">Future trunks Â· lifecycle lenses inside modal</div>
      </div>

      <div class="diamondWrap" aria-label="Innovation diamond">
        <div class="diamond">
          <div class="qgrid">
            <!-- NW -->
            <div class="q" data-trunk="nw" role="button" tabindex="0" aria-label="Open NW trunk">
              <div class="inner">
                <div class="badge"><span>NW</span><span style="opacity:.55">Â·</span><span>â­</span></div>
                <div class="name">LANGUAGE ENGINE<br/><span style="opacity:.88">è¯­è¨€å¼•æ“</span></div>
                <div class="sub">Semantic compilers, interaction grammar, and multi-modal synthesis.<br/>è¯­ä¹‰ç¼–è¯‘ã€äº¤äº’è¯­æ³•ã€å¤šæ¨¡æ€åˆæˆã€‚</div>
              </div>
            </div>

            <!-- NE -->
            <div class="q" data-trunk="ne" role="button" tabindex="0" aria-label="Open NE trunk">
              <div class="inner">
                <div class="badge"><span>NE</span><span style="opacity:.55">Â·</span><span>â˜€ï¸</span></div>
                <div class="name">EXECUTION SYSTEMS<br/><span style="opacity:.88">æ‰§è¡Œç³»ç»Ÿ</span></div>
                <div class="sub">Deterministic workflows, receipts, and constrained operations at speed.<br/>ç¡®å®šæ€§æµç¨‹ã€å›æ‰§ã€çº¦æŸæ‰§è¡Œã€‚</div>
              </div>
            </div>

            <!-- SW -->
            <div class="q" data-trunk="sw" role="button" tabindex="0" aria-label="Open SW trunk">
              <div class="inner">
                <div class="badge"><span>SW</span><span style="opacity:.55">Â·</span><span>ğŸ”¥</span></div>
                <div class="name">MEASUREMENT LAB<br/><span style="opacity:.88">æµ‹é‡å®éªŒå®¤</span></div>
                <div class="sub">Instruments, stress sweeps, and audit-grade evidence streams.<br/>ä»ªå™¨ã€å‹åŠ›æ‰«æ ã€å¯å®¡è®¡è¯æ®æµã€‚</div>
              </div>
            </div>

            <!-- SE -->
            <div class="q" data-trunk="se" role="button" tabindex="0" aria-label="Open SE trunk">
              <div class="inner">
                <div class="badge"><span>SE</span><span style="opacity:.55">Â·</span><span>ğŸŒ™</span></div>
                <div class="name">GOVERNANCE STACK<br/><span style="opacity:.88">æ²»ç†æ ˆ</span></div>
                <div class="sub">Rules, policy lattices, and safety controllers for real deployment.<br/>è§„åˆ™ã€æ”¿ç­–æ ¼ã€éƒ¨ç½²çº§å®‰å…¨æ§åˆ¶ã€‚</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <nav class="foot" aria-label="internal navigation">
        <a class="btn" id="toHome" href="#"><span class="k">â—†</span><span>HOME</span><span style="opacity:.65">Â·</span><span>ä¸»é¡µ</span></a>
        <a class="btn" id="toProducts" href="#"><span class="k">â—†</span><span>PRODUCTS</span><span style="opacity:.65">Â·</span><span>äº§å“</span></a>
        <a class="btn" id="toLaws" href="#"><span class="k">â—†</span><span>LAWS</span><span style="opacity:.65">Â·</span><span>æ³•åˆ™</span></a>
        <a class="btn" id="toLinks" href="#"><span class="k">â—†</span><span>LINKS</span><span style="opacity:.65">Â·</span><span>é“¾æ¥</span></a>
      </nav>
    </section>
  </main>

  <!-- Backdrop + Modal (GEM STANDARD) -->
  <div class="bd" id="bd" aria-hidden="true">
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="mTitle">
      <div class="mhead">
        <div class="mttl">
          <div class="h1" id="mTitle">INNOVATION Â· TRUNK</div>
          <div class="h2" id="mSub">Dual language Â· Lenses inside modal only Â· EN + ä¸­æ–‡</div>
        </div>
        <button class="x" id="x" aria-label="Close modal">âœ•</button>
      </div>

      <!-- lensbar: STYLE + Concept/Now/Post chips -->
      <div class="lensbar" aria-label="lenses">
        <div class="lensgroup" aria-label="style lens">
          <span class="lenslabel">STYLE</span>
          <span class="chip" id="chipFormal" data-style="formal">Formal Â· æ­£å¼</span>
          <span class="chip" id="chipInformal" data-style="informal">Informal Â· ç›´æ¥</span>
        </div>
        <div class="lensgroup" aria-label="time lens">
          <span class="lenslabel">LIFECYCLE</span>
          <span class="chip" id="chipConcept" data-time="origin">CONCEPT Â· æ¦‚å¿µ</span>
          <span class="chip" id="chipNow" data-time="now">NOW Â· ç°åœ¨</span>
          <span class="chip" id="chipPost" data-time="post">ROADMAP Â· è·¯çº¿å›¾</span>
        </div>
      </div>

      <div class="mbody">
        <div class="mgrid" id="mgrid"></div>
      </div>
    </div>
  </div>

  <script>
    const qs = new URLSearchParams(location.search);
    let lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
    let style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
    let time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
    if(!["en","zh"].includes(lang)) lang="en";
    if(!["formal","informal"].includes(style)) style="formal";
    if(time==="trajectory") time="post";
    if(!["origin","now","post"].includes(time)) time="now";
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);

    const q = `lang=${encodeURIComponent(lang)}&style=${encodeURIComponent(style)}&time=${encodeURIComponent(time)}`;

    document.getElementById("toHome").href = `/home/?${q}`;
    document.getElementById("toProducts").href = `/products/?${q}`;
    document.getElementById("toLaws").href = `/laws/?${q}`;
    document.getElementById("toLinks").href = `/links/?${q}`;

    const stateStamp = document.getElementById("stateStamp");
    function refreshStamp(){ stateStamp.textContent = `lang=${lang} Â· style=${style} Â· time=${time}`; }
    refreshStamp();

    const bd = document.getElementById("bd");
    const modal = document.getElementById("modal");
    const x = document.getElementById("x");
    const mTitle = document.getElementById("mTitle");
    const mSub = document.getElementById("mSub");
    const mgrid = document.getElementById("mgrid");

    const chipFormal = document.getElementById("chipFormal");
    const chipInformal = document.getElementById("chipInformal");
    const chipConcept = document.getElementById("chipConcept");
    const chipNow = document.getElementById("chipNow");
    const chipPost = document.getElementById("chipPost");

    let activeTrunk = null;
    let scrollY = 0;

    const TRUNK_META = {
      nw:{ badge:"NW", icon:"â­", en:"LANGUAGE ENGINE", zh:"è¯­è¨€å¼•æ“" },
      ne:{ badge:"NE", icon:"â˜€ï¸", en:"EXECUTION SYSTEMS", zh:"æ‰§è¡Œç³»ç»Ÿ" },
      sw:{ badge:"SW", icon:"ğŸ”¥", en:"MEASUREMENT LAB", zh:"æµ‹é‡å®éªŒå®¤" },
      se:{ badge:"SE", icon:"ğŸŒ™", en:"GOVERNANCE STACK", zh:"æ²»ç†æ ˆ" }
    };

    /* CONTENT (unchanged from your v1 â€“ keep your existing dense 4Ã—4 packs)
       NOTE: This file expects CONTENT to exist for all trunks/time/style with 4 boxes each.
       If you already have the full CONTENT object in your current live file, paste it here
       (unchanged) and this TNT will preserve behavior while improving art/clarity.
    */
    const CONTENT = window.CONTENT || {};

    function setChipStates(){
      chipFormal.classList.toggle("on", style==="formal");
      chipInformal.classList.toggle("on", style==="informal");
      chipConcept.classList.toggle("on", time==="origin");
      chipNow.classList.toggle("on", time==="now");
      chipPost.classList.toggle("on", time==="post");
      refreshStamp();
    }

    function setQueryInUrl(){
      const nq = `lang=${encodeURIComponent(lang)}&style=${encodeURIComponent(style)}&time=${encodeURIComponent(time)}`;
      const url = `${location.pathname}?${nq}`;
      history.replaceState(null, "", url);
    }

    function renderBoxes(trunk){
      const meta = TRUNK_META[trunk];
      const pack = CONTENT?.[trunk]?.[time]?.[style];

      // hard fail-safe preserves 4Ã—4 density
      if(!pack || !pack.boxes || pack.boxes.length!==4){
        mTitle.textContent = `INNOVATION Â· ${meta.badge} Â· ${meta.icon} Â· ${meta.en} Â· ${meta.zh}`;
        mSub.textContent = `Lifecycle: ${time} Â· åŒè¯­ EN + ä¸­æ–‡ Â· Lenses inside modal only`;
        mgrid.innerHTML = "";
        for(let i=0;i<4;i++){
          const div = document.createElement("div");
          div.className = "box";
          div.innerHTML = `<h3>BOX ${i+1} <span class="k">LOCK</span></h3><p>Content missing. å†…å®¹ç¼ºå¤±ã€‚</p><ul><li>Fix required. <span>éœ€ä¿®å¤ã€‚</span></li><li>Fix required. <span>éœ€ä¿®å¤ã€‚</span></li><li>Fix required. <span>éœ€ä¿®å¤ã€‚</span></li><li>Fix required. <span>éœ€ä¿®å¤ã€‚</span></li></ul>`;
          mgrid.appendChild(div);
        }
        return;
      }

      mTitle.textContent = `INNOVATION Â· ${meta.badge} Â· ${meta.icon} Â· ${meta.en} Â· ${meta.zh}`;
      mSub.textContent = `Lifecycle: ${time==="origin"?"CONCEPT":(time==="now"?"NOW":"ROADMAP")} Â· åŒè¯­ EN + ä¸­æ–‡ Â· Lenses inside modal only`;

      mgrid.innerHTML = "";
      pack.boxes.forEach((b)=>{
        const div = document.createElement("div");
        div.className = "box";
        const li = b.ul.map(x=>`<li>${x}</li>`).join("");
        div.innerHTML = `<h3>${b.h}<span class="k">${b.k}</span></h3><p>${b.p}</p><ul>${li}</ul>`;
        mgrid.appendChild(div);
      });
    }

    function openModal(trunk){
      activeTrunk = trunk;
      scrollY = window.scrollY || 0;
      document.body.style.position = "fixed";
      document.body.style.top = `-${scrollY}px`;
      document.body.style.width = "100%";
      bd.classList.add("show");
      modal.classList.add("show");
      bd.setAttribute("aria-hidden","false");
      setChipStates();
      renderBoxes(trunk);
    }

    function closeModal(){
      bd.classList.remove("show");
      modal.classList.remove("show");
      bd.setAttribute("aria-hidden","true");
      document.body.style.position = "";
      document.body.style.top = "";
      document.body.style.width = "";
      window.scrollTo(0, scrollY);
      activeTrunk = null;
    }

    function attachQuadrantHandlers(){
      document.querySelectorAll(".q").forEach((el)=>{
        el.addEventListener("click", ()=> openModal(el.dataset.trunk));
        el.addEventListener("keydown", (e)=>{
          if(e.key==="Enter" || e.key===" "){ e.preventDefault(); openModal(el.dataset.trunk); }
        });
      });
    }
    attachQuadrantHandlers();

    function applyStyle(next){
      style = next;
      localStorage.setItem("gd_style", style);
      setChipStates();
      setQueryInUrl();
      if(activeTrunk) renderBoxes(activeTrunk);
    }
    function applyTime(next){
      time = next;
      localStorage.setItem("gd_time", time);
      setChipStates();
      setQueryInUrl();
      if(activeTrunk) renderBoxes(activeTrunk);
    }

    chipFormal.addEventListener("click", ()=> applyStyle("formal"));
    chipInformal.addEventListener("click", ()=> applyStyle("informal"));
    chipConcept.addEventListener("click", ()=> applyTime("origin"));
    chipNow.addEventListener("click", ()=> applyTime("now"));
    chipPost.addEventListener("click", ()=> applyTime("post"));

    x.addEventListener("click", closeModal);
    bd.addEventListener("click", (e)=>{ if(e.target===bd) closeModal(); });
    window.addEventListener("keydown", (e)=>{ if(e.key==="Escape" && bd.classList.contains("show")) closeModal(); });

    setChipStates();
    setQueryInUrl();
  </script>
</body>
</html>
