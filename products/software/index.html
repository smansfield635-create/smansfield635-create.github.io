<!-- TNT — /products/software/index.html
     PURPOSE: Products → SOFTWARE subpage (no 404)
     STRUCTURE:
       - Top-left: BACK (to /products/) + EXIT (to /door/)
       - Main: software product bubbles (click → centered modal)
       - Lenses live INSIDE modal only:
           STYLE: Formal/Informal (gd_style)
           TIME: Concept/Live/Roadmap (stored as gd_time = origin/now/post)
       - Dual language always (gd_lang = en|zh)
       - Same obsidian-opal / red field look
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PRODUCTS · SOFTWARE</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --gold:rgba(212,175,55,.9);
  --goldSoft:rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
  --mut:rgba(255,255,255,.82);
  --mut2:rgba(255,255,255,.68);
}

body{
  margin:0;
  min-height:100vh;
  background:
    radial-gradient(circle at 50% 40%, rgba(90,140,255,.10), transparent 60%),
    repeating-linear-gradient(45deg, rgba(255,255,255,.02) 0 1px, transparent 1px 100px),
    linear-gradient(180deg,#b00000 0%,#7a0000 60%,#550000 100%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:#fff;
}

.btn{
  padding:10px 16px;
  border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:white;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;
  font-weight:900;
  letter-spacing:.2px;
  text-decoration:none;
}
.btn:hover{ box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px var(--goldSoft); }

.top-left{
  position:fixed;left:16px;top:16px;z-index:90;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}

.brand{
  position:fixed;
  left:50%;
  top:16px;
  transform:translateX(-50%);
  z-index:80;
  text-align:center;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);
  backdrop-filter:blur(8px);
}
.brand .name{ font-weight:950; letter-spacing:1.2px; font-size:12px; opacity:.95; }
.brand .tag{ font-size:11px; letter-spacing:.6px; opacity:.70; margin-top:2px; }

.wrap{
  width:min(960px, 92vw);
  margin:110px auto 120px;
}

.grid{
  display:grid;
  gap:14px;
}
@media (min-width:760px){ .grid{ grid-template-columns:1fr 1fr; } }

.bubble{
  padding:16px 18px;
  border-radius:20px;
  cursor:pointer;
  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.08), transparent 55%),
    linear-gradient(145deg,var(--obs2),var(--obs1));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 18px 55px rgba(0,0,0,.78), inset 0 2px 0 rgba(255,255,255,.06);
  position:relative;
}
.bubble::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:20px;
  padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}
.bubble:hover{ box-shadow:0 22px 65px rgba(0,0,0,.86), 0 0 14px rgba(212,175,55,.16); border-color:rgba(212,175,55,.16); }
.bt{ font-weight:950; margin:0 0 6px; letter-spacing:.2px; }
.bs{ margin:0; color:var(--mut2); line-height:1.45; }

.dock{
  position:fixed;
  left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;
  width:min(900px,94vw);
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);
  backdrop-filter:blur(8px);
}

.bd{
  position:fixed;inset:0;z-index:200;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(10px);
  display:none;
}
.bd.show{display:block;}

.modal{
  position:fixed;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:min(920px,92vw);
  max-height:84vh;
  display:none;
  z-index:210;
}
.modal.show{display:block;}

.shell{
  height:84vh;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 50% 20%, rgba(176,0,0,.18), transparent 55%),
    radial-gradient(circle at 35% 25%, rgba(90,140,255,.10), transparent 55%),
    linear-gradient(160deg,var(--obs2) 0%, var(--obs1) 65%);
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}

.mhead{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  padding:14px 16px;
  border-bottom:1px solid rgba(255,255,255,.08);
}
.mtitle{ margin:0; font-weight:950; letter-spacing:.3px; font-size:16px; }
.mclose{ border:0; background:transparent; color:#fff; font-size:18px; cursor:pointer; padding:8px 10px; }

.mbody{
  padding:14px 16px 16px;
  overflow:auto;
  -webkit-overflow-scrolling:touch;
  flex:1 1 auto;
}

.lensbar{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:center;
  padding:10px 10px 14px;
  border-bottom:1px solid rgba(255,255,255,.08);
  margin:-6px -6px 14px;
}
.chip{
  padding:10px 16px;
  border-radius:999px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;
  font-weight:900;
  letter-spacing:.2px;
  color:#fff;
}
.chip.active{
  border-color:rgba(212,175,55,.35);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 16px rgba(212,175,55,.30);
}

.lead{ font-weight:950; letter-spacing:.2px; margin:0 0 8px; }
.p{ margin:0 0 12px; color:var(--mut); line-height:1.55; }
.ul{ margin:0 0 0 18px; padding:0; color:var(--mut2); }
.ul li{ margin:6px 0; }

@media (max-width:520px){
  .wrap{ margin:98px auto 120px; }
  .shell{ height:86vh; }
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" href="/products/">BACK</a>
  <a class="btn" href="/door/">EXIT</a>
</div>

<div class="brand">
  <div class="name" id="brandName">PRODUCTS</div>
  <div class="tag" id="brandTag">SOFTWARE SYSTEMS</div>
</div>

<main class="wrap">
  <div class="grid" id="grid"></div>
</main>

<nav class="dock">
  <a class="btn" href="/home/">HUB</a>
  <a class="btn" href="/index.html">TERMINAL</a>
  <a class="btn" href="/links/">LINKS</a>
  <a class="btn" href="/products/">PRODUCTS</a>
  <a class="btn" href="/laws/">LAWS</a>
  <a class="btn" href="/gauges/">GAUGES</a>
</nav>

<div class="bd" id="bd"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">DETAIL</h3>
      <button class="mclose" id="mClose" aria-label="Close">✕</button>
    </div>

    <div class="mbody">
      <div class="lensbar">
        <button class="chip" id="styleChip">STYLE: FORMAL</button>
        <button class="chip" data-time="origin" id="chipConcept">CONCEPT</button>
        <button class="chip" data-time="now" id="chipLive">LIVE</button>
        <button class="chip" data-time="post" id="chipRoadmap">ROADMAP</button>
      </div>

      <p class="lead" id="lead"></p>
      <p class="p" id="para"></p>
      <div class="lead" id="bulLabel">BULLETINS</div>
      <ul class="ul" id="bullets"></ul>
    </div>
  </div>
</div>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  const qLang = qs.get("lang");
  let lang = (qLang==="zh"||qLang==="en") ? qLang : (localStorage.getItem("gd_lang")==="zh" ? "zh" : "en");
  try{ localStorage.setItem("gd_lang", lang); }catch(e){}

  let style = localStorage.getItem("gd_style") || "formal";
  let time  = localStorage.getItem("gd_time")  || "now";
  if(time==="trajectory") time="post";
  if(!["origin","now","post"].includes(time)) time="now";
  if(!["formal","informal"].includes(style)) style="formal";

  const T = {
    en:{
      title:"PRODUCTS",
      tag:"SOFTWARE SYSTEMS",
      bul:"BULLETINS",
      s:{formal:"FORMAL",informal:"INFORMAL"},
      t:{origin:"CONCEPT",now:"LIVE",post:"ROADMAP"},
      items:[
        {
          key:"hub",
          title:"Compass Hub Platform",
          sentence:"A gem-compass hub that routes across the full architecture.",
          bullets:{
            origin:{formal:["Defines traversal topology.","Locks lens semantics.","Implements hub routing.","Sets modal recursion rules."],
                   informal:["Shows the map.","Keeps you oriented.","Keeps everything reachable.","Stops drift visually."]},
            now:{formal:["Runs as live hub.","Propagates gd_* keys.","Supports bilingual lensing.","Keeps UI stable."],
                 informal:["Works now.","Keeps state.","Feels consistent.","Stays clean."]},
            post:{formal:["Adds deeper recursion.","Adds evidence bundles.","Adds registry hooks.","Adds dashboards."],
                  informal:["More depth soon.","More tools soon.","More pages soon.","More automation soon."]}
          }
        },
        {
          key:"uci",
          title:"Universal Coherence Instrument (UCI)",
          sentence:"A measurement core that standardizes ρ/TC and HIP gate checks.",
          bullets:{
            origin:{formal:["Defines schema.","Defines primitives.","Defines Δ rules.","Defines gate vector."],
                   informal:["Defines basics.","Measures correlation.","Checks gates.","Keeps it honest."]},
            now:{formal:["Audits evidence streams.","Outputs alerts.","Exports bundles.","Supports tiers."],
                 informal:["Measures.","Alerts.","Exports.","Verifies."]},
            post:{formal:["Adds adapters library.","Adds anti-gaming harness.","Adds enterprise connectors.","Adds public registry surfaces."],
                  informal:["More adapters soon.","More checks soon.","More connectors soon.","More visibility soon."]}
          }
        },
        {
          key:"score",
          title:"Risk & Correlation Scoring",
          sentence:"A scoring surface that turns correlation exposure into an executive metric.",
          bullets:{
            origin:{formal:["Defines components.","Defines hard-fail rules.","Defines reason codes.","Defines audit outputs."],
                   informal:["Defines the score.","Defines fail rules.","Explains why.","Keeps it readable."]},
            now:{formal:["Computes per system.","Flags gate failures.","Generates one-pagers.","Exports audit trails."],
                 informal:["Scores systems.","Flags problems.","Prints reports.","Exports proof."]},
            post:{formal:["Adds insurance interface.","Adds simulations.","Adds cross-domain maps.","Adds portfolio overlays."],
                  informal:["Adds sims.","Adds investor view.","Adds maps.","Adds portfolio mode."]}
          }
        },
        {
          key:"registry",
          title:"Certification Registry Layer",
          sentence:"A public lookup surface for certificate serials, tier, and status.",
          bullets:{
            origin:{formal:["Defines issuance vectors.","Defines revocation rules.","Defines registry fields.","Defines immutability constraints."],
                   informal:["Defines certificates.","Defines revokes.","Defines lookup.","Defines what’s public."]},
            now:{formal:["Publishes status.","Supports renewal windows.","Logs reasons.","Separates powers."],
                 informal:["Shows status.","Shows dates.","Shows reasons.","Stays clean."]},
            post:{formal:["Adds third-party attestations.","Adds evidence hash chain.","Adds tier automation.","Adds API subscriptions."],
                  informal:["Adds audits.","Adds hash proofs.","Adds automation.","Adds API."]}
          }
        }
      ]
    },
    zh:{
      title:"产品",
      tag:"软件系统",
      bul:"公告要点",
      s:{formal:"正式",informal:"非正式"},
      t:{origin:"概念",now:"上线",post:"路线图"},
      items:[
        {
          key:"hub",
          title:"指南针枢纽平台",
          sentence:"一个宝石指南针枢纽，用于遍历全套架构。",
          bullets:{
            origin:{formal:["定义遍历拓扑。","锁定透镜语义。","实现枢纽路由。","规定递归规则。"],
                   informal:["展示地图。","保持方向感。","保持可达。","视觉止漂移。"]},
            now:{formal:["枢纽页上线运行。","传播 gd_* 键。","支持双语透镜。","界面稳定。"],
                 informal:["现在可用。","保持状态。","感觉一致。","保持简洁。"]},
            post:{formal:["增加更深递归。","增加证据包。","增加登记钩子。","增加仪表盘。"],
                  informal:["即将更深。","即将更多工具。","即将更多页面。","即将更多自动化。"]}
          }
        },
        {
          key:"uci",
          title:"通用一致性仪器（UCI）",
          sentence:"一个测量核心，用于标准化 ρ/TC 与 HIP 门控检查。",
          bullets:{
            origin:{formal:["定义格式。","定义原语。","定义 Δ 规则。","定义门控向量。"],
                   informal:["定义基础。","测相关暴露。","查门控。","保持诚实。"]},
            now:{formal:["审计证据流。","输出告警。","导出包。","支持分层。"],
                 informal:["能测。","能报。","能导出。","能验证。"]},
            post:{formal:["增加适配器库。","增加防作弊测试。","增加企业连接。","增加公开登记页。"],
                  informal:["更多适配器。","更多检查。","更多连接。","更多可见性。"]}
          }
        },
        {
          key:"score",
          title:"风险与相关评分",
          sentence:"把相关暴露转为高管可用指标的评分界面。",
          bullets:{
            origin:{formal:["定义组件。","定义硬失败。","定义原因码。","定义审计输出。"],
                   informal:["定义分数。","定义失败规则。","解释原因。","保持可读。"]},
            now:{formal:["按系统计算。","标记门控失败。","生成一页纸。","导出审计轨迹。"],
                 informal:["评分。","报警。","出报告。","导出证明。"]},
            post:{formal:["增加保险接口。","增加模拟。","增加跨域地图。","增加组合视图。"],
                  informal:["加模拟。","加投资视图。","加地图。","加组合模式。"]}
          }
        },
        {
          key:"registry",
          title:"认证登记层",
          sentence:"用于证书序列号、分层与状态查询的公开界面。",
          bullets:{
            origin:{formal:["定义颁发向量。","定义撤销规则。","定义登记字段。","定义不可变约束。"],
                   informal:["定义证书。","定义撤销。","定义查询。","定义公开范围。"]},
            now:{formal:["发布状态。","支持续期窗口。","记录原因。","权力分离。"],
                 informal:["看状态。","看日期。","看原因。","保持简洁。"]},
            post:{formal:["增加第三方证明。","增加证据哈希链。","增加自动化。","增加 API 订阅。"],
                  informal:["加审计。","加哈希证明。","加自动化。","加 API。"]}
          }
        }
      ]
    }
  }[lang] || null;

  const pack = T || (function(){ return null; })();

  // apply header
  document.getElementById("brandName").textContent = pack.title;
  document.getElementById("brandTag").textContent = pack.tag;
  document.documentElement.lang = (lang==="zh") ? "zh" : "en";

  // modal elements
  const bd=document.getElementById("bd");
  const modal=document.getElementById("modal");
  const mClose=document.getElementById("mClose");
  const mTitle=document.getElementById("mTitle");
  const lead=document.getElementById("lead");
  const para=document.getElementById("para");
  const bulLabel=document.getElementById("bulLabel");
  const bullets=document.getElementById("bullets");
  const grid=document.getElementById("grid");

  const styleChip=document.getElementById("styleChip");
  const chipConcept=document.getElementById("chipConcept");
  const chipLive=document.getElementById("chipLive");
  const chipRoadmap=document.getElementById("chipRoadmap");

  bulLabel.textContent = pack.bul;

  function setLensLabels(){
    styleChip.textContent = "STYLE: " + (style==="formal" ? pack.s.formal : pack.s.informal);
    chipConcept.textContent = pack.t.origin;
    chipLive.textContent = pack.t.now;
    chipRoadmap.textContent = pack.t.post;

    chipConcept.classList.toggle("active", time==="origin");
    chipLive.classList.toggle("active", time==="now");
    chipRoadmap.classList.toggle("active", time==="post");
  }

  function persist(){
    try{ localStorage.setItem("gd_style", style); localStorage.setItem("gd_time", time); }catch(e){}
  }

  let active = null;

  function openItem(item){
    active = item;
    mTitle.textContent = item.title;
    renderItem();
    bd.classList.add("show");
    modal.classList.add("show");
  }

  function close(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    active = null;
  }

  function renderItem(){
    if(!active) return;
    setLensLabels();
    persist();

    lead.textContent = active.title;
    para.textContent = active.sentence;

    bullets.innerHTML = "";
    const list = active.bullets[time][style] || [];
    list.forEach(x=>{
      const li=document.createElement("li");
      li.textContent=x;
      bullets.appendChild(li);
    });
  }

  // build grid
  (pack.items || []).forEach(it=>{
    const el=document.createElement("div");
    el.className="bubble";
    el.innerHTML = `<div class="bt">${it.title}</div><p class="bs">${it.sentence}</p>`;
    el.addEventListener("click", ()=>openItem(it));
    grid.appendChild(el);
  });

  // lens handlers
  styleChip.addEventListener("click", ()=>{ style = (style==="formal") ? "informal" : "formal"; renderItem(); });
  chipConcept.addEventListener("click", ()=>{ time="origin"; renderItem(); });
  chipLive.addEventListener("click", ()=>{ time="now"; renderItem(); });
  chipRoadmap.addEventListener("click", ()=>{ time="post"; renderItem(); });

  bd.addEventListener("click", close);
  mClose.addEventListener("click", close);

  setLensLabels();
})();
</script>

</body>
</html>
