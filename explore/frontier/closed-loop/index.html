<!-- TNT — /explore/frontier/closed-loop/index.html
     FRONTIER · CLOSED LOOP (HABITATS / ISOLATED SITES / “NO AWAY”)
     MONUMENT DENSITY · 4 LENSES · 3 LANGUAGES (EN/中文/ES)
     SINGLE-OPEN ACCORDION · NO MODALS · STATE CARRY
     ROLE:
       - “No-away” closure model: water/air/food/materials/energy as one coupled inventory
       - Habitat logic that scales DOWN to Earth (cities, plants, remote sites)
     ROUTES (SAFE SHELLS):
       - URBAN OS → /explore/frontier/urban/
       - ENERGY   → /explore/frontier/energy/
       - WATER    → /explore/frontier/water/
       - WASTE    → /explore/frontier/waste/
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>FRONTIER · Closed Loop</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
body::before,body::after{pointer-events:none!important}

:root{
  --dockH:96px;
  --mut:rgba(255,255,255,.92);
  --mut2:rgba(255,255,255,.76);

  --opal:rgba(210,190,255,.14);
  --red:rgba(255,70,70,.11);
  --gold:rgba(212,175,55,.16);
  --ink:rgba(0,0,0,.18);
}

.page{
  width:min(1200px,94vw);
  margin:0 auto;
  padding:100px 0 calc(var(--dockH) + 24px);
  display:flex;
  flex-direction:column;
  gap:22px;
}

.header{
  border:1px solid rgba(255,255,255,.12);
  border-radius:28px;
  background:
    radial-gradient(circle at 22% 18%, var(--opal), transparent 70%),
    radial-gradient(circle at 78% 28%, var(--red), transparent 72%),
    radial-gradient(circle at 55% 92%, var(--gold), transparent 72%),
    var(--ink);
  padding:30px;
  box-shadow:0 40px 120px rgba(0,0,0,.6);
}

.k{
  font-size:14px;
  letter-spacing:6px;
  text-transform:uppercase;
  opacity:.7;
  margin:0 0 12px;
}

.t{
  font-weight:900;
  font-size:42px;
  letter-spacing:1px;
  margin:0 0 14px;
}

.s{
  font-size:19px;
  line-height:1.75;
  max-width:1040px;
  opacity:.92;
}

.lenses{
  display:flex;
  gap:12px;
  flex-wrap:wrap;
  margin-top:26px;
}

.pill{
  padding:12px 20px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  cursor:pointer;
  font-weight:800;
  letter-spacing:.4px;
  font-size:14px;
  background:rgba(0,0,0,.25);
}

.pill.active{
  border-color:rgba(212,175,55,.60);
  box-shadow:0 0 18px rgba(212,175,55,.22);
}

.band{
  padding:12px 16px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.12);
  font-weight:900;
  letter-spacing:.6px;
  text-transform:uppercase;
  opacity:.9;
}

.accordion{
  display:flex;
  flex-direction:column;
  gap:18px;
}

.section{
  border:1px solid rgba(255,255,255,.10);
  border-radius:28px;
  overflow:hidden;
  background:linear-gradient(160deg, rgba(18,22,35,.95), rgba(8,12,20,.98));
}

.head{
  padding:22px 30px;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
}

.title{
  font-size:22px;
  font-weight:900;
  letter-spacing:.4px;
}

.chev{opacity:.75;font-weight:900}

.body{
  display:none;
  padding:28px 34px;
  border-top:1px solid rgba(255,255,255,.08);
  font-size:18px;
  line-height:1.85;
  color:var(--mut2);
}

.section.open .body{display:block}

.jump{
  margin-top:18px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.jump .btn{
  padding:12px 16px;
  border-radius:999px;
  white-space:nowrap;
}

.dock{
  position:fixed;
  left:50%;
  bottom:max(10px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  width:min(1000px,94vw);
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:12px;
  padding:14px;
  border-radius:24px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
}
.dock .btn{
  padding:12px;
  border-radius:999px;
  text-align:center;
  font-weight:800;
  letter-spacing:.2px;
}
@media (max-width:520px){
  .dock{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>

<body>

<div class="page">

  <div class="header">
    <p class="k" id="hk">FRONTIER</p>
    <h1 class="t" id="ht">CLOSED LOOP</h1>
    <p class="s" id="hs"></p>

    <div class="lenses">
      <button class="pill active" id="lensInformal" type="button">INFORMAL</button>
      <button class="pill" id="lensFormal" type="button">FORMAL</button>
      <button class="pill" id="lensEngineering" type="button">ENGINEERING</button>
      <button class="pill" id="lensPlatform" type="button">PLATFORM</button>
    </div>
  </div>

  <div class="band" id="band">NO AWAY · EVERYTHING IS INVENTORY</div>

  <div class="accordion" id="accordion"></div>

</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="navUrban" href="/explore/frontier/urban/">URBAN OS</a>
  <a class="btn" id="navEnergy" href="/explore/frontier/energy/">ENERGY</a>
  <a class="btn" id="navWater" href="/explore/frontier/water/">WATER</a>
  <a class="btn" id="navWaste" href="/explore/frontier/waste/">WASTE</a>
</nav>

<script>
(function(){
  // ===== canonical state (lang only used on this page; links preserve it) =====
  var qs=new URLSearchParams(location.search);
  var lang=qs.get("lang")||localStorage.getItem("gd_lang")||"en";
  if(lang!=="en"&&lang!=="zh"&&lang!=="es") lang="en";
  try{ localStorage.setItem("gd_lang",lang); }catch(e){}
  document.documentElement.lang=lang;

  function q(){ return "?lang="+encodeURIComponent(lang); }

  document.getElementById("navUrban").href="/explore/frontier/urban/"+q();
  document.getElementById("navEnergy").href="/explore/frontier/energy/"+q();
  document.getElementById("navWater").href="/explore/frontier/water/"+q();
  document.getElementById("navWaste").href="/explore/frontier/waste/"+q();

  function pick(o){ return o[lang]||o.en; }

  var headerCopy={
    en:"What changes when there is no landfill, no sewer ‘somewhere else’, and no cheap resupply? Everything becomes inventory. Closed Loop is the discipline that makes survival boring—and makes Earth systems finally behave.",
    zh:"当没有填埋、没有“排到别处”、没有廉价补给时，会发生什么？一切都变成库存。闭环就是让生存变得无聊可靠的纪律，也让地面系统终于像系统一样运行。",
    es:"¿Qué cambia cuando no hay vertedero, no hay alcantarilla ‘en otro lugar’ y no hay reabastecimiento barato? Todo es inventario. El ciclo cerrado vuelve la supervivencia aburrida—y hace que los sistemas en la Tierra se comporten de verdad."
  };
  document.getElementById("hs").textContent=pick(headerCopy);

  var lens="informal";

  var S = [
    {
      t:{en:"THE ‘NO AWAY’ PROBLEM",zh:"“没有扔掉”的问题",es:"EL PROBLEMA ‘SIN AFUERA’"},
      sub:{en:"If you can’t export waste, you must route it.",zh:"无法外运废弃物，就必须路由。",es:"Si no puedes exportar residuos, debes rutearlos."},
      c:{
        informal:{
          en:[
            "On Earth we pretend problems disappear: trash goes ‘away’, heat goes ‘away’, wastewater goes ‘away’. In a habitat, there is no away.",
            "So the real problem becomes visible: leaks, contamination, and bad routing decisions. Closed loop is not romance—it’s accounting with consequences."
          ],
          zh:[
            "在地球我们假装问题会消失：垃圾“扔掉”、热“散掉”、污水“排走”。在栖息地，没有“扔掉”。",
            "真正的问题因此暴露：泄漏、污染、错误路由。闭环不是浪漫，而是带后果的核算。"
          ],
          es:[
            "En la Tierra fingimos que los problemas desaparecen: la basura se va ‘afuera’, el calor ‘afuera’, el agua residual ‘afuera’. En un hábitat no existe ‘afuera’.",
            "Entonces aparece lo real: fugas, contaminación y malas decisiones de ruteo. Ciclo cerrado no es romance: es contabilidad con consecuencias."
          ]
        },
        formal:{
          en:[
            "Closed-loop environments remove external sinks. Loss is cumulative, failures are coupled, and contamination events propagate. Stability requires explicit routing and recovery under constraints.",
            "Therefore closure must be expressed as conserved inventories with measured leakage bands and deterministic intervention procedures."
          ],
          zh:[
            "闭环环境移除了外部汇点：损耗累积、故障耦合、污染事件传播。稳定性要求在约束下进行显式路由与恢复。",
            "因此闭合必须表达为守恒库存，并具有可测泄漏区间与确定性干预流程。"
          ],
          es:[
            "Entornos cerrados eliminan sumideros externos. La pérdida es acumulativa, las fallas están acopladas y la contaminación se propaga. La estabilidad requiere ruteo y recuperación explícitos.",
            "El cierre se expresa como inventarios conservados con bandas de fuga medidas y procedimientos deterministas."
          ]
        },
        engineering:{
          en:[
            "Define mass/energy accounting: water recovery, air recycling, nutrient loops, solids handling, thermal balance. Instrument flows, set contamination constraints, and size buffers for shock events.",
            "Design recovery playbooks: isolate → filter → reprocess → verify → rejoin. Publish yields and loss rates by window."
          ],
          zh:[
            "定义质量/能量核算：水回收、空气循环、营养回路、固体处理、热平衡。仪器化流量，设污染约束，按冲击事件配置缓冲。",
            "设计恢复剧本：隔离→过滤→再处理→验证→回并。按窗口发布产率与损耗率。"
          ],
          es:[
            "Definir contabilidad masa/energía: recuperación de agua, reciclaje de aire, ciclos de nutrientes, manejo de sólidos, balance térmico. Instrumentar flujos, límites de contaminación y buffers.",
            "Playbooks de recuperación: aislar → filtrar → reprocesar → verificar → reintegrar. Publicar rendimientos y pérdidas por ventana."
          ]
        },
        platform:{
          en:[
            "Make closure legible: show ‘what is leaking’ as a ranked list with receipts. Route users to Laws (bounds) and Gauges (signals).",
            "Keep navigation calm: one open section at a time; clear ‘next’ jumps; persistent state."
          ],
          zh:[
            "让闭合可读：把“哪里在漏”做成带收据的排序列表，并路由到法则（边界）与量规（信号）。",
            "保持导航安静：一次只开一段；下一步跳转清晰；状态持久。"
          ],
          es:[
            "Hacer el cierre legible: mostrar ‘qué está fugando’ como lista rankeada con recibos; saltar a Leyes (límites) y Medidores (señales).",
            "Navegación calmada: una sección abierta a la vez; saltos claros; estado persistente."
          ]
        }
      }
    },

    {
      t:{en:"THE CLOSED LOOP CONTRACT",zh:"闭环契约",es:"CONTRATO DE CICLO CERRADO"},
      sub:{en:"Measure → Route → Retain. The loop must be boring.",zh:"测量→路由→保留。闭环必须无聊可靠。",es:"Medir → Rutear → Retener. El ciclo debe ser aburrido."},
      c:{
        informal:{
          en:[
            "Closed loop is how you make survival boring: you measure what you have, you route what you don’t want, and you keep what matters inside the loop.",
            "The magic isn’t a gadget. The magic is refusing to let losses hide."
          ],
          zh:[
            "闭环让生存变无聊：你测你有什么，你路由你不想要的，你把重要的留在环里。",
            "魔法不是某个小玩意，而是拒绝让损耗隐藏。"
          ],
          es:[
            "Ciclo cerrado vuelve la supervivencia aburrida: mides lo que tienes, ruteas lo que no quieres y mantienes lo importante dentro del ciclo.",
            "La magia no es un gadget: es no permitir que las pérdidas se escondan."
          ]
        },
        formal:{
          en:[
            "Contract: (1) declared inventory vectors, (2) measured closure/leakage bands, (3) deterministic interventions, (4) replayable receipts.",
            "No escalation without receipts; no redefinition without epoch rollover; no interpretation beyond declared scope."
          ],
          zh:[
            "契约：(1)声明库存向量，(2)测得闭合/泄漏区间，(3)确定性干预，(4)可回放收据。",
            "无收据不升级；无新纪元不改定义；不得超范围解释。"
          ],
          es:[
            "Contrato: (1) vectores de inventario declarados, (2) bandas de cierre/fuga medidas, (3) intervenciones deterministas, (4) recibos replayables.",
            "Sin recibos no hay escalación; sin nueva época no hay redefinición; no interpretar fuera del alcance."
          ]
        },
        engineering:{
          en:[
            "Quantify closure: recovery fraction targets per lane (water/air/solids/heat). Enforce contamination thresholds. Treat maintenance as a first-class loop, not an afterthought.",
            "Design for perturbation: buffer sizing, redundancy, isolation valves, and fast verification paths."
          ],
          zh:[
            "量化闭合：按车道设回收分数目标（水/气/固体/热），执行污染阈值。把维护当作一等回路，而不是事后补丁。",
            "面向扰动设计：缓冲尺寸、冗余、隔离阀、快速验证路径。"
          ],
          es:[
            "Cuantificar cierre: metas de fracción de recuperación por carril (agua/aire/sólidos/calor). Umbrales de contaminación. Mantenimiento como bucle primario.",
            "Diseño para perturbación: buffers, redundancia, válvulas de aislamiento y verificación rápida."
          ]
        },
        platform:{
          en:[
            "Show the loop as a simple story first: what comes in, what gets reused, what is still leaking, and what you’re doing next.",
            "Then jump to deep pages (energy/water/waste) without losing state."
          ],
          zh:[
            "先把闭环讲成简单故事：进来什么、复用什么、哪里还在漏、下一步做什么。",
            "然后跳到深页（能源/水/废弃物）且不丢状态。"
          ],
          es:[
            "Primero contar el ciclo como historia simple: qué entra, qué se reutiliza, qué sigue fugando y qué harás después.",
            "Luego saltar a páginas profundas (energía/agua/residuos) sin perder estado."
          ]
        }
      }
    },

    {
      t:{en:"SHIMMER IN A HABITAT",zh:"栖息地里的 SHIMMER",es:"SHIMMER EN UN HÁBITAT"},
      sub:{en:"Same routing spine, harsher penalties.",zh:"同一路由脊柱，更严厉的惩罚。",es:"Misma columna, penalizaciones más duras."},
      c:{
        informal:{
          en:[
            "A habitat just removes the city’s excuses. You still classify, segment, route, convert, retain. You just feel every mistake sooner.",
            "That’s why this matters: if it works here, it works anywhere."
          ],
          zh:[
            "栖息地只是把城市的借口拿走：你仍然分类、分段、路由、转化、保留，只是每个错误更快被你感受到。",
            "所以它重要：能在这里稳定，就能在任何地方稳定。"
          ],
          es:[
            "Un hábitat solo elimina excusas de la ciudad: sigues clasificando, segmentando, ruteando, convirtiendo y reteniendo, pero sientes cada error antes.",
            "Por eso importa: si funciona aquí, funciona en cualquier parte."
          ]
        },
        formal:{
          en:[
            "Habitat deployment is an extreme constraint case: strict contamination bounds, bounded resupply, coupled failure modes. SHIMMER provides routing discipline under those constraints.",
            "Claims remain readiness-only unless backed by measured receipts; no net-positive fusion claims; no megastructure claims in near horizons."
          ],
          zh:[
            "栖息地部署是极限约束案例：污染边界严格、补给受限、故障耦合。SHIMMER 在这些约束下提供路由纪律。",
            "主张除非有测量收据，否则仅保持就绪姿态；不做净增益聚变主张；近期限不做巨构主张。"
          ],
          es:[
            "Despliegue en hábitat es caso extremo: límites estrictos de contaminación, reabastecimiento acotado y fallas acopladas. SHIMMER aporta disciplina de ruteo.",
            "Afirmaciones permanecen en ‘preparación’ sin recibos medidos; sin ganancia neta de fusión; sin megaestructuras en horizontes cercanos."
          ]
        },
        engineering:{
          en:[
            "Implement closed-loop routing for each lane with explicit purity constraints. Use modular redundancy and isolation to prevent cascade. Validate through windowed stress tests.",
            "Export receipts for audit replay: yields, losses, interventions, and recovery time-to-stability."
          ],
          zh:[
            "为每条车道实现闭环路由并给出纯度约束；模块化冗余与隔离阻止级联；用窗口压力测试验证。",
            "导出审计回放收据：产率、损耗、干预、恢复到稳定的时间。"
          ],
          es:[
            "Implementar ruteo cerrado por carril con restricciones de pureza. Redundancia modular y aislamiento para evitar cascada. Validar con pruebas por ventana.",
            "Exportar recibos: rendimientos, pérdidas, intervenciones y tiempo de recuperación."
          ]
        },
        platform:{
          en:[
            "Present ‘closure scoreboards’ that non-engineers can read: green/yellow/red bands per inventory lane, with a one-click drill-down into receipts.",
            "Keep the UI boringly reliable: one open accordion, no overlays, clear jumps."
          ],
          zh:[
            "提供非工程师可读的“闭合记分牌”：按车道显示绿/黄/红区间，并一键下钻到收据。",
            "UI 必须无聊可靠：单开手风琴、无遮罩、跳转清晰。"
          ],
          es:[
            "Mostrar ‘tableros de cierre’ legibles: bandas verde/amarillo/rojo por carril, con drill-down a recibos.",
            "UI confiable: acordeón único, sin overlays, saltos claros."
          ]
        }
      }
    }
  ];

  function lensLabel(){
    if(lang==="zh") return {informal:"通俗",formal:"正式",engineering:"工程",platform:"平台"};
    if(lang==="es") return {informal:"INFORMAL",formal:"FORMAL",engineering:"INGENIERÍA",platform:"PLATAFORMA"};
    return {informal:"INFORMAL",formal:"FORMAL",engineering:"ENGINEERING",platform:"PLATFORM"};
  }

  var lens="informal";

  function render(){
    var L=lensLabel();
    document.getElementById("lensInformal").textContent=L.informal;
    document.getElementById("lensFormal").textContent=L.formal;
    document.getElementById("lensEngineering").textContent=L.engineering;
    document.getElementById("lensPlatform").textContent=L.platform;

    document.getElementById("hk").textContent=(lang==="zh")?"前沿":(lang==="es")?"FRONTERA":"FRONTIER";
    document.getElementById("ht").textContent=pick({en:"CLOSED LOOP",zh:"闭环",es:"CICLO CERRADO"});
    document.getElementById("band").textContent=(lang==="zh")?"没有扔掉 · 一切都是库存":(lang==="es")?"SIN AFUERA · TODO ES INVENTARIO":"NO AWAY · EVERYTHING IS INVENTORY";

    var acc=document.getElementById("accordion");
    acc.innerHTML="";

    S.forEach(function(item, idx){
      var sec=document.createElement("div");
      sec.className="section";

      var head=document.createElement("div");
      head.className="head";

      var title=document.createElement("div");
      title.className="title";
      title.textContent=pick(item.t);

      var chev=document.createElement("div");
      chev.className="chev";
      chev.textContent="▸";

      head.appendChild(title);
      head.appendChild(chev);

      var body=document.createElement("div");
      body.className="body";

      var sub=document.createElement("div");
      sub.style.fontWeight="800";
      sub.style.color="rgba(255,255,255,.86)";
      sub.style.marginBottom="12px";
      sub.textContent=pick(item.sub);
      body.appendChild(sub);

      var lines=item.c[lens];
      for(var i=0;i<lines.length;i++){
        var p=document.createElement("div");
        p.style.marginTop=(i===0)?"0":"14px";
        p.textContent=lines[i];
        body.appendChild(p);
      }

      var jump=document.createElement("div");
      jump.className="jump";
      var openLabel=(lang==="zh")?"打开":(lang==="es")?"ABRIR":"OPEN";

      var j1=document.createElement("a"); j1.className="btn"; j1.textContent=openLabel+": URBAN OS"; j1.href="/explore/frontier/urban/"+q();
      var j2=document.createElement("a"); j2.className="btn"; j2.textContent=openLabel+": ENERGY"; j2.href="/explore/frontier/energy/"+q();
      var j3=document.createElement("a"); j3.className="btn"; j3.textContent=openLabel+": LAWS"; j3.href="/laws/"+q();
      jump.appendChild(j1); jump.appendChild(j2); jump.appendChild(j3);
      body.appendChild(jump);

      sec.appendChild(head);
      sec.appendChild(body);
      acc.appendChild(sec);

      function closeAll(){
        acc.querySelectorAll(".section").forEach(function(x){
          x.classList.remove("open");
          var c=x.querySelector(".chev");
          if(c) c.textContent="▸";
        });
      }
      function toggle(){
        var willOpen=!sec.classList.contains("open");
        closeAll();
        if(willOpen){ sec.classList.add("open"); chev.textContent="▾"; }
      }

      head.addEventListener("click", toggle);
      head.addEventListener("keydown", function(e){
        if(e.key==="Enter"||e.key===" "){ e.preventDefault(); toggle(); }
      });
      head.tabIndex=0; head.setAttribute("role","button");

      if(idx===0){ sec.classList.add("open"); chev.textContent="▾"; }
    });
  }

  function setActive(){
    ["lensInformal","lensFormal","lensEngineering","lensPlatform"].forEach(function(id){
      document.getElementById(id).classList.remove("active");
    });
    if(lens==="informal") document.getElementById("lensInformal").classList.add("active");
    if(lens==="formal") document.getElementById("lensFormal").classList.add("active");
    if(lens==="engineering") document.getElementById("lensEngineering").classList.add("active");
    if(lens==="platform") document.getElementById("lensPlatform").classList.add("active");
  }

  document.getElementById("lensInformal").addEventListener("click", function(){ lens="informal"; setActive(); render(); });
  document.getElementById("lensFormal").addEventListener("click", function(){ lens="formal"; setActive(); render(); });
  document.getElementById("lensEngineering").addEventListener("click", function(){ lens="engineering"; setActive(); render(); });
  document.getElementById("lensPlatform").addEventListener("click", function(){ lens="platform"; setActive(); render(); });

  setActive();
  render();

})();
</script>

</body>
</html>
