<!-- /explore/index.html | QUEEN‚ÄôS ARCHITECTURE ‚Äî GEM STANDARD | TNT FULL FILE
     FIX: TRUE LANGUAGE LENS + EMBEDDED CONTENT (NO window.CONTENT DEPENDENCY)
     - Keeps your existing design approach (inline CSS + gem diamond + modal)
     - lang=en shows EN only
     - lang=zh shows ‰∏≠Êñá only
     - Modal always renders 4 boxes √ó 4 bullets (no LOCK fallback)
     - Lenses remain inside modal only (STYLE + LIFECYCLE)
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark" />
  <title>QUEEN‚ÄôS ARCHITECTURE ¬∑ INNOVATION</title>

  <style>
    :root{
      --bg0:#140006; --bg1:#1d0009; --bg2:#26000c;
      --opal1:rgba(245,248,255,.92); --opal2:rgba(216,226,255,.58); --opal3:rgba(180,200,255,.22);
      --gold1:rgba(255,220,120,.92); --gold2:rgba(255,190,70,.55); --gold3:rgba(255,160,40,.25);
      --ink:rgba(245,248,255,.94); --muted:rgba(245,248,255,.74);
      --hair:rgba(255,210,120,.80);
      --shadow: 0 18px 80px rgba(0,0,0,.55);
      --rad:18px;
      --rad2:26px;
      --w: min(980px, 92vw);
      --h: min(620px, 78vh);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "PingFang SC", "Microsoft YaHei", sans-serif;
      color:var(--ink);
      background:
        radial-gradient(1200px 700px at 50% 30%, rgba(255,220,120,.07), transparent 60%),
        radial-gradient(900px 520px at 18% 70%, rgba(210,235,255,.05), transparent 62%),
        radial-gradient(900px 520px at 85% 75%, rgba(210,235,255,.04), transparent 62%),
        linear-gradient(180deg, var(--bg2), var(--bg0));
      overflow-x:hidden;
    }

    .top{width:100%;padding:18px 18px 10px;display:flex;align-items:flex-start;justify-content:center;}
    .topin{width:var(--w);display:flex;align-items:flex-start;justify-content:space-between;gap:12px;}
    .brand{display:flex;flex-direction:column;gap:4px;letter-spacing:.3px;}
    .brand .t1{font-weight:700;font-size:14px;opacity:.92}
    .brand .t2{font-weight:900;font-size:20px;line-height:1.05;letter-spacing:.3px}
    .brand .t3{font-weight:650;font-size:12px;opacity:.74;letter-spacing:.2px}
    .stamp{
      display:flex;align-items:center;gap:10px;font-size:12px;opacity:.90;
      padding:8px 10px;border-radius:999px;border:1px solid rgba(255,210,120,.28);
      background:rgba(0,0,0,.18);box-shadow:0 10px 30px rgba(0,0,0,.28);
      user-select:none;white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:50%;
      background:radial-gradient(circle at 30% 30%, var(--gold1), rgba(255,200,80,.20));
      box-shadow:0 0 12px rgba(255,210,120,.22);
    }

    .stage{width:100%;display:flex;justify-content:center;padding:8px 18px 26px;}
    .frame{width:var(--w);min-height:calc(var(--h) + 40px);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:18px;}

    .subtitle{width:100%;display:flex;align-items:center;justify-content:center;opacity:.92;gap:10px;margin-top:8px;}
    .subtitle .big{font-weight:950;letter-spacing:.5px;font-size:22px;text-shadow:0 2px 14px rgba(0,0,0,.55);}
    .subtitle .small{font-weight:750;font-size:12px;opacity:.76;letter-spacing:.2px;text-shadow:0 2px 14px rgba(0,0,0,.45);}

    .diamondWrap{
      position:relative;width:min(760px, 92vw);height:min(760px, 92vw);
      max-width:760px;max-height:760px;display:flex;align-items:center;justify-content:center;
      filter:drop-shadow(0 22px 80px rgba(0,0,0,.55));
    }

    .diamond{
      position:relative;width:82%;height:82%;transform:rotate(45deg);border-radius:var(--rad2);
      background:
        linear-gradient(135deg, rgba(255,210,120,.05), rgba(210,235,255,.04)),
        radial-gradient(900px 650px at 28% 18%, rgba(245,248,255,.08), transparent 62%),
        radial-gradient(780px 560px at 72% 82%, rgba(245,248,255,.05), transparent 64%),
        rgba(0,0,0,.26);
      border:1px solid rgba(255,210,120,.28);box-shadow:var(--shadow);overflow:hidden;
    }

    .diamond::before{
      content:"";position:absolute;inset:10px;border-radius:calc(var(--rad2) - 6px);
      border:1px solid rgba(255,210,120,.42);
      box-shadow:inset 0 0 0 1px rgba(210,235,255,.06), inset 0 0 18px rgba(255,210,120,.05);
      pointer-events:none;
    }
    .diamond::after{
      content:"";position:absolute;inset:0;
      background:
        radial-gradient(900px 520px at 15% 22%, rgba(255,210,120,.06), transparent 58%),
        radial-gradient(820px 520px at 82% 78%, rgba(210,235,255,.045), transparent 60%),
        linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.22));
      pointer-events:none;
    }

    .qgrid{
      position:absolute;inset:14px;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr;
      gap:12px;transform:rotate(-45deg) scale(1.08);transform-origin:center;padding:22px;
    }

    .q{
      position:relative;border-radius:20px;border:1px solid rgba(255,210,120,.18);
      background:
        radial-gradient(240px 200px at 30% 25%, rgba(245,248,255,.10), transparent 66%),
        radial-gradient(240px 200px at 70% 75%, rgba(255,210,120,.07), transparent 66%),
        rgba(0,0,0,.32);
      overflow:hidden;cursor:pointer;user-select:none;
      transition:transform .12s ease,border-color .12s ease,background .12s ease,box-shadow .12s ease;
      display:flex;align-items:center;justify-content:center;padding:18px;text-align:center;min-height:160px;
      box-shadow:inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .q:hover{
      transform:translateY(-2px);border-color:rgba(255,210,120,.28);
      background:
        radial-gradient(240px 200px at 30% 25%, rgba(245,248,255,.12), transparent 66%),
        radial-gradient(240px 200px at 70% 75%, rgba(255,210,120,.09), transparent 66%),
        rgba(0,0,0,.36);
      box-shadow:inset 0 0 0 1px rgba(210,235,255,.05),0 0 22px rgba(255,210,120,.06);
    }
    .q:active{transform:translateY(0px) scale(.995);}

    .q .inner{display:flex;flex-direction:column;gap:8px;align-items:center;justify-content:center;}
    .q .badge{
      display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,210,120,.28);background:rgba(0,0,0,.22);
      font-weight:900;letter-spacing:.7px;font-size:12px;opacity:.95;
      box-shadow:inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .q .name{font-size:18px;font-weight:950;letter-spacing:.25px;line-height:1.12;text-shadow:0 2px 18px rgba(0,0,0,.60);}
    .q .sub{font-size:12px;font-weight:750;opacity:.82;line-height:1.35;max-width:300px;text-shadow:0 2px 18px rgba(0,0,0,.55);}

    .foot{width:var(--w);display:flex;align-items:center;justify-content:center;gap:10px;padding:4px 0 0;opacity:.95;flex-wrap:wrap;}
    .btn{
      appearance:none;border:none;cursor:pointer;padding:10px 12px;border-radius:999px;background:rgba(0,0,0,.22);
      border:1px solid rgba(255,210,120,.24);color:var(--ink);font-weight:900;letter-spacing:.25px;font-size:12px;
      display:inline-flex;align-items:center;gap:8px;transition:transform .12s ease,border-color .12s ease,background .12s ease;
      text-decoration:none;box-shadow:0 10px 28px rgba(0,0,0,.28);
    }
    .btn:hover{transform:translateY(-1px);border-color:rgba(255,210,120,.34);background:rgba(0,0,0,.26);}
    .btn:active{transform:translateY(0);}
    .btn .k{opacity:.85;font-weight:950}

    .bd{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;
      background:rgba(0,0,0,.66);backdrop-filter:blur(7px);z-index:50;padding:18px;
    }
    .bd.show{display:flex;}
    .modal{
      position:relative;width:min(980px, 92vw);max-height:min(760px, 86vh);
      display:none;flex-direction:column;border-radius:22px;border:1px solid rgba(255,210,120,.28);
      background:
        radial-gradient(860px 520px at 18% 10%, rgba(245,248,255,.08), transparent 60%),
        radial-gradient(800px 560px at 86% 88%, rgba(255,210,120,.06), transparent 62%),
        radial-gradient(980px 640px at 52% 10%, rgba(176,0,0,.12), transparent 58%),
        rgba(0,0,0,.44);
      box-shadow:0 28px 140px rgba(0,0,0,.78);overflow:hidden;
    }
    .modal.show{display:flex;}
    .mhead{
      padding:14px 16px 10px;display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
      border-bottom:1px solid rgba(255,210,120,.14);background:rgba(0,0,0,.20);
    }
    .mttl{display:flex;flex-direction:column;gap:4px;min-width:0;}
    .mttl .h1{font-weight:950;letter-spacing:.35px;font-size:16px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-shadow:0 2px 18px rgba(0,0,0,.65);}
    .mttl .h2{font-weight:800;font-size:12px;opacity:.78;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-shadow:0 2px 18px rgba(0,0,0,.55);}
    .x{
      width:38px;height:38px;border-radius:999px;border:1px solid rgba(255,210,120,.26);background:rgba(0,0,0,.22);color:var(--ink);
      cursor:pointer;font-weight:950;display:inline-flex;align-items:center;justify-content:center;transition:transform .12s ease,border-color .12s ease,background .12s ease;
      user-select:none;box-shadow:0 10px 28px rgba(0,0,0,.30);
    }
    .x:hover{transform:translateY(-1px);border-color:rgba(255,210,120,.34);background:rgba(0,0,0,.28);}
    .x:active{transform:translateY(0);}

    .lensbar{
      padding:10px 16px 12px;display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;
      border-bottom:1px solid rgba(210,235,255,.08);background:rgba(0,0,0,.16);
    }
    .lensgroup{display:flex;align-items:center;gap:8px;flex-wrap:wrap;}
    .lenslabel{
      font-size:11px;font-weight:950;opacity:.74;letter-spacing:.55px;text-transform:uppercase;padding:6px 8px;border-radius:999px;
      background:rgba(0,0,0,.16);border:1px solid rgba(210,235,255,.07);
    }
    .chip{
      cursor:pointer;user-select:none;padding:8px 10px;border-radius:999px;border:1px solid rgba(255,210,120,.22);background:rgba(0,0,0,.18);
      color:var(--ink);font-weight:950;letter-spacing:.2px;font-size:12px;display:inline-flex;align-items:center;gap:8px;
      transition:transform .12s ease,border-color .12s ease,background .12s ease,box-shadow .12s ease;white-space:nowrap;
      box-shadow:0 10px 26px rgba(0,0,0,.26);
    }
    .chip:hover{transform:translateY(-1px);border-color:rgba(255,210,120,.32);background:rgba(0,0,0,.22);}
    .chip:active{transform:translateY(0);}
    .chip.on{
      border-color:rgba(255,210,120,.46);
      box-shadow:inset 0 0 0 1px rgba(255,210,120,.12),0 0 22px rgba(255,210,120,.10);
      background:rgba(255,210,120,.06);
    }

    .mbody{padding:14px 16px 16px;overflow:auto;overscroll-behavior:contain;}
    .mgrid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    @media (max-width: 860px){.mgrid{grid-template-columns:1fr;}.diamondWrap{height:min(620px, 92vw);}}

    .box{
      border-radius:18px;border:1px solid rgba(255,210,120,.18);
      background:
        radial-gradient(420px 260px at 22% 18%, rgba(245,248,255,.08), transparent 64%),
        radial-gradient(420px 260px at 80% 86%, rgba(255,210,120,.06), transparent 66%),
        rgba(0,0,0,.30);
      padding:12px 12px 10px;box-shadow:inset 0 0 0 1px rgba(210,235,255,.05);
    }
    .box h3{margin:0;font-size:13px;font-weight:950;letter-spacing:.25px;display:flex;align-items:center;justify-content:space-between;gap:10px;text-shadow:0 2px 16px rgba(0,0,0,.60);}
    .box .k{font-size:11px;font-weight:950;opacity:.78;padding:4px 8px;border-radius:999px;border:1px solid rgba(210,235,255,.08);background:rgba(0,0,0,.16);letter-spacing:.45px;}
    .box p{margin:8px 0 8px;font-size:12px;font-weight:800;opacity:.86;line-height:1.35;text-shadow:0 2px 16px rgba(0,0,0,.55);}
    .box ul{margin:0;padding-left:16px;display:flex;flex-direction:column;gap:6px;}
    .box li{font-size:12px;font-weight:850;line-height:1.28;opacity:.92;text-shadow:0 2px 14px rgba(0,0,0,.55);}
  </style>
</head>

<body>
  <header class="top">
    <div class="topin">
      <div class="brand">
        <div class="t1" id="t1"></div>
        <div class="t2" id="t2"></div>
        <div class="t3" id="t3"></div>
      </div>
      <div class="stamp" aria-label="module stamp">
        <span class="dot" aria-hidden="true"></span>
        <span id="modName">Cardinal Axis</span>
        <span style="opacity:.55">¬∑</span>
        <span id="stateStamp">lang=en ¬∑ style=formal ¬∑ time=now</span>
      </div>
    </div>
  </header>

  <main class="stage">
    <section class="frame">
      <div class="subtitle" aria-hidden="true">
        <div class="big" id="pageTitle"></div>
        <div class="small" id="pageSub"></div>
      </div>

      <div class="diamondWrap" aria-label="Innovation diamond">
        <div class="diamond">
          <div class="qgrid">
            <div class="q" data-trunk="nw" role="button" tabindex="0" aria-label="Open NW trunk">
              <div class="inner">
                <div class="badge"><span>NW</span><span style="opacity:.55">¬∑</span><span>‚≠ê</span></div>
                <div class="name" id="nwName"></div>
                <div class="sub" id="nwSub"></div>
              </div>
            </div>

            <div class="q" data-trunk="ne" role="button" tabindex="0" aria-label="Open NE trunk">
              <div class="inner">
                <div class="badge"><span>NE</span><span style="opacity:.55">¬∑</span><span>‚òÄÔ∏è</span></div>
                <div class="name" id="neName"></div>
                <div class="sub" id="neSub"></div>
              </div>
            </div>

            <div class="q" data-trunk="sw" role="button" tabindex="0" aria-label="Open SW trunk">
              <div class="inner">
                <div class="badge"><span>SW</span><span style="opacity:.55">¬∑</span><span>üî•</span></div>
                <div class="name" id="swName"></div>
                <div class="sub" id="swSub"></div>
              </div>
            </div>

            <div class="q" data-trunk="se" role="button" tabindex="0" aria-label="Open SE trunk">
              <div class="inner">
                <div class="badge"><span>SE</span><span style="opacity:.55">¬∑</span><span>üåô</span></div>
                <div class="name" id="seName"></div>
                <div class="sub" id="seSub"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <nav class="foot" aria-label="internal navigation">
        <a class="btn" id="toHome" href="#"><span class="k">‚óÜ</span><span id="navHome"></span></a>
        <a class="btn" id="toProducts" href="#"><span class="k">‚óÜ</span><span id="navProducts"></span></a>
        <a class="btn" id="toLaws" href="#"><span class="k">‚óÜ</span><span id="navLaws"></span></a>
        <a class="btn" id="toLinks" href="#"><span class="k">‚óÜ</span><span id="navLinks"></span></a>
      </nav>
    </section>
  </main>

  <div class="bd" id="bd" aria-hidden="true">
    <div class="modal" id="modal" role="dialog" aria-modal="true" aria-labelledby="mTitle">
      <div class="mhead">
        <div class="mttl">
          <div class="h1" id="mTitle"></div>
          <div class="h2" id="mSub"></div>
        </div>
        <button class="x" id="x" aria-label="Close modal">‚úï</button>
      </div>

      <div class="lensbar" aria-label="lenses">
        <div class="lensgroup">
          <span class="lenslabel" id="lblStyle"></span>
          <span class="chip" id="chipFormal" data-style="formal"></span>
          <span class="chip" id="chipInformal" data-style="informal"></span>
        </div>
        <div class="lensgroup">
          <span class="lenslabel" id="lblLife"></span>
          <span class="chip" id="chipConcept" data-time="origin"></span>
          <span class="chip" id="chipNow" data-time="now"></span>
          <span class="chip" id="chipPost" data-time="post"></span>
        </div>
      </div>

      <div class="mbody">
        <div class="mgrid" id="mgrid"></div>
      </div>
    </div>
  </div>

  <script>
    // URL ‚Üí STATE HYDRATION
    const qs = new URLSearchParams(location.search);
    let lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
    let style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
    let time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
    if(!["en","zh"].includes(lang)) lang="en";
    if(!["formal","informal"].includes(style)) style="formal";
    if(time==="trajectory") time="post";
    if(!["origin","now","post"].includes(time)) time="now";
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);

    function makeQ(){ return `lang=${encodeURIComponent(lang)}&style=${encodeURIComponent(style)}&time=${encodeURIComponent(time)}`; }
    function setQueryInUrl(){ history.replaceState(null, "", `${location.pathname}?${makeQ()}`); }

    document.getElementById("toHome").href = `/home/?${makeQ()}`;
    document.getElementById("toProducts").href = `/products/?${makeQ()}`;
    document.getElementById("toLaws").href = `/laws/?${makeQ()}`;
    document.getElementById("toLinks").href = `/links/?${makeQ()}`;

    const stateStamp = document.getElementById("stateStamp");
    function refreshStamp(){ stateStamp.textContent = `lang=${lang} ¬∑ style=${style} ¬∑ time=${time}`; }

    const UI = {
      en:{
        t1:"QUEEN‚ÄôS ARCHITECTURE",
        t2:"INNOVATION",
        t3:"Diamond 2 ¬∑ Future Layer ¬∑ Explore",
        pageTitle:"INNOVATION",
        pageSub:"Future trunks ¬∑ lifecycle lenses inside modal",
        nav:{home:"HOME",products:"PRODUCTS",laws:"LAWS",links:"LINKS"},
        lblStyle:"STYLE", lblLife:"LIFECYCLE",
        chips:{formal:"Formal",informal:"Informal",concept:"CONCEPT",now:"NOW",post:"ROADMAP"},
        trunks:{
          nw:{name:"LANGUAGE ENGINE", sub:"Semantic compilers, interaction grammar, multi-modal synthesis."},
          ne:{name:"EXECUTION SYSTEMS", sub:"Deterministic workflows, receipts, constrained operations at speed."},
          sw:{name:"MEASUREMENT LAB", sub:"Instruments, stress sweeps, audit-grade evidence streams."},
          se:{name:"GOVERNANCE STACK", sub:"Rules, policy lattices, safety controllers for real deployment."}
        }
      },
      zh:{
        t1:"Â•≥ÁéãÊû∂ÊûÑ",
        t2:"ÂàõÊñ∞",
        t3:"ÈíªÁü≥‰∫å ¬∑ Êú™Êù•Â±Ç ¬∑ Êé¢Á¥¢",
        pageTitle:"ÂàõÊñ∞",
        pageSub:"Êú™Êù•Âπ≤Á∫ø ¬∑ ÁîüÂëΩÂë®ÊúüÈïúÂ§¥Âú®ÂºπÁ™óÂÜÖ",
        nav:{home:"‰∏ªÈ°µ",products:"‰∫ßÂìÅ",laws:"Ê≥ïÂàô",links:"ÈìæÊé•"},
        lblStyle:"È£éÊ†º", lblLife:"ÁîüÂëΩÂë®Êúü",
        chips:{formal:"Ê≠£Âºè",informal:"Áõ¥Êé•",concept:"Ê¶ÇÂøµ",now:"ÂΩìÂâç",post:"Ë∑ØÁ∫øÂõæ"},
        trunks:{
          nw:{name:"ËØ≠Ë®ÄÂºïÊìé", sub:"ËØ≠‰πâÁºñËØë„ÄÅ‰∫§‰∫íËØ≠Ê≥ï„ÄÅÂ§öÊ®°ÊÄÅÂêàÊàê„ÄÇ"},
          ne:{name:"ÊâßË°åÁ≥ªÁªü", sub:"Á°ÆÂÆöÊÄßÊµÅÁ®ã„ÄÅÂõûÊâß„ÄÅÁ∫¶ÊùüÊâßË°å„ÄÇ"},
          sw:{name:"ÊµãÈáèÂÆûÈ™åÂÆ§", sub:"‰ª™Âô®„ÄÅÂéãÂäõÊâ´Êé†„ÄÅÂÆ°ËÆ°Á∫ßËØÅÊçÆÊµÅ„ÄÇ"},
          se:{name:"Ê≤ªÁêÜÊ†à", sub:"ËßÑÂàô„ÄÅÊîøÁ≠ñÊ†º„ÄÅÈÉ®ÁΩ≤Á∫ßÂÆâÂÖ®ÊéßÂà∂„ÄÇ"}
        }
      }
    };
    const T = UI[lang];
    document.documentElement.lang = lang;

    document.getElementById("t1").textContent = T.t1;
    document.getElementById("t2").textContent = T.t2;
    document.getElementById("t3").textContent = T.t3;
    document.getElementById("pageTitle").textContent = T.pageTitle;
    document.getElementById("pageSub").textContent = T.pageSub;

    document.getElementById("navHome").textContent = T.nav.home;
    document.getElementById("navProducts").textContent = T.nav.products;
    document.getElementById("navLaws").textContent = T.nav.laws;
    document.getElementById("navLinks").textContent = T.nav.links;

    document.getElementById("lblStyle").textContent = T.lblStyle;
    document.getElementById("lblLife").textContent = T.lblLife;

    const chipFormal = document.getElementById("chipFormal");
    const chipInformal = document.getElementById("chipInformal");
    const chipConcept = document.getElementById("chipConcept");
    const chipNow = document.getElementById("chipNow");
    const chipPost = document.getElementById("chipPost");

    chipFormal.textContent = T.chips.formal;
    chipInformal.textContent = T.chips.informal;
    chipConcept.textContent = T.chips.concept;
    chipNow.textContent = T.chips.now;
    chipPost.textContent = T.chips.post;

    document.getElementById("nwName").textContent = T.trunks.nw.name;
    document.getElementById("nwSub").textContent = T.trunks.nw.sub;
    document.getElementById("neName").textContent = T.trunks.ne.name;
    document.getElementById("neSub").textContent = T.trunks.ne.sub;
    document.getElementById("swName").textContent = T.trunks.sw.name;
    document.getElementById("swSub").textContent = T.trunks.sw.sub;
    document.getElementById("seName").textContent = T.trunks.se.name;
    document.getElementById("seSub").textContent = T.trunks.se.sub;

    refreshStamp();
    setQueryInUrl();

    const bd = document.getElementById("bd");
    const modal = document.getElementById("modal");
    const x = document.getElementById("x");
    const mTitle = document.getElementById("mTitle");
    const mSub = document.getElementById("mSub");
    const mgrid = document.getElementById("mgrid");

    let activeTrunk=null, scrollY=0;

    const TRUNK_META = {
      nw:{badge:"NW",icon:"‚≠ê",en:"LANGUAGE ENGINE",zh:"ËØ≠Ë®ÄÂºïÊìé"},
      ne:{badge:"NE",icon:"‚òÄÔ∏è",en:"EXECUTION SYSTEMS",zh:"ÊâßË°åÁ≥ªÁªü"},
      sw:{badge:"SW",icon:"üî•",en:"MEASUREMENT LAB",zh:"ÊµãÈáèÂÆûÈ™åÂÆ§"},
      se:{badge:"SE",icon:"üåô",en:"GOVERNANCE STACK",zh:"Ê≤ªÁêÜÊ†à"}
    };

    const BOX=(k,enH,zhH,enP,zhP,enU,zhU)=>({k,h:{en:enH,zh:zhH},p:{en:enP,zh:zhP},ul:[
      {en:enU[0],zh:zhU[0]},{en:enU[1],zh:zhU[1]},{en:enU[2],zh:zhU[2]},{en:enU[3],zh:zhU[3]}
    ]});

    // Deterministic embedded content (complete; same shape for all trunks)
    const CONTENT = {};
    ["nw","ne","sw","se"].forEach(tr=>{
      CONTENT[tr]={origin:{formal:{boxes:[]},informal:{boxes:[]}},now:{formal:{boxes:[]},informal:{boxes:[]}},post:{formal:{boxes:[]},informal:{boxes:[]}}};
    });

    function fillTrunk(tr, originFormal, originInformal, nowFormal, nowInformal, postFormal, postInformal){
      CONTENT[tr].origin.formal.boxes=originFormal;
      CONTENT[tr].origin.informal.boxes=originInformal;
      CONTENT[tr].now.formal.boxes=nowFormal;
      CONTENT[tr].now.informal.boxes=nowInformal;
      CONTENT[tr].post.formal.boxes=postFormal;
      CONTENT[tr].post.informal.boxes=postInformal;
    }

    function commonPack(trNameEn,trNameZh){
      return {
        origin:{
          formal:[
            BOX("SCOPE","Definition","ÂÆö‰πâ",
              `Define ${trNameEn} as a future product trunk with stable semantics.`,
              `Â∞Ü${trNameZh}ÂÆö‰πâ‰∏∫Êú™Êù•‰∫ßÂìÅÂπ≤Á∫øÔºöËØ≠‰πâÁ®≥ÂÆö„ÄÇ`,
              ["Trunk name is stable.","NW/NE/SW/SE are coordinates.","No semantic drift.","Topology stays fixed."],
              ["Âπ≤Á∫øÂêçÁß∞Á®≥ÂÆö„ÄÇ","NW/NE/SW/SE‰∏∫ÂùêÊ†á„ÄÇ","‰∏çËØ≠‰πâÊºÇÁßª„ÄÇ","ÊãìÊâëÂõ∫ÂÆö„ÄÇ"]),
            BOX("MECHANICS","Mechanics","Êú∫Âà∂",
              "Concept ‚Üí structured navigation ‚Üí outputs (deterministic).",
              "Ê¶ÇÂøµ‚ÜíÁªìÊûÑÂåñÂØºËà™‚ÜíËæìÂá∫ÔºàÁ°ÆÂÆöÊÄßÔºâ„ÄÇ",
              ["Tap trunk ‚Üí modal.","Lenses inside modal.","4√ó4 density rule.","Return closes modal."],
              ["ÁÇπÂπ≤Á∫ø‚ÜíÂºπÁ™ó„ÄÇ","ÈïúÂ§¥‰ªÖÂºπÁ™óÂÜÖ„ÄÇ","4√ó4ÂØÜÂ∫¶ËßÑÂàô„ÄÇ","ËøîÂõûÂÖ≥Èó≠ÂºπÁ™ó„ÄÇ"]),
            BOX("QUALITY","Integrity","ÂÆåÊï¥ÊÄß",
              "Contract compliance: gd_* keys, URL hydration, deterministic routing.",
              "Â•ëÁ∫¶‰∏ÄËá¥Ôºögd_*ÈîÆ„ÄÅURLÊ≥®Ê∞¥„ÄÅÁ°ÆÂÆöË∑ØÁî±„ÄÇ",
              ["gd_* keys only.","URL hydration first.","Links propagate state.","No hidden overrides."],
              ["‰ªÖgd_*ÈîÆ„ÄÇ","ÂÖàURLÊ≥®Ê∞¥„ÄÇ","ÈìæÊé•‰º†ÂèÇ„ÄÇ","Êó†ÊöóË¶ÜÁõñ„ÄÇ"]),
            BOX("DELIVERABLE","Concept Pack","Ê¶ÇÂøµÂåÖ",
              "Publish a concept pack: scope, mechanics, constraints, examples.",
              "ÂèëÂ∏ÉÊ¶ÇÂøµÂåÖÔºöËåÉÂõ¥„ÄÅÊú∫Âà∂„ÄÅÁ∫¶Êùü„ÄÅÁ§∫‰æã„ÄÇ",
              ["Scope statement.","Mechanics bullets.","Constraint list.","Example outputs."],
              ["ËåÉÂõ¥Â£∞Êòé„ÄÇ","Êú∫Âà∂Ë¶ÅÁÇπ„ÄÇ","Á∫¶ÊùüÊ∏ÖÂçï„ÄÇ","Á§∫‰æãËæìÂá∫„ÄÇ"])
          ],
          informal:[
            BOX("SCOPE","What it is","ÊòØ‰ªÄ‰πà",
              `A future product trunk: ${trNameEn}.`,
              `Êú™Êù•‰∫ßÂìÅÂπ≤Á∫øÔºö${trNameZh}„ÄÇ`,
              ["Name stays stable.","No drift.","Fixed map.","Clear meaning."],
              ["ÂêçÂ≠óÁ®≥ÂÆö„ÄÇ","‰∏çÊºÇÁßª„ÄÇ","Âú∞ÂõæÂõ∫ÂÆö„ÄÇ","Âê´‰πâÊ∏ÖÊ•ö„ÄÇ"]),
            BOX("MECHANICS","How it works","ÊÄé‰πàË∑ë",
              "Tap ‚Üí read ‚Üí return.",
              "ÁÇπÂºÄ‚ÜíÈòÖËØª‚ÜíËøîÂõû„ÄÇ",
              ["Modal-only lenses.","4√ó4 density.","No jump.","Close to return."],
              ["ÈïúÂ§¥‰ªÖÂºπÁ™ó„ÄÇ","4√ó4ÂØÜÂ∫¶„ÄÇ","‰∏çË∑≥Âä®„ÄÇ","ÂÖ≥Èó≠ËøîÂõû„ÄÇ"]),
            BOX("QUALITY","Rules","ËßÑÂàô",
              "Same keys everywhere.",
              "Â§ÑÂ§ÑÂêåÈîÆ„ÄÇ",
              ["gd_lang/gd_style/gd_time.","URL hydration.","Propagate q.","No extra keys."],
              ["gd_lang/gd_style/gd_time„ÄÇ","URLÊ≥®Ê∞¥„ÄÇ","‰º†q„ÄÇ","‰∏çÂä†Êñ∞ÈîÆ„ÄÇ"]),
            BOX("DELIVERABLE","What you get","ÂæóÂà∞Âï•",
              "A usable spec surface.",
              "‰∏Ä‰ªΩÂèØÁî®ËßÑÊ†ºË°®Èù¢„ÄÇ",
              ["Bullets.","Examples.","Constraints.","Outputs."],
              ["Ë¶ÅÁÇπ„ÄÇ","Á§∫‰æã„ÄÇ","Á∫¶Êùü„ÄÇ","ËæìÂá∫„ÄÇ"])
          ]
        },
        now:{
          formal:[
            BOX("BUILD","Prototype","ÂéüÂûã",
              `Build the first runnable ${trNameEn} surface with uniform GEM behavior.`,
              `ÊûÑÂª∫È¶ñ‰∏™ÂèØËøêË°åÁöÑ${trNameZh}Ë°®Èù¢ÔºåÁªü‰∏ÄGEMË°å‰∏∫„ÄÇ`,
              ["Same diamond layout.","Same modal.","Same chips.","Same close behavior."],
              ["ÂêåËè±ÂΩ¢Â∏ÉÂ±Ä„ÄÇ","ÂêåÂºπÁ™ó„ÄÇ","ÂêåËäØÁâá„ÄÇ","ÂêåÂÖ≥Èó≠Ë°å‰∏∫„ÄÇ"]),
            BOX("STATE","State Discipline","Áä∂ÊÄÅÁ∫™Âæã",
              "Hydrate from URL and persist canonical keys only.",
              "‰ªéURLÊ≥®Ê∞¥Âπ∂‰ªÖÊåÅ‰πÖÂåñËßÑËåÉÈîÆ„ÄÇ",
              ["lang/style/time parsed.","Normalized values.","Stored in localStorage.","Query kept clean."],
              ["Ëß£Êûêlang/style/time„ÄÇ","ËßÑËåÉÂåñÂèñÂÄº„ÄÇ","localStorageÂ≠òÂÇ®„ÄÇ","Êü•ËØ¢‰øùÊåÅÂπ≤ÂáÄ„ÄÇ"]),
            BOX("CONTENT","4√ó4 Density","4√ó4ÂØÜÂ∫¶",
              "Every view ships 4 sections √ó 4 bullets (no empties).",
              "ÊØè‰∏™ËßÜÂõæ‰∫§‰ªò4Âå∫√ó4Ë¶ÅÁÇπÔºà‰∏çËÆ∏Á©∫Ôºâ„ÄÇ",
              ["No empty boxes.","Lens changes change content.","Readable defaults.","Consistent titles."],
              ["‰∏çÁ©∫ÁõíÂ≠ê„ÄÇ","ÈïúÂ§¥ÊîπÂèòÂÜÖÂÆπ„ÄÇ","ÈªòËÆ§ÂèØËØª„ÄÇ","Ê†áÈ¢ò‰∏ÄËá¥„ÄÇ"]),
            BOX("OUTPUT","Early Surface","Êó©ÊúüË°®Èù¢",
              "Expose early outputs as safe previews.",
              "Â∞ÜÊó©ÊúüËæìÂá∫‰Ωú‰∏∫ÂÆâÂÖ®È¢ÑËßà„ÄÇ",
              ["Preview features.","Preview constraints.","Preview routing.","Preview UX."],
              ["È¢ÑËßàÂäüËÉΩ„ÄÇ","È¢ÑËßàÁ∫¶Êùü„ÄÇ","È¢ÑËßàË∑ØÁî±„ÄÇ","È¢ÑËßà‰ΩìÈ™å„ÄÇ"])
          ],
          informal:[
            BOX("BUILD","Make it run","Ë∑ëËµ∑Êù•",
              "Same look, same behavior.",
              "ÂêåÂ§ñËßÇÔºåÂêåÊâãÊÑü„ÄÇ",
              ["Diamond.","Modal.","Chips.","Close."],
              ["Ëè±ÂΩ¢„ÄÇ","ÂºπÁ™ó„ÄÇ","ËäØÁâá„ÄÇ","ÂÖ≥Èó≠„ÄÇ"]),
            BOX("STATE","Keep keys clean","ÈîÆË¶ÅÂπ≤ÂáÄ",
              "Only gd_*.",
              "Âè™Áî®gd_*„ÄÇ",
              ["Hydrate URL.","Save keys.","Keep q.","No extras."],
              ["Ê≥®Ê∞¥URL„ÄÇ","‰øùÂ≠òÈîÆ„ÄÇ","‰øùÁïôq„ÄÇ","‰∏çÂä†È¢ùÂ§ñ„ÄÇ"]),
            BOX("CONTENT","No empty","‰∏çËÆ∏Á©∫",
              "4√ó4 always.",
              "Ê∞∏Ëøú4√ó4„ÄÇ",
              ["4 sections.","4 bullets.","Readable.","Consistent."],
              ["4Âå∫„ÄÇ","4ÁÇπ„ÄÇ","ÂèØËØª„ÄÇ","‰∏ÄËá¥„ÄÇ"]),
            BOX("OUTPUT","Preview","È¢ÑËßà",
              "Show what‚Äôs coming.",
              "Â±ïÁ§∫Â∞ÜÊù•‰ºöÊúâÂï•„ÄÇ",
              ["Features.","Rules.","UX.","Map."],
              ["ÂäüËÉΩ„ÄÇ","ËßÑÂàô„ÄÇ","‰ΩìÈ™å„ÄÇ","Âú∞Âõæ„ÄÇ"])
          ]
        },
        post:{
          formal:[
            BOX("ROADMAP","Roadmap","Ë∑ØÁ∫øÂõæ",
              `Promote ${trNameEn} into a shipped product line with subpages and demos.`,
              `Â∞Ü${trNameZh}ÂçáÁ∫ß‰∏∫Â∑≤‰∫§‰ªò‰∫ßÂìÅÁ∫øÔºöÂ≠êÈ°µÈù¢+ÊºîÁ§∫„ÄÇ`,
              ["Sub-hubs per trunk.","Demos per fruit.","Exports.","Registry links."],
              ["ÊØèÂπ≤Á∫øÂ≠êÊû¢Á∫Ω„ÄÇ","ÊØèÊûúÂÆûÊºîÁ§∫„ÄÇ","ÂØºÂá∫„ÄÇ","ÁôªËÆ∞ÈìæÊé•„ÄÇ"]),
            BOX("SCALE","Scale","Êâ©Â±ï",
              "Scale content without changing topology or keys.",
              "Êâ©Â±ïÂÜÖÂÆπ‰ΩÜ‰∏çÊîπÂèòÊãìÊâëÊàñÁä∂ÊÄÅÈîÆ„ÄÇ",
              ["Topology fixed.","Keys fixed.","Components reused.","Versioned content."],
              ["ÊãìÊâëÂõ∫ÂÆö„ÄÇ","ÈîÆÂõ∫ÂÆö„ÄÇ","ÁªÑ‰ª∂Â§çÁî®„ÄÇ","ÂÜÖÂÆπÁâàÊú¨Âåñ„ÄÇ"]),
            BOX("VERIFY","Verification","È™åËØÅ",
              "Tie outputs to evidence bundles and audit artifacts.",
              "Â∞ÜËæìÂá∫ÁªëÂÆöËØÅÊçÆÂåÖ‰∏éÂÆ°ËÆ°Â∑•‰ª∂„ÄÇ",
              ["Evidence bundles.","Hashes.","Reports.","Replays."],
              ["ËØÅÊçÆÂåÖ„ÄÇ","ÂìàÂ∏å„ÄÇ","Êä•Âëä„ÄÇ","ÂõûÊîæ„ÄÇ"]),
            BOX("IMPACT","Pipeline","ÁÆ°Á∫ø",
              "Concept ‚Üí prototype ‚Üí product (explicit promotion).",
              "Ê¶ÇÂøµ‚ÜíÂéüÂûã‚Üí‰∫ßÂìÅÔºàÊòæÂºèÊôãÂçáÔºâ„ÄÇ",
              ["Promotion events.","Explicit gates.","No silent changes.","Public-safe."],
              ["ÊôãÂçá‰∫ã‰ª∂„ÄÇ","ÊòæÂºèÈó®Êéß„ÄÇ","Êó†ÊöóÊîπ„ÄÇ","ÂØπÂÖ¨‰ºóÂÆâÂÖ®„ÄÇ"])
          ],
          informal:[
            BOX("ROADMAP","Next","‰∏ã‰∏ÄÊ≠•",
              "Turn this into real products.",
              "ÊääÂÆÉÂèòÊàêÁúü‰∫ßÂìÅ„ÄÇ",
              ["Subpages.","Demos.","Exports.","Links."],
              ["Â≠êÈ°µ„ÄÇ","ÊºîÁ§∫„ÄÇ","ÂØºÂá∫„ÄÇ","ÈìæÊé•„ÄÇ"]),
            BOX("SCALE","Grow safely","ÂÆâÂÖ®Êâ©Â±ï",
              "No topology changes.",
              "‰∏çÊîπÊãìÊâë„ÄÇ",
              ["Map fixed.","Keys fixed.","Reuse parts.","Version content."],
              ["Âú∞ÂõæÂõ∫ÂÆö„ÄÇ","ÈîÆÂõ∫ÂÆö„ÄÇ","Â§çÁî®ÈÉ®‰ª∂„ÄÇ","ÂÜÖÂÆπÁâàÊú¨Âåñ„ÄÇ"]),
            BOX("VERIFY","Prove it","ËØÅÊòé",
              "Tie to evidence.",
              "ÁªëÂÆöËØÅÊçÆ„ÄÇ",
              ["Bundles.","Hashes.","Reports.","Replay."],
              ["ËØÅÊçÆÂåÖ„ÄÇ","ÂìàÂ∏å„ÄÇ","Êä•Âëä„ÄÇ","ÂõûÊîæ„ÄÇ"]),
            BOX("IMPACT","Pipeline","ÁÆ°Á∫ø",
              "Concept ‚Üí prototype ‚Üí product.",
              "Ê¶ÇÂøµ‚ÜíÂéüÂûã‚Üí‰∫ßÂìÅ„ÄÇ",
              ["Promotion gates.","No silent changes.","Public-safe.","Deterministic."],
              ["ÊôãÂçáÈó®„ÄÇ","Êó†ÊöóÊîπ„ÄÇ","ÂØπÂÖ¨‰ºóÂÆâÂÖ®„ÄÇ","Á°ÆÂÆöÊÄß„ÄÇ"])
          ]
        }
      };
    }

    // Fill each trunk with a trunk-specific name (content stays coherent)
    ["nw","ne","sw","se"].forEach(tr=>{
      const meta=TRUNK_META[tr];
      const P=commonPack(meta.en, meta.zh);
      fillTrunk(tr, P.origin.formal, P.origin.informal, P.now.formal, P.now.informal, P.post.formal, P.post.informal);
    });

    function setChipStates(){
      chipFormal.classList.toggle("on", style==="formal");
      chipInformal.classList.toggle("on", style==="informal");
      chipConcept.classList.toggle("on", time==="origin");
      chipNow.classList.toggle("on", time==="now");
      chipPost.classList.toggle("on", time==="post");
      refreshStamp();
    }

    function renderBoxes(trunk){
      const meta=TRUNK_META[trunk];
      const title=(lang==="zh")?meta.zh:meta.en;

      mTitle.textContent = `INNOVATION ¬∑ ${meta.badge} ¬∑ ${meta.icon} ¬∑ ${title}`;
      mSub.textContent = (lang==="zh")
        ? `ËØ≠Ë®Ä=${lang} ¬∑ È£éÊ†º=${style} ¬∑ ÁîüÂëΩÂë®Êúü=${time} ¬∑ ÈïúÂ§¥‰ªÖÂú®ÂºπÁ™óÂÜÖ`
        : `lang=${lang} ¬∑ style=${style} ¬∑ lifecycle=${time} ¬∑ lenses inside modal only`;

      const pack = CONTENT[trunk][time][style].boxes;

      mgrid.innerHTML="";
      pack.forEach(b=>{
        const div=document.createElement("div");
        div.className="box";
        const h=b.h[lang];
        const p=b.p[lang];
        const ul=b.ul.map(x=>`<li>${x[lang]}</li>`).join("");
        div.innerHTML=`<h3>${h}<span class="k">${b.k}</span></h3><p>${p}</p><ul>${ul}</ul>`;
        mgrid.appendChild(div);
      });
    }

    function openModal(trunk){
      activeTrunk=trunk;
      scrollY=window.scrollY||0;
      document.body.style.position="fixed";
      document.body.style.top=`-${scrollY}px`;
      document.body.style.width="100%";
      bd.classList.add("show");
      modal.classList.add("show");
      bd.setAttribute("aria-hidden","false");
      setChipStates();
      renderBoxes(trunk);
    }
    function closeModal(){
      bd.classList.remove("show");
      modal.classList.remove("show");
      bd.setAttribute("aria-hidden","true");
      document.body.style.position="";
      document.body.style.top="";
      document.body.style.width="";
      window.scrollTo(0, scrollY);
      activeTrunk=null;
    }

    function attachQuadrantHandlers(){
      document.querySelectorAll(".q").forEach(el=>{
        el.addEventListener("click", ()=>openModal(el.dataset.trunk));
        el.addEventListener("keydown", e=>{
          if(e.key==="Enter"||e.key===" "){ e.preventDefault(); openModal(el.dataset.trunk); }
        });
      });
    }
    attachQuadrantHandlers();

    function applyStyle(next){
      style=next;
      localStorage.setItem("gd_style", style);
      setChipStates();
      setQueryInUrl();
      if(activeTrunk) renderBoxes(activeTrunk);
    }
    function applyTime(next){
      time=next;
      localStorage.setItem("gd_time", time);
      setChipStates();
      setQueryInUrl();
      if(activeTrunk) renderBoxes(activeTrunk);
    }

    chipFormal.addEventListener("click", ()=>applyStyle("formal"));
    chipInformal.addEventListener("click", ()=>applyStyle("informal"));
    chipConcept.addEventListener("click", ()=>applyTime("origin"));
    chipNow.addEventListener("click", ()=>applyTime("now"));
    chipPost.addEventListener("click", ()=>applyTime("post"));

    x.addEventListener("click", closeModal);
    bd.addEventListener("click", e=>{ if(e.target===bd) closeModal(); });
    window.addEventListener("keydown", e=>{ if(e.key==="Escape" && bd.classList.contains("show")) closeModal(); });

    setChipStates();
    refreshStamp();
    setQueryInUrl();
  </script>
</body>
</html>
