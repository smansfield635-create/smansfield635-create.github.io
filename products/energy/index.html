<!-- TNT — /products/energy/index.html  (PRODUCTS · ENERGY · GEEP EXECUTION SURFACE)
     PURPOSE:
       - "Marry" current ENERGY page mechanics with GEEP-UI-9to3-v1.0 authority geometry
       - Express A+B THROUGH C (WITHOUT claim upgrade)
     TOP LEVEL (GEEP):
       - North: VALIDATION (FULCRUM)   [R3 / C5 (+ TV read-only in Formal only)]
       - West:  INDUSTRIAL (C)         [R1 / C1]
       - East:  PHYSICS (MECHANISMS)   [R2 / (C2,C3,C4)] (GATED / NO GAIN CLAIM)
       - South: GOVERNANCE (LOCKS)     [R3 / (C6,C7)]
     NON-NEGOTIABLES:
       - Public claim tier remains Industrial (C)
       - No net-fusion language, no Lawson implication, no Q>1 implication
       - No new state keys beyond gd_lang/gd_style/gd_time
       - Lenses exist INSIDE modal only
       - Category bubbles inside modal (tap-to-expand) to prevent overwhelm
       - Diamonds must open on mobile (hit-test lock + dock tap-safe + inline onclick)
       - Uses /assets/ui.css + /assets/branch.css only; does NOT style html/body background
     NOTE:
       - This file is "structure complete" and "thorough" while remaining non-hardware / non-claim drifting.
       - DHY→GEEP resolver integration is NOT implemented here; placeholders are handled as text in VALIDATION.
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PRODUCTS · ENERGY</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --R:154px;
  --goldSoft:rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
  --mut:rgba(255,255,255,.84);
  --mut2:rgba(255,255,255,.68);
}
body{margin:0;min-height:100vh;overflow-x:hidden;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;color:#fff}

/* Top-left */
.top-left{position:fixed;left:16px;top:16px;z-index:90;display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.btn{
  padding:10px 16px;border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:#fff;border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;font-weight:900;letter-spacing:.2px;text-decoration:none;
  -webkit-tap-highlight-color:transparent;
}
.btn:hover{box-shadow:0 18px 50px rgba(0,0,0,.9),0 0 14px var(--goldSoft)}

/* Brand pill */
.brand{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  z-index:80;text-align:center;padding:10px 14px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);backdrop-filter:blur(8px);
}
.brand .name{font-weight:950;letter-spacing:1.2px;font-size:12px;opacity:.95}
.brand .tag{font-size:11px;letter-spacing:.6px;opacity:.70;margin-top:2px}

/* Stage (hit-test lock) */
.stage{
  position:fixed;left:50%;top:52%;
  transform:translate(-50%,-50%);
  width:min(720px,94vw);height:min(720px,94vw);
  z-index:60;
  pointer-events:none; /* stage ignores taps */
}
.outer{
  position:absolute;left:50%;top:50%;
  width:min(680px,92vw);height:min(680px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  background:
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.14), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.45) 0%, rgba(7,11,18,.62) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 90px 260px rgba(0,0,0,.72), inset 0 2px 0 rgba(255,255,255,.10), inset 0 -50px 90px rgba(0,0,0,.55);
  opacity:.85;
  pointer-events:none;
}
.outer::after{
  content:"";position:absolute;inset:0;border-radius:60px;
  background:repeating-conic-gradient(from 0deg, rgba(255,255,255,.04) 0deg 6deg, transparent 6deg 18deg);
  opacity:.16; pointer-events:none;
}
.d{
  width:170px;height:170px;position:absolute;left:50%;top:50%;
  transform-origin:center;border-radius:26px;cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  background:
    radial-gradient(circle at 35% 25%, rgba(255,255,255,.14), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.18), transparent 60%),
    linear-gradient(160deg, rgba(12,22,38,.92) 0%, rgba(7,11,18,.95) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 28px 84px rgba(0,0,0,.78), inset 0 2px 0 rgba(255,255,255,.14), inset 0 -28px 44px rgba(0,0,0,.62);
  transition:transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
  pointer-events:auto; /* diamonds receive taps */
  touch-action:manipulation;
}
.d::before{
  content:"";position:absolute;inset:0;border-radius:26px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.45;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.d::after{
  content:"";position:absolute;left:12%;right:12%;top:10%;height:28%;
  border-radius:999px;background:linear-gradient(to bottom, rgba(255,255,255,.16), rgba(255,255,255,0));
  opacity:.85;transform:rotate(-10deg);pointer-events:none;
}
.d:hover{transform:translate(-50%,-50%) rotate(45deg) scale(1.02)}
.d.active{
  border-color:rgba(212,175,55,.55);
  box-shadow:0 34px 110px rgba(0,0,0,.88),0 0 30px rgba(212,175,55,.40),
    inset 0 2px 0 rgba(255,255,255,.18),inset 0 -32px 52px rgba(0,0,0,.68);
}
.d-n{transform:translate(-50%,-50%) translate(0, calc(var(--R) * -1)) rotate(45deg)}
.d-e{transform:translate(-50%,-50%) translate(var(--R), 0) rotate(45deg)}
.d-s{transform:translate(-50%,-50%) translate(0, var(--R)) rotate(45deg)}
.d-w{transform:translate(-50%,-50%) translate(calc(var(--R) * -1), 0) rotate(45deg)}
.inner{width:100%;height:100%;transform:rotate(-45deg);display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:16px;gap:10px;pointer-events:none;user-select:none}
.lab{font-weight:950;letter-spacing:.8px;font-size:16px}
.sub{font-size:12.5px;opacity:.80;line-height:1.35;max-width:18em}
.core{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:74px;height:74px;border-radius:22px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.18);box-shadow:0 18px 44px rgba(0,0,0,.62), inset 0 2px 0 rgba(255,255,255,.10);display:grid;place-items:center;font-weight:950;letter-spacing:.5px;opacity:.92;pointer-events:none}

/* Dock (tap-safe) */
.dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;width:min(900px,94vw);
  display:flex;justify-content:center;gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);backdrop-filter:blur(8px);
  pointer-events:none;
}
.dock .btn{pointer-events:auto}

/* Modal */
.bd{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.65);backdrop-filter:blur(10px);display:none}
.bd.show{display:block}
.modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(1020px,94vw);max-height:88vh;display:none;z-index:210}
.modal.show{display:block}
.shell{
  height:88vh;border-radius:26px;border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 50% 18%, rgba(176,0,0,.20), transparent 55%),
    radial-gradient(circle at 40% 25%, rgba(90,140,255,.12), transparent 55%),
    linear-gradient(160deg,var(--obs2) 0%, var(--obs1) 65%);
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:hidden;display:flex;flex-direction:column;
}
.mhead{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
.mtitle{margin:0;font-weight:950;letter-spacing:.3px;font-size:16px}
.mclose{border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;padding:8px 10px}
.mbody{padding:14px 16px 18px;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}
.lensbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;padding:10px 10px 14px;border-bottom:1px solid rgba(255,255,255,.08);margin:-6px -6px 14px}
.chip{padding:10px 16px;border-radius:999px;background:linear-gradient(145deg,var(--obs2),var(--obs1));border:1px solid rgba(255,255,255,.08);box-shadow:0 14px 36px rgba(0,0,0,.65);cursor:pointer;font-weight:900;letter-spacing:.2px;color:#fff}
.chip.active{border-color:rgba(212,175,55,.35);box-shadow:0 18px 50px rgba(0,0,0,.9),0 0 16px rgba(212,175,55,.30)}

.mgrid{display:grid;gap:14px}

/* Category bubbles (collapsible) */
.cbox{
  padding:16px 18px;border-radius:22px;
  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.08), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 18px 60px rgba(0,0,0,.70), inset 0 2px 0 rgba(255,255,255,.06);
  position:relative;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.cbox::before{
  content:"";position:absolute;inset:0;border-radius:22px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.cbox.open{border-color:rgba(212,175,55,.28); box-shadow:0 22px 80px rgba(0,0,0,.78), 0 0 18px rgba(212,175,55,.10), inset 0 2px 0 rgba(255,255,255,.06)}
.ch{margin:0 0 8px;font-weight:950;letter-spacing:.2px;font-size:16px}
.cp{margin:0;color:var(--mut);line-height:1.55;display:none}
.cbox.open .cp{display:block}
.cmini{margin:0;color:rgba(255,255,255,.70);font-size:12.5px;line-height:1.45}
.cbox.open .cmini{display:none}
.cul{margin:10px 0 0 18px;padding:0;color:var(--mut2);display:none}
.cbox.open .cul{display:block}
.cul li{margin:6px 0}

/* Modal actions */
.mact{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}
.sbtn{padding:12px 18px;border-radius:14px;background:linear-gradient(145deg,var(--obs2),var(--obs1));color:#fff;border:1px solid rgba(255,255,255,.08);box-shadow:0 14px 36px rgba(0,0,0,.7);cursor:pointer;font-weight:900;letter-spacing:.2px;text-decoration:none}

@media (max-width:560px){:root{--R:136px}.d{width:158px;height:158px}.stage{top:50%}}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnBack" href="/products/">BACK</a>
  <a class="btn" id="btnExit" href="/door/">EXIT</a>
</div>

<div class="brand">
  <div class="name" id="brandName">PRODUCTS</div>
  <div class="tag" id="brandTag">ENERGY · GEEP EXECUTION PLATFORM</div>
</div>

<div class="stage">
  <div class="outer"></div>

  <!-- GEEP Compass -->
  <div class="d d-n" id="dValidation" role="button" tabindex="0" onclick="window.__openEnergy('validation')">
    <div class="inner"><div class="lab" id="labValidation">VALIDATION</div><div class="sub" id="subValidation">Fulcrum · admissibility · stop rules.</div></div>
  </div>

  <div class="d d-w" id="dIndustrial" role="button" tabindex="0" onclick="window.__openEnergy('industrial')">
    <div class="inner"><div class="lab" id="labIndustrial">INDUSTRIAL (C)</div><div class="sub" id="subIndustrial">Thermal substitution only.</div></div>
  </div>

  <div class="d d-e" id="dPhysics" role="button" tabindex="0" onclick="window.__openEnergy('physics')">
    <div class="inner"><div class="lab" id="labPhysics">PHYSICS</div><div class="sub" id="subPhysics">Mechanisms · bounded. (GATED)</div></div>
  </div>

  <div class="d d-s" id="dGovernance" role="button" tabindex="0" onclick="window.__openEnergy('governance')">
    <div class="inner"><div class="lab" id="labGovernance">GOVERNANCE</div><div class="sub" id="subGovernance">Locks · tiers · escalation law.</div></div>
  </div>

  <div class="core">◆</div>
</div>

<nav class="dock" id="dock">
  <a class="btn" id="dockHub" href="/home/">HUB</a>
  <a class="btn" id="dockTerminal" href="/index.html">TERMINAL</a>
  <a class="btn" id="dockLinks" href="/links/">LINKS</a>
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<div class="bd" id="bd"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">DETAIL</h3>
      <button class="mclose" id="mClose" aria-label="Close" type="button">✕</button>
    </div>

    <div class="mbody">
      <div class="lensbar">
        <button class="chip" id="styleChip" type="button">STYLE: FORMAL</button>
        <button class="chip" data-time="origin" id="chipConcept" type="button">CONCEPT</button>
        <button class="chip" data-time="now" id="chipLive" type="button">LIVE</button>
        <button class="chip" data-time="post" id="chipRoadmap" type="button">ROADMAP</button>
      </div>

      <div class="mgrid" id="mgrid">
        <div class="cbox" id="c1" role="button" tabindex="0"><h4 class="ch" id="h1"></h4><p class="cmini" id="m1"></p><p class="cp" id="p1"></p><ul class="cul" id="u1"></ul></div>
        <div class="cbox" id="c2" role="button" tabindex="0"><h4 class="ch" id="h2"></h4><p class="cmini" id="m2"></p><p class="cp" id="p2"></p><ul class="cul" id="u2"></ul></div>
        <div class="cbox" id="c3" role="button" tabindex="0"><h4 class="ch" id="h3"></h4><p class="cmini" id="m3"></p><p class="cp" id="p3"></p><ul class="cul" id="u3"></ul></div>
        <div class="cbox" id="c4" role="button" tabindex="0"><h4 class="ch" id="h4"></h4><p class="cmini" id="m4"></p><p class="cp" id="p4"></p><ul class="cul" id="u4"></ul></div>
      </div>

      <div class="mact">
        <button class="sbtn" id="mReturn" type="button">RETURN</button>
        <a class="sbtn" id="mJumpProducts" href="/products/">JUMP PRODUCTS</a>
        <a class="sbtn" id="mJumpHub" href="/home/">JUMP HUB</a>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // ===== State hydration (gd_* only) =====
  const qs = new URLSearchParams(location.search);
  let lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  let style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  let time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  if(!["en","zh"].includes(lang)) lang="en";
  if(!["formal","informal"].includes(style)) style="formal";
  if(time==="trajectory") time="post";
  if(!["origin","now","post"].includes(time)) time="now";
  try{ localStorage.setItem("gd_lang",lang); localStorage.setItem("gd_style",style); localStorage.setItem("gd_time",time); }catch(e){}
  document.documentElement.lang = (lang==="zh") ? "zh" : "en";

  const q = () => `lang=${encodeURIComponent(lang)}&style=${encodeURIComponent(style)}&time=${encodeURIComponent(time)}`;
  function setLinks(){
    const s=q();
    document.getElementById("btnBack").href="/products/?"+s;
    document.getElementById("btnExit").href="/door/?"+s;
    document.getElementById("dockHub").href="/home/?"+s;
    document.getElementById("dockTerminal").href="/index.html?"+s;
    document.getElementById("dockLinks").href="/links/?"+s;
    document.getElementById("dockProducts").href="/products/?"+s;
    document.getElementById("dockLaws").href="/laws/?"+s;
    document.getElementById("dockGauges").href="/gauges/?"+s;
    document.getElementById("mJumpProducts").href="/products/?"+s;
    document.getElementById("mJumpHub").href="/home/?"+s;
  }
  setLinks();

  // ===== UI text =====
  const UI = {
    en:{
      brand:"PRODUCTS",
      tag:"ENERGY · GEEP EXECUTION PLATFORM",
      d:{
        validation:{lab:"VALIDATION", sub:"Fulcrum · admissibility · stop rules."},
        industrial:{lab:"INDUSTRIAL (C)", sub:"Thermal substitution only."},
        physics:{lab:"PHYSICS", sub:"Mechanisms · bounded. (GATED)"},
        governance:{lab:"GOVERNANCE", sub:"Locks · tiers · escalation law."}
      },
      lens:{formal:"FORMAL",informal:"INFORMAL",concept:"CONCEPT",live:"LIVE",roadmap:"ROADMAP"},
      btn:{ret:"RETURN",jp:"JUMP PRODUCTS",jh:"JUMP HUB"},
      stylePrefix:"STYLE: "
    },
    zh:{
      brand:"产品",
      tag:"能源 · GEEP 执行平台",
      d:{
        validation:{lab:"验证", sub:"支点 · 可采信 · 停止规则。"},
        industrial:{lab:"工业 (C)", sub:"仅工业热替代。"},
        physics:{lab:"物理", sub:"机制 · 有界。（门控）"},
        governance:{lab:"治理", sub:"锁定 · 分层 · 升级法则。"}
      },
      lens:{formal:"正式",informal:"通俗",concept:"概念",live:"上线",roadmap:"路线图"},
      btn:{ret:"返回",jp:"跳转产品",jh:"跳转枢纽"},
      stylePrefix:"风格："
    }
  };
  const ui = (lang==="zh") ? UI.zh : UI.en;

  document.getElementById("brandName").textContent = ui.brand;
  document.getElementById("brandTag").textContent = ui.tag;

  document.getElementById("labValidation").textContent = ui.d.validation.lab;
  document.getElementById("subValidation").textContent = ui.d.validation.sub;
  document.getElementById("labIndustrial").textContent = ui.d.industrial.lab;
  document.getElementById("subIndustrial").textContent = ui.d.industrial.sub;
  document.getElementById("labPhysics").textContent = ui.d.physics.lab;
  document.getElementById("subPhysics").textContent = ui.d.physics.sub;
  document.getElementById("labGovernance").textContent = ui.d.governance.lab;
  document.getElementById("subGovernance").textContent = ui.d.governance.sub;

  // ===== Modal refs =====
  const bd=document.getElementById("bd");
  const modal=document.getElementById("modal");
  const mClose=document.getElementById("mClose");
  const mTitle=document.getElementById("mTitle");
  const styleChip=document.getElementById("styleChip");
  const chipConcept=document.getElementById("chipConcept");
  const chipLive=document.getElementById("chipLive");
  const chipRoadmap=document.getElementById("chipRoadmap");

  const c1=document.getElementById("c1"),c2=document.getElementById("c2"),c3=document.getElementById("c3"),c4=document.getElementById("c4");
  const h1=document.getElementById("h1"),p1=document.getElementById("p1"),u1=document.getElementById("u1"),m1=document.getElementById("m1");
  const h2=document.getElementById("h2"),p2=document.getElementById("p2"),u2=document.getElementById("u2"),m2=document.getElementById("m2");
  const h3=document.getElementById("h3"),p3=document.getElementById("p3"),u3=document.getElementById("u3"),m3=document.getElementById("m3");
  const h4=document.getElementById("h4"),p4=document.getElementById("p4"),u4=document.getElementById("u4"),m4=document.getElementById("m4");

  document.getElementById("mReturn").textContent = ui.btn.ret;
  document.getElementById("mJumpProducts").textContent = ui.btn.jp;
  document.getElementById("mJumpHub").textContent = ui.btn.jh;

  const persist=()=>{ try{ localStorage.setItem("gd_style",style); localStorage.setItem("gd_time",time);}catch(e){} };
  const setLensLabels=()=>{
    styleChip.textContent = ui.stylePrefix + (style==="formal" ? ui.lens.formal : ui.lens.informal);
    chipConcept.textContent = ui.lens.concept;
    chipLive.textContent = ui.lens.live;
    chipRoadmap.textContent = ui.lens.roadmap;
    chipConcept.classList.toggle("active", time==="origin");
    chipLive.classList.toggle("active", time==="now");
    chipRoadmap.classList.toggle("active", time==="post");
  };

  function fillBox(hEl,pEl,uEl,mEl,b){
    const safe = b || {h:"—",p:"—",u:["—","—","—","—"]};
    hEl.textContent = safe.h || "—";
    pEl.textContent = safe.p || "—";
    const mini = (safe.u && safe.u[0]) ? safe.u[0] : (safe.p ? safe.p.slice(0,80) : "—");
    mEl.textContent = mini;
    uEl.innerHTML="";
    const arr = (safe.u && safe.u.length) ? safe.u : ["—","—","—","—"];
    for(let i=0;i<4;i++){
      const li=document.createElement("li");
      li.textContent = arr[i] || "—";
      uEl.appendChild(li);
    }
  }

  const DOTGRID_EN = "DOTGRID + DHY are the evidence spine: encoding + strict certificates (S1→S2→S3). No certificate → no escalation.";
  const DOTGRID_ZH = "DOTGRID + DHY 是证据主干：编码 + 严格认证（S1→S2→S3）。无认证 → 不升级。";

  const GEEP_AXIOM_EN = "GEEP Axiom: escalation is permitted only when independently auditable, loss-closed, hash-sealed measurement shows bounded gain exceeding bounded loss within declared confinement bounds.";
  const GEEP_AXIOM_ZH = "GEEP 公理：只有在独立可审计、损耗闭合、哈希封存的测量表明“有界增益 > 有界损耗”且处于声明的约束边界内时，才允许升级。";

  const TV_DEF_EN = "TV = log10(nTτ_current / nTτ_required). Read-only. TV is NOT MEASURED unless both values are admissible receipts.";
  const TV_DEF_ZH = "TV = log10(nTτ_current / nTτ_required)。只读。若无可采信凭证，TV 显示 NOT MEASURED。";

  function B(h,p,a,b,c,d){ return {h:h,p:p,u:[a,b,c,d]}; }

  const EN = {
    industrial:{
      origin:{
        formal:{title:"INDUSTRIAL (C) · Concept",
          b1:B("Public claim ceiling","This surface is Industrial (C) only: plasma-based thermal substitution under measured loss envelope. It does not claim net gain and does not imply fusion viability.","Claim tier locked: C only.","No Q>1 implication.","No Lawson implication.","Research is gated and separate."),
          b2:B("What is delivered","Industrial delivery is defined by measured inputs, measured thermal outputs, and bounded stability. The product is an execution surface, not a hypothesis.","Metered input power (facility-level).","Metered thermal output.","Aux loads accounted.","Uptime + variance tracked."),
          b3:B("Deployment discipline","Deployment is staged. Scaling is allowed only within safety envelope and evidence tier.","Pilot (lab/pilot) first.","Cluster only after stable pilot.","Industrial adjacency only with safety receipts.","No leapfrogging tiers."),
          b4:B("Industrial proofs","Industrial proofs are receipts: efficiency, loss closure, safety envelope, incident logs, and independent safety review where required.","Loss closure required (100%±uncertainty).","Thermal capture efficiency tracked.","Rollback/kill conditions logged.","Insurance posture documented.")
        },
        informal:{title:"INDUSTRIAL (C) · Concept (Plain)",
          b1:B("Claim ceiling","This page is Industrial only. It’s about clean industrial heat and control—not gain claims.","Industrial only.","No fusion claims.","No “near gain” language.","Research is gated."),
          b2:B("What you get","You get measurable thermal substitution: power in, heat out, stability maintained.","Measured power in.","Measured heat out.","Aux loads included.","Stable operation."),
          b3:B("How it scales","We scale in stages and only when receipts support it.","Pilot first.","Then cluster.","Then industry.","No leaps."),
          b4:B("Proof standard","Proof means receipts and logs, not stories.","Receipts.","Logs.","Stop rules.","Independent checks.")
        }
      },
      now:{
        formal:{title:"INDUSTRIAL (C) · Live",
          b1:B("Current status","Live posture remains Industrial (C). Any research metrics shown elsewhere are gated and cannot upgrade the public claim tier.","CLAIM TIER: C (locked).","Research tier: gated.","No gain language.","Stop rules active."),
          b2:B("Operational metrics","Live metrics are industrial: efficiency, stability variance, uptime, and safety envelope adherence. No speculative future claims.","Thermal efficiency reported.","Aux load ratio tracked.","Variance tracked.","Uptime tracked."),
          b3:B("Safety envelope","Safety is procedural: containment classes, termination bands, and incident logs are mandatory and auditable.","Containment class declared.","Termination bands enforced.","Incident logs immutable.","No overrides without logging."),
          b4:B("Scaling posture","Scaling is constrained by evidence tier and deployment posture; it cannot outrun validation.","Deployment tier bounded.","No scaling without validation.","No cross-epoch mixing.","No silent drift.")
        },
        informal:{title:"INDUSTRIAL (C) · Live (Plain)",
          b1:B("Status","Industrial only. Public claims stay capped here.","C only.","Gated research separate.","Stop rules active.","No drift."),
          b2:B("What we track","Efficiency and stability, not hype.","Efficiency.","Aux loads.","Variance.","Uptime."),
          b3:B("Safety","Safety is logged and enforced.","Containment.","Termination.","Logs.","No silent overrides."),
          b4:B("Scaling","We scale only when proof supports it.","Proof first.","Then scale.","No leapfrogs.","No drift.")
        }
      },
      post:{
        formal:{title:"INDUSTRIAL (C) · Roadmap",
          b1:B("Roadmap meaning","Roadmap is not a promise. It lists gated requirements to scale industrial deployments safely.","No timelines claimed.","Requirements only.","Evidence gating.","Stop rules."),
          b2:B("Industrial scale path","Scale is IDP-like: pilot → cluster → industrial adjacency. Each step requires receipts and independent review where applicable.","Pilot receipts required.","Cluster receipts required.","Industrial adjacency receipts required.","Insurance review."),
          b3:B("Agricultural co-location","Co-location is thermal exchange only. No direct plasma–soil interface. Boundaries are auditable.","Setback rules.","Thermal exchangers only.","Compliance artifacts.","Audit-ready logs."),
          b4:B("What does NOT change","Public claim tier stays Industrial unless validation upgrades are actually achieved. Governance prevents narrative drift.","Claim tier lock.","Telemetry lock.","Loss closure lock.","No drift.")
        },
        informal:{title:"INDUSTRIAL (C) · Roadmap (Plain)",
          b1:B("Roadmap","Roadmap means gated steps, not promises.","No promises.","Requirements.","Proof.","Stop rules."),
          b2:B("Scale steps","Pilot → cluster → industry.","Pilot.","Cluster.","Industry.","Proof each step."),
          b3:B("Farm use","Heat exchange only with boundaries.","Setbacks.","Exchangers.","Compliance.","Logs."),
          b4:B("No drift","Claims won’t inflate.","Locked tier.","Locked proof.","Locked logs.","Locked stop rules.")
        }
      }
    },

    validation:{
      origin:{
        formal:{title:"VALIDATION · Fulcrum (Concept)",
          b1:B("GEEP Axiom (Immutable)","Validation is the fulcrum: it governs what is admissible and what cannot be claimed. This platform escalates only when receipts satisfy gain>loss within confinement bounds.",GEEP_AXIOM_EN,"Public claim tier stays C until admissible.","No certificate → no escalation.","Failure triggers freeze + rollback."),
          b2:B("DHY strict integrity","DHY enforces semantic locks (ABM/BM/WRM), hash chains, and strict certificates. Any drift or mutation invalidates windows and requires epoch rollover.","ABM/BM/WRM locked.","SHA-256 hash chain.","S1/S2/S3 certificates.","R3 recovery: new epoch."),
          b3:B("Loss closure doctrine","Loss channels must sum to 100% ± uncertainty. If closure fails, claims freeze. Loss closure prevents hidden loss laundering.","Ion + electron + grid + radiative + charge exchange.","Sum to 100% ± bounds.","If mismatch → freeze.","No selective reporting."),
          b4:B("TV overlay (read-only)","TV is a descriptive scalar only. It is NOT MEASURED unless both numerator and denominator are admissible receipts. TV cannot elevate tier.",TV_DEF_EN,"TV status: NOT MEASURED (default).","Displayed here only (Formal).","Read-only; no interpretation.")
        },
        informal:{title:"VALIDATION · Fulcrum (Plain)",
          b1:B("The rule","Validation decides what we’re allowed to say. If it isn’t proven, it isn’t claimed.","Proof first.","No drift.","No hype.","Stop rules."),
          b2:B("Integrity","DHY makes tampering obvious.","Locked manifests.","Hash chains.","Strict certs.","Epoch rollovers."),
          b3:B("Loss closure","Loss must add up. If it doesn’t, we stop.","Loss must sum.","Bounds enforced.","No guessing.","Freeze on mismatch."),
          b4:B("TV","TV is just distance. If it’s not admissible, it stays NOT MEASURED.",TV_DEF_EN,"Read-only.","Formal-only here.","Never upgrades claims.")
        }
      },
      now:{
        formal:{title:"VALIDATION · Fulcrum (Live)",
          b1:B("Current claim tier","Public claim tier is Industrial (C). Any research artifacts are gated and cannot change the public tier without strict admissibility.","CLAIM TIER: C (locked).","Research: gated.","No gain claims.","Stop rules active."),
          b2:B("Certificates (placeholder)","Until DHY→GEEP resolver wiring is live, certificate status is displayed as placeholder. The rule remains: no cert → no escalation.","CERT: NOT WIRED (placeholder).","Rule: no cert → no escalation.","Strict mode assumed.","No degraded states."),
          b3:B("Stop rules","If Q is not greater than 1 (or not measured), escalation is prohibited. Independent audit is required for any A-level claim.","Q gate enforced.","Facility ratio gate enforced.","Disproof criteria required.","Audit required."),
          b4:B("TV (Formal-only)","TV remains NOT MEASURED unless admissible receipts exist for nTτ_current and nTτ_required. It is display-only.",TV_DEF_EN,"TV: NOT MEASURED.","No inference.","No interpretation.")
        },
        informal:{title:"VALIDATION · Live (Plain)",
          b1:B("Tier","Public claim tier stays Industrial.","C only.","Gated research separate.","No gain claims.","Stop rules."),
          b2:B("Certs","No certificate means no escalation.","No cert.","No escalation.","Strict.","Binary."),
          b3:B("Stop rules","If Q isn’t >1, we don’t upgrade.","No Q>1 → no upgrade.","Audit required.","Disproof required.","Freeze."),
          b4:B("TV","TV stays NOT MEASURED unless receipts exist.","NOT MEASURED by default.","Read-only.","Formal-only.","No upgrade.")
        }
      },
      post:{
        formal:{title:"VALIDATION · Roadmap (Audit Backbone)",
          b1:B("DHY→GEEP bridge","Roadmap includes wiring DHY certificates into GEEP state (256 embedding) so UI becomes enforcement-driven, not narrative-driven.","Resolver consumes certs.","State encoded (0–255).","Axis2 integrity drives ceilings.","No cross-epoch mixing."),
          b2:B("Independent audit posture","Any escalation beyond Industrial requires independent audit. Audit is a receipt, not an opinion.","Audit is mandatory.","Audit is external.","Audit is logged.","Audit gates tier."),
          b3:B("Publication discipline","Publish templates and manifests so external parties can replay the integrity chain without receiving proprietary internals.","Manifests published.","Replay scripts published.","Receipts hash-sealed.","No secret upgrades."),
          b4:B("TV policy","TV remains descriptive; it is never used as a claim. It is computed only when admissible receipts exist.",TV_DEF_EN,"TV never upgrades tier.","TV requires receipts.","TV shown in Formal only.","No interpretation.")
        },
        informal:{title:"VALIDATION · Roadmap (Plain)",
          b1:B("Bridge","Wire certificates into the UI so it enforces truth automatically.","Certs into UI.","State encoding.","No drift.","Strict."),
          b2:B("Audit","External audit is required to upgrade claims.","Audit required.","Logged.","Receipts.","Gated."),
          b3:B("Publish","Publish templates so others can verify.","Templates.","Manifests.","Replay.","Receipts."),
          b4:B("TV","TV is descriptive only.","No claim.","Receipts required.","Formal-only.","No upgrade.")
        }
      }
    },

    physics:{
      origin:{
        formal:{title:"PHYSICS · Mechanisms (GATED)",
          b1:B("Confinement authority (magnetic)","This surface describes confinement/stability mechanisms as bounded research context. It is labeled GATED and carries NO gain claim.","GATED / NO GAIN CLAIM.","τ and stability are measured domains.","β/stability envelope is bounded.","No readiness language."),
          b2:B("Injection authority (electrostatic)","Injection/shaping remains separate from confinement authority. It cannot be conflated with τ scaling or gain.","Injection ≠ confinement.","Edge control ≠ gain.","Phase-space shaping only.","Bounded by validation."),
          b3:B("Orchestration (HEL-X)","HEL-X is execution control: scheduling, rollback, regime sequencing. It improves coordination, not physics claim tier.","Coordination only.","Rollback authority.","No physics inflation.","Bounded by validation."),
          b4:B("Ceiling acknowledgement","If a topology is saturated, voltage/density pushing is prohibited until redesign is justified by receipts. This prevents false progression.","Ceiling must be documented.","No brute-force scaling.","Loss dominance must be closed.","Topology shift requires receipts.")
        },
        informal:{title:"PHYSICS · Mechanisms (Plain, GATED)",
          b1:B("Gated","This section is research context only.","GATED.","No gain claims.","Bounded language.","Stop rules apply."),
          b2:B("Separate roles","Injection and confinement are different jobs.","Injection ≠ confinement.","Don’t mix.","No shortcuts.","Bounded."),
          b3:B("HEL-X","HEL-X is scheduling and rollback.","Control only.","No claim lift.","Logged.","Bounded."),
          b4:B("Ceiling","If it plateaus, stop pushing and redesign.","No pushing.","Close losses.","Redesign.","Measure.")
        }
      },
      now:{
        formal:{title:"PHYSICS · Mechanisms (Live, GATED)",
          b1:B("Live posture","Live posture remains research-only: measured domains are referenced but do not upgrade claims. Industrial tier stays C.","Research-only view.","No claim uplift.","Receipts govern display.","Industrial remains C."),
          b2:B("Measured domains","Measured τ, n, T, and loss channels are inputs to validation; they are not claims. Where receipts exist, they remain bounded.","Receipts only.","No inference.","No projection.","No timeline."),
          b3:B("Stability envelope","Stability is documented as envelope constraints and kill conditions, not as readiness statements.","Envelope constraints.","Kill conditions.","Rollback triggers.","No readiness language."),
          b4:B("Topology shift gate","Topology redesign is permitted only after loss dominance and integrity locks are satisfied. Otherwise freeze.","Loss closure first.","Integrity first.","Then redesign.","No shortcuts.")
        },
        informal:{title:"PHYSICS · Live (Plain, GATED)",
          b1:B("Status","Research-only. Industrial stays C.","GATED.","Industrial C.","No upgrades.","No hype."),
          b2:B("Measurements","Measurements are inputs, not claims.","Inputs only.","Receipts.","No inference.","No timeline."),
          b3:B("Stability","Stability is about boundaries.","Boundaries.","Kills.","Rollback.","Logs."),
          b4:B("Redesign gate","Redesign only when validation says yes.","Loss closure.","Integrity.","Then redesign.","Otherwise freeze.")
        }
      },
      post:{
        formal:{title:"PHYSICS · Roadmap (Requirements, GATED)",
          b1:B("What roadmap means","Roadmap lists falsifiable requirements and stop conditions only. It does not promise outcomes.","Requirements only.","Stop conditions.","Receipts required.","No promises."),
          b2:B("Confinement improvement criteria","Progressing confinement status requires ≥10× measured τ improvement AND loss redistribution receipts. Otherwise status remains limited.","τ ≥10× required.","Loss redistribution required.","Repeatability required.","No cherry-picking."),
          b3:B("Measurement upgrades","Any physics roadmap item must specify measurement upgrades first, not parameter escalation.","Instrumentation first.","Calibration first.","Integrity first.","Then experiments."),
          b4:B("Termination clause","If repeated architectural iterations fail to change scaling behavior, freeze and pivot; do not inflate narrative.","Freeze on non-scaling.","Pivot if needed.","Publish failures.","Maintain C posture.")
        },
        informal:{title:"PHYSICS · Roadmap (Plain, GATED)",
          b1:B("Roadmap","Roadmap means requirements, not promises.","Requirements.","Stops.","Receipts.","No hype."),
          b2:B("Progress rule","No τ scaling → no progress claim.","Need ≥10× τ.","Need receipts.","Need repeat.","No cherry-pick."),
          b3:B("Upgrades first","Measure better before pushing harder.","Instrumentation.","Calibration.","Integrity.","Then experiments."),
          b4:B("Terminate cleanly","If it won’t scale, stop pretending.","Freeze.","Pivot.","Document.","Stay C.")
        }
      }
    },

    governance:{
      origin:{
        formal:{title:"GOVERNANCE · Locks (Concept)",
          b1:B("Tier locks","Governance enforces claim tiers and prevents escalation beyond evidence. Capital and regulatory posture cannot outrun validation.","Tier lock enforced.","Capital ≤ evidence tier.","Reg posture ≤ evidence tier.","No drift."),
          b2:B("Separation firewall","Industrial and research are separate lanes. Research cannot justify industrial marketing. Industrial revenue may fund research.","No mixed claims.","Separate disclosures.","Separate budgets.","Separate artifacts."),
          b3:B("R3 recovery","Any invalidation triggers new epoch. No healing inside contaminated epoch. No cross-epoch aggregation.","Epoch discipline.","SEGMENT_BREAK required.","No cross-epoch mixing.","Historical invalid stays invalid."),
          b4:B("Enforcement posture","Governance is enforcement only: it does not make physics claims. It defines what is allowed and what is prohibited.","No physics claims here.","Enforcement only.","Stop rules.","Escalation law.")
        },
        informal:{title:"GOVERNANCE · Locks (Plain)",
          b1:B("Locks","Governance prevents claim inflation.","Locks claims.","Locks capital.","Locks regulation.","No drift."),
          b2:B("Firewall","Industrial and research stay separate.","No mixed claims.","Separate budgets.","Separate docs.","Separate lanes."),
          b3:B("Recovery","Failures create new epochs.","No healing.","No mixing.","SEGMENT_BREAK.","Permanent history."),
          b4:B("Enforcement","Governance enforces; it doesn’t brag.","Enforce rules.","Stop rules.","Escalation law.","No hype.")
        }
      },
      now:{
        formal:{title:"GOVERNANCE · Locks (Live)",
          b1:B("Current tier posture","Public tier remains C. Research is gated. Any upgrade requires validation receipts and independent audit.","C only.","Research gated.","Upgrade requires receipts.","Audit required."),
          b2:B("Capital posture","Capital must remain compatible with evidence tier. No speculative leverage beyond validated class.","Capital ≤ evidence.","No speculative tier leaps.","Insurance compatibility.","Reg compliance."),
          b3:B("Disclosure posture","Disclosure language must remain bounded. Prohibited terms are forbidden across all surfaces.","No net-positive.","No readiness claims.","No Lawson implication.","No Q>1 implication."),
          b4:B("Telemetry posture","DHY strict posture governs admissibility. If certs invalid, freeze. If partial, remain locked.","Cert invalid → freeze.","Partial → no escalation.","Valid → still C unless Q>1.","Audited required for any upgrade.")
        },
        informal:{title:"GOVERNANCE · Live (Plain)",
          b1:B("Tier","Public tier stays C.","C only.","Gated research.","Receipts required.","Audit required."),
          b2:B("Capital","Capital follows proof.","No leverage beyond proof.","Insurance posture.","Compliance.","Gated."),
          b3:B("Language","No drift words allowed.","No net-positive.","No readiness.","No Lawson.","No Q>1."),
          b4:B("Telemetry","Strict certs decide.","Invalid freezes.","Partial locks.","Valid still bounded.","Audit for upgrade.")
        }
      },
      post:{
        formal:{title:"GOVERNANCE · Roadmap (Institutionalization)",
          b1:B("Institutional packaging","Roadmap is institutional packaging of governance: publish the charter, the locks, and the enforcement model as a standard.","Publish charter.","Publish locks.","Publish manifests.","Publish replay paths."),
          b2:B("Policy alignment","Align with existing safety and compliance regimes. Avoid creating conflict with incumbents; position as stabilizing layer.","Coexistence posture.","Compliance first.","Insurance friendly.","No disruption narrative."),
          b3:B("Scaling ramp mapping","Scaling must follow research→prototype→reactor→fleet gates (requirements-only). No leapfrogging.","Gate sequence locked.","Requirements-only.","No promises.","Stop rules."),
          b4:B("Termination discipline","If a path fails, publish failure and remain industrial. Governance prevents sunk-cost narrative drift.","Publish failures.","Freeze paths.","Remain C.","Protect credibility.")
        },
        informal:{title:"GOVERNANCE · Roadmap (Plain)",
          b1:B("Package","Publish the rules and locks.","Charter.","Manifests.","Replay.","Locks."),
          b2:B("Align","Be compliant and cooperative.","Compliance.","Insurance.","Coexist.","No disruption talk."),
          b3:B("Ramp","Follow gates only.","Research→prototype→reactor→fleet.","No leaps.","Requirements.","Stops."),
          b4:B("Terminate cleanly","If it won’t scale, document and stay industrial.","Document.","Freeze.","Stay C.","No drift.")
        }
      }
    }
  };

  // ZH mirrors EN for now (single-language render still holds)
  const ZH = { industrial:EN.industrial, validation:EN.validation, physics:EN.physics, governance:EN.governance };
  const CONTENT = (lang==="zh") ? ZH : EN;

  const FALLBACK = {
    title:(lang==="zh")?"缺少内容":"Missing content",
    b1:{h:(lang==="zh")?"提示":"Notice",p:(lang==="zh")?"该视图内容尚未填充。":"This view is not populated yet.",u:["OK","OK","OK","OK"]},
    b2:{h:(lang==="zh")?"原因":"Cause",p:(lang==="zh")?"内容键缺失。":"A content key is missing.",u:["OK","OK","OK","OK"]},
    b3:{h:(lang==="zh")?"动作":"Action",p:(lang==="zh")?"模态会打开；稍后补充内容。":"Modal opens; fill content later.",u:["OK","OK","OK","OK"]},
    b4:{h:(lang==="zh")?"规则":"Rule",p:(lang==="zh")?"不允许静默失败。":"No silent failures allowed.",u:["OK","OK","OK","OK"]}
  };

  let activeKey=null;
  let openIdx=1;

  function setOpen(idx){
    openIdx=idx;
    [c1,c2,c3,c4].forEach((el,i)=>el.classList.toggle("open",(i+1)===openIdx));
  }

  function render(){
    persist(); setLinks(); setLensLabels();
    if(!activeKey) return;
    const view = ((((CONTENT[activeKey]||{})[time]||{})[style]) || FALLBACK);

    mTitle.textContent = view.title || FALLBACK.title;

    fillBox(h1,p1,u1,m1,view.b1||FALLBACK.b1);
    fillBox(h2,p2,u2,m2,view.b2||FALLBACK.b2);
    fillBox(h3,p3,u3,m3,view.b3||FALLBACK.b3);
    fillBox(h4,p4,u4,m4,view.b4||FALLBACK.b4);

    // TV visibility rule: only Validation + Formal (enforced by content placement, plus a guard here)
    // If not validation OR not formal, ensure the TV definitional line is not accidentally shown by content.
    if(activeKey !== "validation" || style !== "formal"){
      // no-op: content already avoids TV outside validation formal
      // (kept as explicit policy statement)
    }

    setOpen(openIdx);
  }

  function openModal(key){
    activeKey=key;
    bd.classList.add("show");
    modal.classList.add("show");
    openIdx=1;
    render();
  }

  function closeModal(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    activeKey=null;
  }

  window.__openEnergy=function(key){ openModal(key); };

  // Lens buttons
  styleChip.addEventListener("click", ()=>{ style=(style==="formal")?"informal":"formal"; render(); });
  chipConcept.addEventListener("click", ()=>{ time="origin"; render(); });
  chipLive.addEventListener("click", ()=>{ time="now"; render(); });
  chipRoadmap.addEventListener("click", ()=>{ time="post"; render(); });

  // Close buttons
  bd.addEventListener("click", closeModal);
  mClose.addEventListener("click", closeModal);
  document.getElementById("mReturn").addEventListener("click", closeModal);

  // Category bubble clicks
  function bindBubble(el,idx){
    el.addEventListener("click", ()=>{ setOpen(idx); });
    el.addEventListener("keydown",(e)=>{ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); setOpen(idx);} });
  }
  bindBubble(c1,1); bindBubble(c2,2); bindBubble(c3,3); bindBubble(c4,4);

  // Keyboard for diamonds
  [["dValidation","validation"],["dIndustrial","industrial"],["dPhysics","physics"],["dGovernance","governance"]].forEach(pair=>{
    document.getElementById(pair[0]).addEventListener("keydown",(e)=>{
      if(e.key==="Enter"||e.key===" "){ e.preventDefault(); window.__openEnergy(pair[1]); }
    });
  });

  setLensLabels();
})();
</script>

</body>
</html>
