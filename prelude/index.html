<!-- TNT — /prelude/index.html
     PRELUDE · TABLE SETTING (TRILINGUAL · NO LENSES · MONUMENT DENSITY · SINGLE-OPEN)
     PURPOSE:
       - Existential first question
       - Frame the problem in common human language (not “claim/support” jargon)
       - Introduce ladder (Head → System → Scale) without technical overwhelm
       - Dense but legible
     RULES:
       - EN / 中文 / ES
       - No lenses on this page
       - Single-open accordion
       - Large, readable typography
       - No modals / no overlays
       - Canon state carry (lang/style/time/depth)
       - Uses ui.css + branch.css + instruments.js only
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PRELUDE</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
body::before,body::after{pointer-events:none!important}
#root{position:relative;z-index:10}

:root{
  --dockH:92px;

  --opalA:rgba(210,190,255,.16);
  --opalB:rgba(120,70,255,.12);
  --opalC:rgba(255,80,80,.10);

  --goldSoft:rgba(212,175,55,.35);
  --stroke:rgba(255,255,255,.12);

  --txt:rgba(255,255,255,.92);
  --mut:rgba(255,255,255,.82);
}

/* TOP */
.top{
  position:fixed;top:16px;left:0;right:0;
  padding:0 16px;
  display:flex;justify-content:space-between;gap:12px;
  z-index:240;pointer-events:none;
}
.top .left,.top .right{
  display:flex;gap:10px;white-space:nowrap;
  pointer-events:auto;
}

/* PAGE */
.page{
  width:min(1100px,94vw);
  margin:0 auto;
  padding:86px 0 calc(var(--dockH) + 18px);
  display:flex;flex-direction:column;gap:14px;
}

/* HERO */
.hero{
  border-radius:28px;
  border:1px solid var(--stroke);
  background:
    radial-gradient(circle at 18% 26%, var(--opalA), transparent 70%),
    radial-gradient(circle at 82% 34%, var(--opalB), transparent 72%),
    radial-gradient(circle at 55% 110%, var(--opalC), transparent 62%),
    linear-gradient(160deg, rgba(0,0,0,.30), rgba(0,0,0,.14));
  backdrop-filter:blur(12px);
  box-shadow:0 34px 120px rgba(0,0,0,.55);
  padding:22px 22px 20px;
}
.k{margin:0 0 8px;font-size:12px;letter-spacing:4px;text-transform:uppercase;opacity:.78}
.h1{
  margin:0;
  font-weight:950;
  font-size:42px;
  letter-spacing:1px;
  line-height:1.08;
}
.tag{
  margin:14px 0 0;
  font-size:18px;
  line-height:1.6;
  color:var(--txt);
  max-width:980px;
}

/* ACCORDION */
.stack{display:flex;flex-direction:column;gap:14px}

.card{
  border:1px solid rgba(255,255,255,.10);
  border-radius:24px;
  background:
    radial-gradient(circle at 22% 18%, rgba(255,255,255,.10), transparent 58%),
    linear-gradient(145deg, rgba(17,22,28,.86), rgba(11,15,20,.92));
  box-shadow:0 20px 70px rgba(0,0,0,.60);
  overflow:hidden;
}
.head{
  display:flex;justify-content:space-between;align-items:flex-start;
  padding:18px 20px;cursor:pointer;
}
.q{
  font-weight:950;
  font-size:20px;
  line-height:1.4;
}
.chev{font-size:18px;opacity:.7}
.body{
  display:none;
  padding:18px 20px 22px;
  border-top:1px solid rgba(255,255,255,.08);
}
.card.open .body{display:block}
.p{
  margin:0;
  font-size:16px;
  line-height:1.7;
  color:var(--mut);
}
.p + .p{margin-top:14px}

.actions{
  margin-top:18px;
  display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end;
}
.actions .btn{padding:12px 16px;border-radius:999px}

.dock{
  position:fixed;left:50%;
  bottom:max(10px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  width:min(980px,94vw);
  padding:12px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  backdrop-filter:blur(10px);
  display:grid;
  grid-template-columns:repeat(3,minmax(0,1fr));
  gap:10px;
}
.dock .btn{width:100%;padding:12px;border-radius:999px}

@media (max-width:520px){
  .h1{font-size:36px}
  .p{font-size:15px}
}
</style>
</head>

<body>
<div id="root">

  <div class="top">
    <div class="left">
      <a class="btn" id="btnHome" href="/home/">HOME</a>
      <a class="btn" id="btnIndex" href="/index.html">INDEX</a>
    </div>
    <div class="right">
      <button class="btn" id="btnEN">EN</button>
      <button class="btn" id="btnZH">中文</button>
      <button class="btn" id="btnES">ES</button>
    </div>
  </div>

  <div class="page">

    <section class="hero">
      <p class="k" id="k0">PRELUDE</p>
      <h1 class="h1" id="h0"></h1>
      <p class="tag" id="tag0"></p>
    </section>

    <div class="stack" id="stack"></div>

  </div>

  <nav class="dock">
    <a class="btn" id="dockDoor" href="/door/">DOOR</a>
    <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
    <a class="btn" id="dockExplore" href="/explore/">EXPLORE</a>
  </nav>

</div>

<script>
(function(){
  var qs=new URLSearchParams(location.search);
  var lang=qs.get("lang")||localStorage.getItem("gd_lang")||"en";
  if(lang!=="en"&&lang!=="zh"&&lang!=="es")lang="en";
  try{localStorage.setItem("gd_lang",lang);}catch(e){}

  function q(){return "?lang="+encodeURIComponent(lang);}

  document.getElementById("btnHome").href="/home/"+q();
  document.getElementById("btnIndex").href="/index.html"+q();
  document.getElementById("dockDoor").href="/door/"+q();
  document.getElementById("dockProducts").href="/products/"+q();
  document.getElementById("dockExplore").href="/explore/"+q();

  document.getElementById("btnEN").onclick=function(){location.search="?lang=en";}
  document.getElementById("btnZH").onclick=function(){location.search="?lang=zh";}
  document.getElementById("btnES").onclick=function(){location.search="?lang=es";}

  function P(en,zh,es){return{en:en,zh:zh,es:es};}
  function pick(o){return(lang==="zh")?o.zh:(lang==="es")?o.es:o.en;}

  var HERO={
    h:P(
      "What if most systems fail not because they are evil, but because they are misaligned?",
      "如果大多数系统失败，不是因为邪恶，而是因为错位呢？",
      "¿Y si la mayoría de los sistemas fallan no por maldad, sino por desalineación?"
    ),
    t:P(
      "Not confusion. Not chaos. A quiet mismatch between what is said, what is built, and what is measured.",
      "不是混乱，不是失控，而是言语、构建与测量之间的安静错位。",
      "No caos. No confusión. Un desajuste silencioso entre lo que se dice, lo que se construye y lo que se mide."
    )
  };

  document.getElementById("h0").textContent=pick(HERO.h);
  document.getElementById("tag0").textContent=pick(HERO.t);

  var SECTIONS=[
    {
      q:P(
        "Have you ever felt that something was ‘off’ but couldn’t explain why?",
        "你是否感觉某件事“不对劲”，却说不清原因？",
        "¿Alguna vez sentiste que algo estaba ‘mal’ pero no sabías explicar por qué?"
      ),
      p:P(
        "That feeling is not mystical. It is structural. When words drift from behavior, when metrics drift from reality, and when incentives drift from consequences, tension builds.\n\nMost organizations call this ‘culture issues’ or ‘market volatility.’ We call it misalignment.",
        "那种感觉并不神秘，而是结构性的。当语言与行为分离、指标与现实分离、激励与后果分离，张力就会累积。\n\n多数组织称之为“文化问题”或“市场波动”。我们称之为错位。",
        "Esa sensación no es mística, es estructural. Cuando las palabras se separan del comportamiento, cuando las métricas se separan de la realidad y los incentivos de las consecuencias, la tensión crece.\n\nMuchos lo llaman ‘problemas culturales’ o ‘volatilidad.’ Nosotros lo llamamos desalineación."
      )
    },
    {
      q:P(
        "What if misalignment could be mapped?",
        "如果错位可以被绘制成图呢？",
        "¿Y si la desalineación pudiera mapearse?"
      ),
      p:P(
        "Not guessed. Not narrated. Mapped.\n\nFinite surfaces. Clear gates. Measurable boundaries.\n\nWhen you can map the mismatch, you can reduce it. When you reduce it, you reduce cascade.",
        "不是猜测，不是叙事，而是绘制。\n\n有限面，清晰闸门，可测边界。\n\n当你能画出错位，你就能削减它；当你削减它，连锁反应也随之下降。",
        "No adivinar. No narrar. Mapear.\n\nSuperficies finitas. Comp puertas claras. Límites medibles.\n\nCuando mapeas el desajuste, puedes reducirlo. Al reducirlo, reduces cascadas."
      )
    },
    {
      q:P(
        "Why does this matter now?",
        "为什么现在更重要？",
        "¿Por qué importa ahora?"
      ),
      p:P(
        "Because scale amplifies everything.\n\nA small mismatch at low volume is a nuisance. At global scale, it becomes systemic risk.\n\nAlignment is not moral language. It is survival geometry.",
        "因为规模会放大一切。\n\n低体量下的小错位只是麻烦；在全球规模下，它变成系统性风险。\n\n对齐不是道德语言，而是生存几何。",
        "Porque la escala amplifica todo.\n\nUn pequeño desajuste es molestia; a escala global se vuelve riesgo sistémico.\n\nLa alineación no es moral; es geometría de supervivencia."
      )
    }
  ];

  var stack=document.getElementById("stack");

  function closeAll(){
    stack.querySelectorAll(".card").forEach(function(c){
      c.classList.remove("open");
      var ch=c.querySelector(".chev");
      if(ch)ch.textContent="▸";
    });
  }

  SECTIONS.forEach(function(sec,i){
    var card=document.createElement("div");
    card.className="card";

    var head=document.createElement("div");
    head.className="head";
    var q=document.createElement("div");
    q.className="q";
    q.textContent=pick(sec.q);
    var chev=document.createElement("div");
    chev.className="chev";
    chev.textContent="▸";
    head.appendChild(q);
    head.appendChild(chev);

    var body=document.createElement("div");
    body.className="body";

    pick(sec.p).split("\n\n").forEach(function(t){
      var p=document.createElement("p");
      p.className="p";
      p.textContent=t;
      body.appendChild(p);
    });

    var actions=document.createElement("div");
    actions.className="actions";
    var btn=document.createElement("a");
    btn.className="btn";
    btn.textContent=(lang==="zh")?"继续":"CONTINUE";
    btn.href="/door/"+q();
    actions.appendChild(btn);
    body.appendChild(actions);

    head.onclick=function(){
      var open=!card.classList.contains("open");
      closeAll();
      if(open){
        card.classList.add("open");
        chev.textContent="▾";
      }
    };

    card.appendChild(head);
    card.appendChild(body);
    stack.appendChild(card);

    if(i===0){
      card.classList.add("open");
      chev.textContent="▾";
    }
  });

})();
</script>

</body>
</html>
