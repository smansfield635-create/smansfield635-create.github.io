<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Control Room · Geodiametrics</title>

<style>
:root{
  --fg:#e9eefc;--muted:rgba(233,238,252,.62);
  --stroke:rgba(233,238,252,.14);
  --panel:rgba(12,16,34,.62);
  --radius:22px;
  --green:#4ade80;--yellow:#facc15;--red:#f87171;--blue:#60a5fa;--grey:#9ca3af;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:var(--fg);
  background:
    radial-gradient(1400px 1000px at 20% 12%, rgba(122,162,255,.22), transparent 60%),
    radial-gradient(1000px 800px at 85% 30%, rgba(180,140,255,.18), transparent 60%),
    linear-gradient(180deg,#060a18,#040610 70%,#03030c);
}
.wrap{max-width:1200px;margin:0 auto;padding:22px 16px 80px}
.card{border-radius:var(--radius);border:1px solid var(--stroke);background:var(--panel);padding:18px;margin-bottom:16px}
h1{margin:0 0 8px;font-size:40px}
h2{margin:0 0 10px;font-size:22px}
p{margin:0 0 10px;color:var(--muted);line-height:1.55}
.row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
.small{font-size:13px;color:var(--muted)}
.mono{font-family:ui-monospace,Menlo,Consolas,monospace}
.hr{height:1px;background:rgba(233,238,252,.10);margin:14px 0}

.gauges{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px}
.gauge{border-radius:18px;border:1px solid rgba(233,238,252,.14);background:rgba(0,0,0,.22);padding:14px}
.gauge h3{margin:0 0 8px;font-size:12px;letter-spacing:.7px;text-transform:uppercase}
.meter{height:14px;background:rgba(255,255,255,.12);border-radius:8px;overflow:hidden}
.fill{height:100%;width:0%;transition:width .35s ease}
.badge{display:inline-flex;align-items:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid rgba(233,238,252,.16);background:rgba(255,255,255,.06);font-weight:900;font-size:12px;letter-spacing:.6px;text-transform:uppercase}
.light{width:12px;height:12px;border-radius:50%;display:inline-block;background:var(--grey)}
.table{width:100%;border-collapse:collapse;margin-top:10px;font-size:13px}
th,td{padding:8px;border-bottom:1px solid rgba(233,238,252,.12);text-align:left;color:var(--muted)}
th{color:#fff;font-weight:900}
textarea{width:100%;min-height:140px;background:rgba(0,0,0,.35);color:var(--fg);border:1px solid var(--stroke);border-radius:12px;padding:10px}
button{appearance:none;border:1px solid rgba(233,238,252,.18);background:rgba(255,255,255,.06);color:var(--fg);padding:10px 14px;border-radius:999px;font-weight:900;cursor:pointer}
.footer{text-align:center;color:rgba(233,238,252,.55);font-size:13px;margin-top:18px}
</style>
</head>

<body>
<div class="wrap">

  <div class="card">
    <h1>Control Room</h1>
    <p><b>Source:</b> OSF (Project <a href="https://osf.io/mn6vu" target="_blank" rel="noreferrer">mn6vu</a>) · <b>Window:</b> 60 minutes · Read-only.</p>
    <div class="row">
      <span class="badge"><span id="sysLight" class="light"></span><span id="sysState">STANDBY</span></span>
      <span class="mono small">Last OSF sample: <span id="lastSample">—</span></span>
    </div>
  </div>

  <div class="card">
    <h2>System Gauges</h2>
    <div class="gauges">
      <div class="gauge">
        <h3>Fuel (Coherence)</h3>
        <div class="meter"><div id="fuel" class="fill" style="background:var(--green)"></div></div>
        <div class="small">Sustained agreement under constraint (OSF engagement stability).</div>
      </div>
      <div class="gauge">
        <h3>RPM (Activity)</h3>
        <div class="meter"><div id="rpm" class="fill" style="background:var(--blue)"></div></div>
        <div class="small">OSF views+downloads per hour.</div>
      </div>
      <div class="gauge">
        <h3>Speed (Momentum)</h3>
        <div class="meter"><div id="speed" class="fill" style="background:var(--green)"></div></div>
        <div class="small">Δ(RPM) across hours.</div>
      </div>
      <div class="gauge">
        <h3>Risk (Instability)</h3>
        <div class="meter"><div id="risk" class="fill" style="background:var(--red)"></div></div>
        <div class="small">Drop-offs, volatility, curiosity without commitment.</div>
      </div>
    </div>
  </div>

  <div class="card">
    <h2>OSF Snapshot (Manual · Honest)</h2>
    <p>Paste a 60-minute OSF snapshot here. Gauges wake only from this data.</p>
    <textarea id="jsonInput" class="mono" placeholder='{
  "timestamp":"2026-02-02T22:00:00Z",
  "views_60m": 42,
  "downloads_60m": 7
}'></textarea>
    <div class="row" style="margin-top:10px;">
      <button onclick="applySnapshot()">Apply Snapshot</button>
    </div>
    <p class="small">When you later provide a JSON endpoint, replace this manual input with a fetch.</p>
  </div>

  <div class="card">
    <h2>Live Readout (last 60m)</h2>
    <table class="table">
      <thead><tr><th>Views</th><th>Downloads</th><th>Acceptance</th><th>RPM</th><th>Risk</th></tr></thead>
      <tbody><tr>
        <td id="v">—</td>
        <td id="d">—</td>
        <td id="a">—</td>
        <td id="r">—</td>
        <td id="k">—</td>
      </tr></tbody>
    </table>
  </div>

  <div class="footer">© 2026 Geodiametrics · Control Room</div>
</div>

<script>
/* ===============================
   OSF-ONLY GAUGES · 60-MIN WINDOW
   No synthetic pulse. No local life.
================================ */

let lastRPM = 0;

function setW(id, v){ document.getElementById(id).style.width = Math.max(0, Math.min(100, Math.round(v)))+"%"; }

function applySnapshot(){
  let data;
  try{
    data = JSON.parse(document.getElementById("jsonInput").value);
  }catch(e){
    alert("Invalid JSON");
    return;
  }

  const views = Number(data.views_60m||0);
  const downloads = Number(data.downloads_60m||0);

  // RPM normalized: 100 views/hour = full
  const rpm = Math.min(1, (views + downloads) / 100);
  const speed = Math.min(1, Math.max(0, (rpm - lastRPM) + 0.5));
  lastRPM = rpm;

  // Acceptance: downloads / interactions
  const acceptance = (views+downloads)>0 ? downloads/(views+downloads) : null;

  // Risk: curiosity without commitment + volatility proxy
  const risk = acceptance===null ? 0 : Math.min(1, (1-acceptance));

  // Fuel: full unless instability dominates
  const fuel = Math.max(0, 1 - (0.6*risk));

  setW("rpm", rpm*100);
  setW("speed", speed*100);
  setW("risk", risk*100);
  setW("fuel", fuel*100);

  document.getElementById("v").textContent = views;
  document.getElementById("d").textContent = downloads;
  document.getElementById("a").textContent = acceptance===null ? "—" : Math.round(acceptance*100)+"%";
  document.getElementById("r").textContent = Math.round(rpm*100)+"%";
  document.getElementById("k").textContent = Math.round(risk*100)+"%";
  document.getElementById("lastSample").textContent = data.timestamp || new Date().toISOString();

  const light = document.getElementById("sysLight");
  const state = document.getElementById("sysState");
  if((views+downloads)===0){
    light.style.background = "var(--grey)";
    state.textContent = "STANDBY";
  }else if(risk < 0.33){
    light.style.background = "var(--green)";
    state.textContent = "OPERATIONAL";
  }else if(risk < 0.66){
    light.style.background = "var(--yellow)";
    state.textContent = "CONTESTED";
  }else{
    light.style.background = "var(--red)";
    state.textContent = "FRAGMENTING";
  }
}
</script>
</body>
</html>
