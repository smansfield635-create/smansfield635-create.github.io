<!-- TNT — /home/index.html
     HUB A · 12 BUBBLES ONLY · 3 SUB-BUBBLES ONLY · PARAGRAPH ONLY AT LEVEL 2
     LOCKS:
       - Canon keys only: gd_lang / gd_style / gd_time
       - No language selector UI (gd_lang decides EN-only / 中文-only)
       - No mirror UI
       - No subtitles / no hint cards / no extra context above the hood
       - 12 directions are ONE LINE each (bubble)
       - Click direction => exactly 3 one-line bubbles (Concept/Live/Roadmap)
       - Click Concept/Live/Roadmap => show 1 paragraph (7–9 sentences)
       - Nothing else appears
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HUB · Index</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
a{color:inherit;text-decoration:none}
.wrap{width:min(980px,94vw);margin:0 auto;padding:16px 0 110px;display:flex;flex-direction:column;gap:12px}

/* Single-line bubble */
.bubble{
  --c:#93C5FD;
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  background:linear-gradient(145deg, rgba(12,22,38,.86), rgba(7,11,18,.92));
  box-shadow:0 12px 40px rgba(0,0,0,.55);
  overflow:hidden;
}
.bhead{
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  padding:12px 14px;cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.left{display:flex;align-items:center;gap:10px;min-width:0}
.diamond{
  width:12px;height:12px;transform:rotate(45deg);border-radius:4px;
  background:var(--c);
  box-shadow:0 0 0 1px rgba(255,255,255,.12), 0 0 14px rgba(0,0,0,.35);
  flex:0 0 auto;
  pointer-events:none;
}
.label{
  font-weight:950;letter-spacing:.2px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
}
.chev{opacity:.75;font-size:16px;flex:0 0 auto}

/* Level containers */
.body{display:none;padding:0 14px 12px;border-top:1px solid rgba(255,255,255,.08)}
.bubble.open .body{display:block}
.stack{display:flex;flex-direction:column;gap:10px;margin-top:12px}

/* Mode bubble (Concept/Live/Roadmap) */
.mode{
  border:1px solid rgba(255,255,255,.10);
  border-radius:16px;
  background:linear-gradient(145deg, rgba(17,22,28,.78), rgba(11,15,20,.86));
  box-shadow:0 10px 32px rgba(0,0,0,.45);
  overflow:hidden;
}
.mhead{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:11px 12px;cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.mlabel{font-weight:950;letter-spacing:.2px}
.mchev{opacity:.75;font-size:16px}
.mbody{display:none;padding:10px 12px 12px;border-top:1px solid rgba(255,255,255,.08)}
.mode.open .mbody{display:block}

/* Paragraph only appears at Level 2 */
.p{
  margin:0;
  color:rgba(255,255,255,.86);
  line-height:1.6;
  font-size:13px;
}

/* Dock */
.dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:120;
  width:min(980px,94vw);
  display:flex;justify-content:center;
  gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);
  backdrop-filter:blur(8px);
}
.btn{
  display:inline-flex;align-items:center;justify-content:center;
  padding:10px 14px;border-radius:14px;
  background:linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  color:#fff;border:1px solid rgba(255,255,255,.10);
  box-shadow:0 12px 30px rgba(0,0,0,.55);
  cursor:pointer;font-weight:900;letter-spacing:.2px;
  -webkit-tap-highlight-color:transparent;
}
</style>
</head>

<body>

<div class="wrap" id="list"></div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="dockHub" href="/home/">HUB</a>
  <a class="btn" id="dockExplore" href="/explore/">EXPLORE</a>
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<script>
(function(){
  // Canon keys only
  var qs = new URLSearchParams(location.search);
  var gd_lang  = qs.get("gd_lang")  || localStorage.getItem("gd_lang")  || "en";
  var gd_style = qs.get("gd_style") || localStorage.getItem("gd_style") || "informal";
  var gd_time  = qs.get("gd_time")  || localStorage.getItem("gd_time")  || "now";

  if(gd_lang!=="en" && gd_lang!=="zh") gd_lang="en";
  if(gd_style!=="formal" && gd_style!=="informal") gd_style="informal";
  if(gd_time==="trajectory") gd_time="post";
  if(gd_time!=="origin" && gd_time!=="now" && gd_time!=="post") gd_time="now";

  try{
    localStorage.setItem("gd_lang", gd_lang);
    localStorage.setItem("gd_style", gd_style);
    localStorage.setItem("gd_time", gd_time);
  }catch(e){}

  document.documentElement.lang = (gd_lang==="zh") ? "zh" : "en";

  function q(){
    var p=new URLSearchParams();
    p.set("gd_lang", gd_lang);
    p.set("gd_style", gd_style);
    p.set("gd_time", gd_time);
    return "?"+p.toString();
  }

  // Dock links preserve state
  document.getElementById("dockHub").href="/home/"+q();
  document.getElementById("dockExplore").href="/explore/"+q();
  document.getElementById("dockProducts").href="/products/"+q();
  document.getElementById("dockLaws").href="/laws/"+q();
  document.getElementById("dockGauges").href="/gauges/"+q();

  // 12-color ring
  var COLORS = {
    N:"#1F3A8A", NNE:"#2C3EAF", ENE:"#4B3FBF", E:"#0EA5E9",
    ESE:"#14B8A6", SSE:"#22C55E", S:"#F59E0B", SSW:"#EA580C",
    WSW:"#DC2626", W:"#7F1D1D", WNW:"#9333EA", NNW:"#334155"
  };

  var ORDER = ["N","NNE","ENE","E","ESE","SSE","S","SSW","WSW","W","WNW","NNW"];

  function T(en, zh){ return (gd_lang==="zh") ? zh : en; }

  // One-line labels only (no subtitles)
  var LABEL = {
    N:   T("N · DEFINITIONS","N · 定义"),
    NNE: T("NNE","NNE"),
    ENE: T("ENE","ENE"),
    E:   T("E · PRODUCTS","E · 产品"),
    ESE: T("ESE","ESE"),
    SSE: T("SSE","SSE"),
    S:   T("S · CONSTRAINTS","S · 约束"),
    SSW: T("SSW","SSW"),
    WSW: T("WSW","WSW"),
    W:   T("W · CONTAINMENT","W · 隔离"),
    WNW: T("WNW","WNW"),
    NNW: T("NNW","NNW")
  };

  // 7-sentence paragraphs (formal/informal swap by gd_style)
  function P7(a,b,c,d,e,f,g){ return [a,b,c,d,e,f,g].join(" "); }

  function copy(dir, mode){
    // mode: "concept" | "live" | "roadmap"
    // Keep it cardinal-heavy; product mention stays implicit (under the hood).
    if(gd_style==="formal"){
      if(mode==="concept") return P7(
        T("This direction defines a bounded structural role within the compass.", "该方向在罗盘中定义一个有界结构角色。"),
        T("Meaning is declared before any claim is admitted.", "含义先声明，主张才可采纳。"),
        T("Scope constrains interpretation and prevents drift.", "范围约束解释并防止漂移。"),
        T("The role anchors how verification must be performed.", "该角色锚定核查应如何执行。"),
        T("It keeps cross-domain mapping comparable under scale.", "它让跨域映射在规模下可比较。"),
        T("It enforces consistency across instances and pages.", "它在实例与页面间强制一致性。"),
        T("It is operational, not rhetorical.", "它是可执行结构，而非修辞。")
      );
      if(mode==="live") return P7(
        T("Disputes route into structure rather than persuasion.", "争议路由回结构而非说服。"),
        T("Receipts bind actions to evidence inside declared scope.", "收据在声明范围内把行动绑定证据。"),
        T("Gates prevent bypass during pressure and time scarcity.", "压力与时间稀缺时闸门阻止绕过。"),
        T("Returns keep traversal deterministic and non-tunnel.", "返回让遍历保持确定性且非隧道化。"),
        T("Containment limits local faults from becoming cascades.", "隔离限制局部故障演变为级联。"),
        T("Language remains consistent across surfaces.", "语言在各执行面保持一致。"),
        T("Integrity is maintained by enforcement, not intent.", "完整性靠执行维持，不靠意图。")
      );
      return P7(
        T("Expansion completes geometry instead of mutating it.", "扩张补全几何而非使其变形。"),
        T("New claims require boundaries and falsifiers.", "新主张必须带边界与证伪条件。"),
        T("New surfaces preserve contracts, gates, and returns.", "新执行面保持契约、闸门与返回。"),
        T("Corrections require explicit versioning.", "修正必须显式版本化。"),
        T("Scaling occurs by replication of proven structure.", "规模化通过复制已验证结构实现。"),
        T("Audit posture strengthens without revealing recipes.", "审计姿态增强但不泄露配方。"),
        T("The system remains admissible as it grows.", "系统在增长中保持可采信。")
      );
    } else {
      if(mode==="concept") return P7(
        T("This bubble is your role.", "这个气泡就是你的角色。"),
        T("If you don’t declare it, everything turns into opinion.", "不声明它，后面全变成观点。"),
        T("Scope makes the game real.", "范围让游戏真实。"),
        T("It stops words from wiggling under pressure.", "它让压力来时词不乱动。"),
        T("It keeps you anchored while you move fast.", "你走得快也不会漂。"),
        T("It makes the whole system readable.", "它让整个系统变得可读。"),
        T("That’s the point of the compass.", "这就是罗盘的意义。")
      );
      if(mode==="live") return P7(
        T("When it gets fuzzy, don’t argue—route.", "一模糊，别吵——直接跳转。"),
        T("Use gates so hype can’t sneak past.", "用闸门让噱头过不去。"),
        T("Keep receipts so reality can’t be rewritten.", "保留收据让现实不能改写。"),
        T("Keep returns so you never get trapped.", "保留返回不让你被困。"),
        T("Contain damage before it spreads.", "先隔离损伤别扩散。"),
        T("Stay consistent across pages.", "跨页面保持一致。"),
        T("That’s how you scale clean.", "这就是干净扩张。")
      );
      return P7(
        T("Grow without breaking the compass.", "长大但别崩罗盘。"),
        T("Add depth, not drift.", "加深，不加漂移。"),
        T("Clone what works.", "复制有效的。"),
        T("Make gates clearer as you scale.", "越大闸门越清晰。"),
        T("Make returns shorter over time.", "返回越来越短。"),
        T("If meaning changes, version it.", "含义变了就版本化。"),
        T("Then momentum stays clean.", "动量就保持干净。")
      );
    }
  }

  function makeMode(dir, modeKey){
    var mode = document.createElement("div");
    mode.className="mode";

    var head = document.createElement("div");
    head.className="mhead";

    var label = document.createElement("div");
    label.className="mlabel";
    label.textContent = modeKey==="concept" ? T("Concept","概念")
                     : modeKey==="live" ? T("Live","现况")
                     : T("Roadmap","路线图");

    var chev = document.createElement("div");
    chev.className="mchev";
    chev.textContent="▸";

    head.appendChild(label);
    head.appendChild(chev);

    var body = document.createElement("div");
    body.className="mbody";

    var p = document.createElement("p");
    p.className="p";
    p.textContent = copy(dir, modeKey);

    body.appendChild(p);

    head.addEventListener("click", function(e){
      e.stopPropagation();
      var open = mode.classList.toggle("open");
      chev.textContent = open ? "▾" : "▸";
    });

    mode.appendChild(head);
    mode.appendChild(body);
    return mode;
  }

  function makeDir(dir){
    var bubble = document.createElement("div");
    bubble.className="bubble";
    bubble.style.setProperty("--c", COLORS[dir] || "#93C5FD");

    var head = document.createElement("div");
    head.className="bhead";

    var left = document.createElement("div");
    left.className="left";

    var diamond = document.createElement("div");
    diamond.className="diamond";

    var label = document.createElement("div");
    label.className="label";
    label.textContent = LABEL[dir] || dir;

    left.appendChild(diamond);
    left.appendChild(label);

    var chev = document.createElement("div");
    chev.className="chev";
    chev.textContent="▸";

    head.appendChild(left);
    head.appendChild(chev);

    var body = document.createElement("div");
    body.className="body";

    var stack = document.createElement("div");
    stack.className="stack";

    // Exactly 3 sub-bubbles only
    stack.appendChild(makeMode(dir, "concept"));
    stack.appendChild(makeMode(dir, "live"));
    stack.appendChild(makeMode(dir, "roadmap"));

    body.appendChild(stack);

    head.addEventListener("click", function(){
      var already = bubble.classList.contains("open");
      // close all others
      document.querySelectorAll(".bubble").forEach(function(x){
        if(x!==bubble){ x.classList.remove("open"); var c=x.querySelector(".chev"); if(c) c.textContent="▸"; }
      });
      bubble.classList.toggle("open", !already);
      chev.textContent = bubble.classList.contains("open") ? "▾" : "▸";
    });

    bubble.appendChild(head);
    bubble.appendChild(body);
    return bubble;
  }

  var list = document.getElementById("list");
  ORDER.forEach(function(d){ list.appendChild(makeDir(d)); });

})();
</script>

</body>
</html>
