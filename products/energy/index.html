},b2:{h:"稳定",p:"扰动下有界。",u:["可重复。","可测。","可控。","无失控。"]},b3:{h:"公开",p:"讲信号与证伪。",u:["信号。","证伪。","边界。","无配方。"]},b4:{h:"边界",p:"不泄露装置。",u:["不蓝图。","不设定。","不步骤。","安全。"]}},
      informal:{title:"等离子 · 概念",b1:{h:"桥态",p:"稳定最关键。",u:["稳定。","损耗。","测量。","边界。"]},b2:{h:"规则",p:"可测才算。",u:["基线。","重复。","噪声。","限制。"]},b3:{h:"公开",p:"信号与失败。",u:["信号。","失败。","证伪。","边界。"]},b4:{h:"不公开",p:"配方。",u:["不配方。","不蓝图。","不步骤。","不危险。"]}}}},
      now:{formal:{title:"等离子 · 上线",b1:{h:"现况",p:"稳定性入门面。",u:["模式。","损耗。","信号。","边界。"]},b2:{h:"纪律",p:"测量优先。",u:["基线。","重复。","伪象。","限制。"]},b3:{h:"安全",p:"不教怎么造。",u:["无步骤。","无配方。","无参数。","无危险。"]},b4:{h:"结果",p:"严肃可测试。",u:["失败。","信号。","限制。","下一步。"]}},
      informal:{title:"等离子 · 上线",b1:{h:"现在",p:"可读。",u:["清楚。","有界。","安全。","稳定。"]},b2:{h:"规则",p:"不可测不主张。",u:["基线。","重复。","噪声。","限制。"]},b3:{h:"不发",p:"不发配方。",u:["不发。","不发。","不发。","安全。"]},b4:{h:"效果",p:"可信。",u:["可测。","可证伪。","有界。","诚实。"]}}}},
      post:{formal:{title:"等离子 · 路线图",b1:{h:"标记",p:"稳定/漂移/失败。",u:["稳定。","漂移。","失败。","噪声。"]},b2:{h:"损耗",p:"损耗账本。",u:["类型。","信号。","边界。","审计。"]},b3:{h:"模板",p:"证据包模板。",u:["模板。","日志。","重复。","安全。"]},b4:{h:"结果",p:"严谨吸引人。",u:["严谨。","可测。","安全。","一致。"]}},
      informal:{title:"等离子 · 路线图",b1:{h:"更多",p:"更深内容。",u:["定义。","约束。","信号。","证伪。"]},b2:{h:"模板",p:"报告格式。",u:["日志。","检查。","重复。","安全。"]},b3:{h:"测试",p:"压力测试。",u:["噪声。","伪象。","交叉。","证伪。"]},b4:{h:"结果",p:"稳定扩展。",u:["稳定。","有界。","可测。","安全。"]}}}}
    },
    fusion:{origin:{formal:{title:"聚变 · 概念",b1:{h:"标准",p:"标准而非口号。",u:["约束。","能量。","时间。","损耗。"]},b2:{h:"约束",p:"保持条件够久。",u:["保持。","稳定。","测量。","重复。"]},b3:{h:"公开",p:"标准/信号/失败地图。",u:["标准。","信号。","失败。","证伪。"]},b4:{h:"边界",p:"不发配方。",u:["无蓝图。","无设定。","无步骤。","安全。"]}},
      informal:{title:"聚变 · 概念",b1:{h:"清单",p:"聚变=清单。",u:["标准。","信号。","失败。","边界。"]},b2:{h:"约束",p:"控制问题。",u:["扰动。","泄漏。","稳定。","控制。"]},b3:{h:"判定",p:"看证伪。",u:["成功。","失败。","替代解释。","限制。"]},b4:{h:"不公开",p:"不发配方。",u:["不蓝图。","不设定。","不步骤。","不危险。"]}}}},
      now:{formal:{title:"聚变 · 上线",b1:{h:"现况",p:"标准面+信号面。",u:["定义。","约束。","信号。","失败。"]},b2:{h:"分离",p:"上线/路线图分离。",u:["不混说。","有界。","诚实。","稳定。"]},b3:{h:"安全",p:"不发建造细节。",u:["无步骤。","无配方。","无参数。","无危险。"]},b4:{h:"效果",p:"可测试。",u:["可测。","可证伪。","限制。","下一步。"]}},
      informal:{title:"聚变 · 上线",b1:{h:"现在",p:"清晰。",u:["清晰。","有界。","安全。","稳定。"]},b2:{h:"不混",p:"分离。",u:["分离。","分离。","分离。","稳定。"]},b3:{h:"不发",p:"不发配方。",u:["不发。","不发。","不发。","安全。"]},b4:{h:"结果",p:"可信。",u:["可测。","可证伪。","有界。","诚实。"]}}}},
      post:{formal:{title:"聚变 · 路线图",b1:{h:"收紧",p:"更清晰边界。",u:["定义。","阈值。","信号。","失败。"]},b2:{h:"分层",p:"逐步证据。",u:["步骤。","证伪。","退出。","替代解释。"]},b3:{h:"中立",p:"无噱头。",u:["中立。","有界。","稳定。","清楚。"]},b4:{h:"结果",p:"严谨吸引人。",u:["严谨。","可测。","安全。","一致。"]}},
      informal:{title:"聚变 · 路线图",b1:{h:"更多",p:"更深内容。",u:["定义。","约束。","信号。","证伪。"]},b2:{h:"步骤",p:"一步一步。",u:["步骤。","证伪。","边界。","审计。"]},b3:{h:"中立",p:"不吹。",u:["中立。","有界。","稳定。","清楚。"]},b4:{h:"结果",p:"可测试。",u:["可测。","可证伪。","有界。","安全。"]}}}}
    },
    validation:{origin:{formal:{title:"验证 · 概念",b1:{h:"原则",p:"测量+证伪。",u:["主张。","测量。","证伪。","限制。"]},b2:{h:"信号分类",p:"按含义分组。",u:["稳定。","损耗。","代理。","噪声。"]},b3:{h:"失败优先",p:"先列失败。",u:["不稳定。","损耗。","伪象。","不重复。"]},b4:{h:"边界",p:"规则公开，配方私密。",u:["规则是。","配方否。","证据包。","无泄密。"]}},
      informal:{title:"验证 · 概念",b1:{h:"规则",p:"可测可证伪。",u:["测。","试。","证伪。","重复。"]},b2:{h:"信号",p:"按含义。",u:["稳定。","损耗。","代理。","噪声。"]},b3:{h:"失败",p:"先列失败。",u:["失败。","限制。","噪声。","伪象。"]},b4:{h:"边界",p:"不发配方。",u:["不配方。","不蓝图。","不步骤。","安全。"]}}}},
      now:{formal:{title:"验证 · 上线",b1:{h:"脚手架",p:"清晰主张与清晰反证。",u:["主张。","证据。","反证。","限制。"]},b2:{h:"评估",p:"看信号是否匹配。",u:["信号。","边界。","证伪。","一致。"]},b3:{h:"不求信",p:"不给配方。",u:["不求信。","不神秘。","无配方。","无危险。"]},b4:{h:"结果",p:"一致性建立信任。",u:["稳定。","可重复。","有界。","诚实。"]}},
      informal:{title:"验证 · 上线",b1:{h:"现在",p:"规则清楚。",u:["清楚。","有界。","可测。","可证伪。"]},b2:{h:"你能判断",p:"看信号与证伪。",u:["信号。","边界。","失败。","一致。"]},b3:{h:"不发",p:"不发配方。",u:["不发。","不发。","不发。","安全。"]},b4:{h:"结果",p:"可信。",u:["稳定。","可测。","有界。","诚实。"]}}}},
      post:{formal:{title:"验证 · 路线图",b1:{h:"证据包",p:"证明模板。",u:["模板。","日志。","重复。","审计。"]},b2:{h:"压力测试",p:"信号 vs 噪声。",u:["噪声。","伪象。","交叉。","证伪。"]},b3:{h:"注册表",p:"可查询状态。",u:["状态。","原因。","历史。","规则。"]},b4:{h:"边界",p:"更严谨但不泄密。",u:["更清晰。","更安全。","有界。","诚实。"]}},
      informal:{title:"验证 · 路线图",b1:{h:"更多",p:"更完整模板。",u:["模板。","日志。","重复。","审计。"]},b2:{h:"测试",p:"压力测试。",u:["噪声。","伪象。","交叉。","证伪。"]},b3:{h:"状态",p:"可查询。",u:["状态。","原因。","历史。","规则。"]},b4:{h:"结果",p:"严谨。",u:["严谨。","有界。","可测。","安全。"]}}}}
    }
  } : CONTENT_EN;

  var CONTENT_EN = EN; // keep name for fallback, but CONTENT already set

  // ===== Control =====
  var activeKey=null;

  function setActiveDiamond(key){
    document.getElementById("dChain").classList.toggle("active", key==="chain");
    document.getElementById("dPlasma").classList.toggle("active", key==="plasma");
    document.getElementById("dFusion").classList.toggle("active", key==="fusion");
    document.getElementById("dValidation").classList.toggle("active", key==="validation");
  }

  function render(){
    persist();
    setLinks();
    setLensLabels();
    if(!activeKey) return;
    var view = CONTENT[activeKey][time][style];
    mTitle.textContent = view.title;
    fill(h1,p1,u1,view.b1);
    fill(h2,p2,u2,view.b2);
    fill(h3,p3,u3,view.b3);
    fill(h4,p4,u4,view.b4);
  }

  function open(key){
    activeKey=key;
    setActiveDiamond(key);
    render();
    bd.classList.add("show");
    modal.classList.add("show");
  }

  function close(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    activeKey=null;
    setActiveDiamond("__none__");
  }

  // Click + keyboard
  function bind(id,key){
    var el=document.getElementById(id);
    el.addEventListener("click", function(){ open(key); }, {passive:true});
    el.addEventListener("touchstart", function(){ /* ensure tap is captured */ }, {passive:true});
    el.addEventListener("keydown", function(e){
      if(e.key==="Enter" || e.key===" "){ e.preventDefault(); open(key); }
    });
  }
  bind("dChain","chain");
  bind("dPlasma","plasma");
  bind("dFusion","fusion");
  bind("dValidation","validation");

  // Lenses
  styleChip.addEventListener("click", function(){ style=(style==="formal")?"informal":"formal"; render(); });
  chipConcept.addEventListener("click", function(){ time="origin"; render(); });
  chipLive.addEventListener("click", function(){ time="now"; render(); });
  chipRoadmap.addEventListener("click", function(){ time="post"; render(); });

  // Close
  bd.addEventListener("click", close);
  mClose.addEventListener("click", close);
  document.getElementById("mReturn").addEventListener("click", close);

  // Initial
  setLensLabels();
})();
</script>

</body>
</html>
