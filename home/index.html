<!-- TNT — /home/index.html
     HUB A · GEOMETRY-OBEYING TERMINAL INDEX
     GEOMETRY (DERIVED, NOT CHOSEN):
       - Band A (GENERATIVE / RECURSIVE): N · E · S · W  (clock order left→right)
       - Band B (REFERENTIAL / TERMINAL): APPENDIX · GLOSSARY · ABOUT · LINKS
       - Recursion applies ONLY to Band A.
       - Band B is terminal (purpose + jump only; no recursion).
     BEHAVIOR:
       - Click a plate → opens Focus Pane immediately (no “opens at bottom” confusion).
       - Focus Pane contains:
           • Per-pane lens toggle (INFORMAL / FORMAL / BOTH)  (inside the opened pane)
           • Page-level language toggle remains in header (EN / 中文 / ES)
           • For Band A: Russian-doll tree rooted at the chosen cardinal
           • For Band B: single terminal panel
       - Each node shows 3-line skeleton (Aspect → Process → Resolution) per lens.
       - Each node provides:
           • JI (opens Jump Index overlay)
           • JUMP (opens Jump Deck overlay for that node; later bind to real pages)
     STATE:
       - URL: lang/style/time/depth
       - LS: gd_lang/gd_style/gd_time/gd_depth
     NOTE:
       - If /assets/instruments.js currently only allowlists en/zh, es will be reset upstream; update instruments.js allowlist when ready.
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>HUB A · Index</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
:root{--dockH:88px}

/* page */
.page{
  width:min(1100px,94vw);
  margin:0 auto;
  padding:14px 0 calc(var(--dockH) + 22px);
  display:flex;
  flex-direction:column;
  gap:12px;
  position:relative;
  z-index:5;
}

/* header */
.header{
  border:1px solid rgba(255,255,255,.10);
  border-radius:22px;
  background:rgba(0,0,0,.14);
  backdrop-filter:blur(10px);
  padding:14px 16px;
  box-shadow:0 24px 80px rgba(0,0,0,.55);
  position:relative;
  z-index:20;
}
.k{font-size:11px;letter-spacing:4px;text-transform:uppercase;opacity:.72;margin:0 0 6px}
.t{font-weight:950;font-size:24px;letter-spacing:.3px;margin:0 0 6px}
.s{font-size:13px;opacity:.82;line-height:1.5;margin:0;max-width:980px}

.ctrl{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:flex-start;margin-top:12px}
.metric{
  margin-top:10px;padding:10px 12px;border-radius:18px;
  border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.14);
  color:rgba(255,255,255,.86);line-height:1.45;font-size:13px;
}

/* language triangle (page-level only) */
.langTri{
  position:relative;width:128px;height:78px;border-radius:18px;
  border:1px solid rgba(255,255,255,.12);background:rgba(0,0,0,.18);
  box-shadow:0 14px 36px rgba(0,0,0,.45), inset 0 1px 0 rgba(255,255,255,.06);
  display:grid;place-items:center;padding:8px;
}
.langTri .tri{position:relative;width:112px;height:62px;}
.langTri .btn{position:absolute;padding:8px 12px;border-radius:999px;font-weight:900;letter-spacing:.2px;line-height:1;white-space:nowrap}
.langTri .en{left:50%;top:0;transform:translateX(-50%)}
.langTri .zh{left:0;bottom:0}
.langTri .es{right:0;bottom:0}
@media (max-width:520px){
  .langTri{width:118px;height:74px}
  .langTri .tri{width:104px;height:60px}
  .langTri .btn{padding:8px 10px}
}

/* bands */
.bandLabel{
  padding:10px 12px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.12);
  color:rgba(255,255,255,.86);
  font-weight:950;
  letter-spacing:.2px;
}

/* 4-up row (no guessing; geometry dictates symmetry) */
.row4{
  display:grid;
  grid-template-columns:repeat(4, minmax(0, 1fr));
  gap:10px;
}
@media (max-width:980px){
  .row4{grid-template-columns:repeat(2, minmax(0, 1fr));}
}

/* jewel plates */
.plate{
  --c:#93C5FD;
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  background:
    radial-gradient(circle at 30% 20%, rgba(255,255,255,.06), transparent 55%),
    linear-gradient(160deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  box-shadow:0 18px 60px rgba(0,0,0,.62);
  padding:14px 14px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  touch-action:manipulation;
  display:flex;gap:10px;align-items:flex-start;justify-content:space-between;
  position:relative;
}
.plate:hover{border-color:rgba(212,175,55,.35)}
.plate.active{
  border-color:rgba(212,175,55,.65);
  box-shadow:0 18px 60px rgba(0,0,0,.62),0 0 18px rgba(212,175,55,.22);
}
.pLeft{display:flex;gap:10px;align-items:flex-start;min-width:0}
.swatch{
  width:12px;height:12px;transform:rotate(45deg);border-radius:4px;background:var(--c);
  box-shadow:0 0 0 1px rgba(255,255,255,.12),0 0 14px rgba(0,0,0,.35);
  flex:0 0 auto;margin-top:4px;pointer-events:none;
}
.pTxt{min-width:0}
.pName{font-weight:950;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pHint{margin-top:6px;font-size:12.5px;opacity:.78;line-height:1.35}
.pChev{opacity:.75;font-size:18px;flex:0 0 auto;pointer-events:none}

/* focus pane (opens immediately under bands) */
.focus{
  border:1px solid rgba(255,255,255,.12);
  border-radius:22px;
  background:rgba(0,0,0,.16);
  backdrop-filter:blur(10px);
  box-shadow:0 24px 80px rgba(0,0,0,.55);
  padding:14px 16px;
  display:none;
}
.focus.show{display:block}
.fHead{display:flex;justify-content:space-between;align-items:flex-start;gap:10px}
.fTitle{margin:0;font-weight:950;letter-spacing:.2px;font-size:16px}
.fClose{border:0;background:transparent;color:#fff;font-size:20px;cursor:pointer;padding:6px 10px;border-radius:12px}
.fClose:hover{background:rgba(255,255,255,.08)}

/* lens toggle INSIDE pane (not page-level) */
.lensRow{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;margin-top:10px}
.lensRow .btn{padding:10px 12px;border-radius:999px}

/* russian doll nodes */
.node{
  --c:#93C5FD;
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  background:rgba(0,0,0,.18);
  overflow:hidden;
  box-shadow:0 12px 36px rgba(0,0,0,.45);
}
.nHead{
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:12px 14px;cursor:pointer;font-weight:950;letter-spacing:.2px;
  touch-action:manipulation;
}
.nLeft{display:flex;align-items:center;gap:10px;min-width:0}
.nLabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.nBody{
  display:none;
  padding:12px 14px 14px;
  border-top:1px solid rgba(255,255,255,.08);
  overflow:auto;
  -webkit-overflow-scrolling:touch;
}
.node.open>.nBody{display:block}
.childStack{display:flex;flex-direction:column;gap:10px;margin-top:12px}

/* 3-line skeleton (Aspect → Process → Resolution) */
.line{
  margin:0;
  line-height:1.6;
  font-size:13.75px;
  color:rgba(255,255,255,.90);
}
.line + .line{margin-top:8px}
.line[data-lens="informal"]{display:none}
.line[data-lens="formal"]{display:block}
.view-informal .line[data-lens="formal"]{display:none}
.view-informal .line[data-lens="informal"]{display:block}
.view-both .line{display:block}

/* analog sub-bubble (C) */
.subNode{border:1px solid rgba(255,255,255,.10);border-radius:14px;background:rgba(0,0,0,.16);overflow:hidden;margin-top:10px}
.subHead{padding:10px 12px;display:flex;align-items:center;justify-content:space-between;cursor:pointer;font-weight:950;letter-spacing:.2px;font-size:13px;touch-action:manipulation}
.subBody{display:none;padding:10px 12px 12px;border-top:1px solid rgba(255,255,255,.08)}
.subNode.open .subBody{display:block}
.analog{margin:0;line-height:1.55;font-size:13px;color:rgba(255,255,255,.86)}

/* action row */
.actRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-end;margin-top:12px}
.pill{
  display:inline-flex;align-items:center;justify-content:center;
  padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);font-weight:950;letter-spacing:.2px;cursor:pointer
}
.pill:hover{border-color:var(--gold)}
.pill:active{transform:scale(.98)}
.pill.ji{min-width:44px}

/* dock */
.dock{
  position:fixed;left:50%;
  bottom:max(10px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:220;
  width:min(980px,94vw);
  padding:10px 12px;
  border-radius:22px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.22);
  backdrop-filter:blur(10px);
  box-shadow:0 18px 60px rgba(0,0,0,.55);
  display:grid;
  grid-template-columns:repeat(4, minmax(0,1fr));
  gap:10px;
}
.dock .btn{width:100%;padding:10px 10px;border-radius:999px;white-space:nowrap}
@media (max-width:520px){:root{--dockH:92px}.dock{grid-template-columns:repeat(3, minmax(0,1fr))}}

/* overlays (JI + JD) */
.ov{position:fixed;inset:0;z-index:500;display:none;background:rgba(0,0,0,.72);backdrop-filter:blur(10px)}
.ov.show{display:block}
.panel{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(980px,94vw);height:min(86vh, 860px);z-index:510;display:none}
.panel.show{display:block}
.shell{height:100%;border-radius:22px;border:1px solid rgba(255,255,255,.12);background:linear-gradient(160deg, rgba(12,22,38,.92), rgba(7,11,18,.95));box-shadow:0 60px 180px rgba(0,0,0,.85);overflow:hidden;display:flex;flex-direction:column}
.pHead{padding:14px 16px;display:flex;align-items:center;justify-content:space-between;gap:10px;border-bottom:1px solid rgba(255,255,255,.08)}
.pTitle{margin:0;font-weight:950;letter-spacing:.2px;font-size:16px}
.pClose{border:0;background:transparent;color:#fff;font-size:20px;cursor:pointer;padding:6px 10px;border-radius:12px}
.pClose:hover{background:rgba(255,255,255,.08)}
.pBody{padding:14px 16px 18px;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}
.dirList{display:flex;flex-direction:column;gap:10px}
.row{border:1px solid rgba(255,255,255,.10);border-radius:18px;background:rgba(0,0,0,.18);padding:12px 14px}
.rTop{display:flex;align-items:flex-start;justify-content:space-between;gap:10px}
.rName{font-weight:950;letter-spacing:.2px}
.rSent{margin-top:6px;color:rgba(255,255,255,.86);line-height:1.45;font-size:13px}
</style>
</head>

<body>

<div class="page view-formal" id="page">
  <div class="header">
    <p class="k" id="hk">CARDINAL AXIS</p>
    <h1 class="t" id="ht">HUB A · Index</h1>
    <p class="s" id="hs">Compass spine (recursive) · Support spine (terminal) · Focus always.</p>

    <div class="ctrl">
      <div class="langTri" aria-label="Language">
        <div class="tri">
          <button class="btn en" id="bEN" type="button">EN</button>
          <button class="btn zh" id="bZH" type="button">中文</button>
          <button class="btn es" id="bES" type="button">ES</button>
        </div>
      </div>
    </div>

    <div class="metric" id="metric">All scalable navigation begins with declared boundaries.</div>
  </div>

  <div class="bandLabel" id="labA">COMPASS</div>
  <div class="row4" id="bandA"></div>

  <div class="bandLabel" id="labB">SYSTEM</div>
  <div class="row4" id="bandB"></div>

  <div class="focus" id="focus">
    <div class="fHead">
      <h3 class="fTitle" id="fTitle">—</h3>
      <button class="fClose" id="fClose" type="button" aria-label="Close">✕</button>
    </div>

    <div class="lensRow">
      <button class="btn" id="lensInformal" type="button">INFORMAL</button>
      <button class="btn" id="lensFormal" type="button">FORMAL</button>
      <button class="btn" id="lensBoth" type="button">BOTH</button>
    </div>

    <div id="focusBody"></div>
  </div>
</div>

<nav class="dock" id="dock" aria-label="Bottom actions">
  <button class="btn" id="navExit" type="button">EXIT</button>
  <button class="btn" id="navJI" type="button">JUMP INDEX</button>
  <button class="btn" id="navJD" type="button">JUMP DECK</button>
  <button class="btn" id="navActive" type="button">ACTIVE</button>
</nav>

<!-- JI overlay -->
<div class="ov" id="ovJI"></div>
<div class="panel" id="panelJI" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="pHead">
      <h3 class="pTitle" id="jiTitle">JUMP INDEX</h3>
      <button class="pClose" id="jiClose" type="button" aria-label="Close">✕</button>
    </div>
    <div class="pBody">
      <div class="dirList" id="jiList"></div>
    </div>
  </div>
</div>

<!-- JD overlay -->
<div class="ov" id="ovJD"></div>
<div class="panel" id="panelJD" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="pHead">
      <h3 class="pTitle" id="jdTitle">JUMP DECK</h3>
      <button class="pClose" id="jdClose" type="button" aria-label="Close">✕</button>
    </div>
    <div class="pBody">
      <div class="dirList" id="jdBody"></div>
    </div>
  </div>
</div>

<script>
(function(){
  const qs=new URLSearchParams(location.search);
  const lsGet=k=>{try{return localStorage.getItem(k)}catch(e){return null}};
  const lsSet=(k,v)=>{try{localStorage.setItem(k,String(v))}catch(e){}};

  let lang  = qs.get("lang")  || lsGet("gd_lang")  || "en";
  let style = qs.get("style") || lsGet("gd_style") || "formal";
  let time  = qs.get("time")  || lsGet("gd_time")  || "now";
  let depth = qs.get("depth") || lsGet("gd_depth") || "explore";

  if(lang!=="en" && lang!=="zh" && lang!=="es") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";
  if(depth!=="explore" && depth!=="learn") depth="explore";

  lsSet("gd_lang",lang); lsSet("gd_style",style); lsSet("gd_time",time); lsSet("gd_depth",depth);
  document.documentElement.lang = (lang==="zh") ? "zh" : (lang==="es" ? "es" : "en");

  function makeQS(over){
    const p=new URLSearchParams();
    p.set("lang",  (over&&over.lang)  || lang);
    p.set("style", (over&&over.style) || style);
    p.set("time",  (over&&over.time)  || time);
    p.set("depth", (over&&over.depth) || depth);
    return "?"+p.toString();
  }

  const L={
    en:{
      hk:"CARDINAL AXIS", ht:"HUB A · Index",
      hs:"Compass spine (recursive) · Support spine (terminal) · Focus always.",
      metric:"All scalable navigation begins with declared boundaries.",
      A:"COMPASS", B:"SYSTEM",
      exit:"EXIT", ji:"JUMP INDEX", jd:"JUMP DECK", active:"ACTIVE",
      analog:"Analog Layer", jiPill:"JI", jump:"Jump",
      inf:"INFORMAL", frm:"FORMAL", both:"BOTH"
    },
    zh:{
      hk:"基轴体系", ht:"枢纽A · 索引",
      hs:"罗盘脊柱（可递归）· 支持脊柱（终端）· 始终聚焦。",
      metric:"一切可规模化的导航，始于明确的边界。",
      A:"罗盘", B:"系统",
      exit:"退出", ji:"跳转目录", jd:"跳转卡组", active:"当前",
      analog:"类比层", jiPill:"JI", jump:"跳转",
      inf:"非正式", frm:"正式", both:"两者"
    },
    es:{
      hk:"CARDINAL AXIS", ht:"HUB A · Índice",
      hs:"Brújula (recursiva) · Soporte (terminal) · Enfoque siempre.",
      metric:"Toda navegación escalable empieza con límites declarados.",
      A:"BRÚJULA", B:"SISTEMA",
      exit:"SALIR", ji:"ÍNDICE", jd:"MAZO", active:"ACTIVO",
      analog:"Capa Analógica", jiPill:"JI", jump:"Saltar",
      inf:"INFORMAL", frm:"FORMAL", both:"AMBOS"
    }
  };
  const T=()=> (lang==="zh")?L.zh:(lang==="es")?L.es:L.en;

  // header labels
  document.getElementById("hk").textContent=T().hk;
  document.getElementById("ht").textContent=T().ht;
  document.getElementById("hs").textContent=T().hs;
  document.getElementById("metric").textContent=T().metric;
  document.getElementById("labA").textContent=T().A;
  document.getElementById("labB").textContent=T().B;

  // language buttons
  const bEN=document.getElementById("bEN");
  const bZH=document.getElementById("bZH");
  const bES=document.getElementById("bES");
  function paintLang(){
    bEN.classList.toggle("active", lang==="en");
    bZH.classList.toggle("active", lang==="zh");
    bES.classList.toggle("active", lang==="es");
  }
  paintLang();
  function setLang(next){
    if(next!=="en"&&next!=="zh"&&next!=="es") next="en";
    lang=next; lsSet("gd_lang",lang);
    history.replaceState({}, "", location.pathname + makeQS({lang}));
    location.reload();
  }
  bEN.addEventListener("click", ()=>setLang("en"));
  bZH.addEventListener("click", ()=>setLang("zh"));
  bES.addEventListener("click", ()=>setLang("es"));

  // focus + lens
  const pageEl=document.getElementById("page");
  const focus=document.getElementById("focus");
  const fTitle=document.getElementById("fTitle");
  const fClose=document.getElementById("fClose");
  const focusBody=document.getElementById("focusBody");

  const lensInformal=document.getElementById("lensInformal");
  const lensFormal=document.getElementById("lensFormal");
  const lensBoth=document.getElementById("lensBoth");

  lensInformal.textContent=T().inf;
  lensFormal.textContent=T().frm;
  lensBoth.textContent=T().both;

  function applyLens(v){
    pageEl.classList.remove("view-formal","view-informal","view-both");
    pageEl.classList.add("view-"+v);
    lensInformal.classList.toggle("active", v==="informal");
    lensFormal.classList.toggle("active", v==="formal");
    lensBoth.classList.toggle("active", v==="both");
    lsSet("hub_view", v);
  }
  applyLens(lsGet("hub_view") || (style==="informal" ? "informal" : "formal"));
  lensInformal.addEventListener("click", ()=>applyLens("informal"));
  lensFormal.addEventListener("click", ()=>applyLens("formal"));
  lensBoth.addEventListener("click", ()=>applyLens("both"));

  // geometry tree (full for compass; terminal for system)
  const TREE = {
    // compass roots
    N:{label:{en:"N · DEFINITIONS",zh:"N · 定义",es:"N · DEFINICIONES"}, color:"#1F3A8A", children:["N★","N:NE","N:NW","N:SE","N:SW"]},
    E:{label:{en:"E · PRODUCTS",zh:"E · 产品",es:"E · PRODUCTOS"}, color:"#0EA5E9", children:["E★","E:NE","E:NW","E:SE","E:SW"]},
    S:{label:{en:"S · CONSTRAINTS",zh:"S · 约束",es:"S · RESTRICCIONES"}, color:"#F59E0B", children:["S★","S:NE","S:NW","S:SE","S:SW"]},
    W:{label:{en:"W · CONTAINMENT",zh:"W · 隔离",es:"W · CONTENCIÓN"}, color:"#7F1D1D", children:["W★","W:NE","W:NW","W:SE","W:SW"]},

    // system roots (terminal)
    APPENDIX:{label:{en:"APPENDIX",zh:"附录",es:"APÉNDICE"}, color:"#A3A3A3", children:[]},
    GLOSSARY:{label:{en:"GLOSSARY",zh:"术语表",es:"GLOSARIO"}, color:"#93C5FD", children:[]},
    ABOUT:{label:{en:"ABOUT",zh:"关于",es:"ACERCA"}, color:"#D4AF37", children:[]},
    LINKS:{label:{en:"LINKS",zh:"链接",es:"ENLACES"}, color:"#60A5FA", children:[]},

    // star
    "N★":{label:{en:"NORTH STAR",zh:"北极星",es:"ESTRELLA NORTE"}, color:"#2C3EAF", children:["N★:N","N★:E","N★:S","N★:W"]},
    "E★":{label:{en:"NORTH STAR",zh:"北极星",es:"ESTRELLA NORTE"}, color:"#2C3EAF", children:["E★:N","E★:E","E★:S","E★:W"]},
    "S★":{label:{en:"NORTH STAR",zh:"北极星",es:"ESTRELLA NORTE"}, color:"#2C3EAF", children:["S★:N","S★:E","S★:S","S★:W"]},
    "W★":{label:{en:"NORTH STAR",zh:"北极星",es:"ESTRELLA NORTE"}, color:"#2C3EAF", children:["W★:N","W★:E","W★:S","W★:W"]},

    // diagonals + refinements
    "N:NE":{label:{en:"NE",zh:"NE",es:"NE"}, color:"#2C3EAF", children:["N:ENE"]},
    "N:NW":{label:{en:"NW",zh:"NW",es:"NW"}, color:"#9333EA", children:["N:WNW"]},
    "N:SE":{label:{en:"SE",zh:"SE",es:"SE"}, color:"#14B8A6", children:["N:ESE"]},
    "N:SW":{label:{en:"SW",zh:"SW",es:"SW"}, color:"#EA580C", children:["N:WSW"]},

    "E:NE":{label:{en:"NE",zh:"NE",es:"NE"}, color:"#2C3EAF", children:["E:ENE"]},
    "E:NW":{label:{en:"NW",zh:"NW",es:"NW"}, color:"#9333EA", children:["E:WNW"]},
    "E:SE":{label:{en:"SE",zh:"SE",es:"SE"}, color:"#14B8A6", children:["E:ESE"]},
    "E:SW":{label:{en:"SW",zh:"SW",es:"SW"}, color:"#EA580C", children:["E:WSW"]},

    "S:NE":{label:{en:"NE",zh:"NE",es:"NE"}, color:"#2C3EAF", children:["S:ENE"]},
    "S:NW":{label:{en:"NW",zh:"NW",es:"NW"}, color:"#9333EA", children:["S:WNW"]},
    "S:SE":{label:{en:"SE",zh:"SE",es:"SE"}, color:"#14B8A6", children:["S:ESE"]},
    "S:SW":{label:{en:"SW",zh:"SW",es:"SW"}, color:"#EA580C", children:["S:WSW"]},

    "W:NE":{label:{en:"NE",zh:"NE",es:"NE"}, color:"#2C3EAF", children:["W:ENE"]},
    "W:NW":{label:{en:"NW",zh:"NW",es:"NW"}, color:"#9333EA", children:["W:WNW"]},
    "W:SE":{label:{en:"SE",zh:"SE",es:"SE"}, color:"#14B8A6", children:["W:ESE"]},
    "W:SW":{label:{en:"SW",zh:"SW",es:"SW"}, color:"#EA580C", children:["W:WSW"]},

    "N:ENE":{label:{en:"ENE",zh:"ENE",es:"ENE"}, color:"#4B3FBF", children:[]},
    "N:WNW":{label:{en:"WNW",zh:"WNW",es:"WNW"}, color:"#9333EA", children:["N:NNW"]},
    "N:ESE":{label:{en:"ESE",zh:"ESE",es:"ESE"}, color:"#14B8A6", children:[]},
    "N:WSW":{label:{en:"WSW",zh:"WSW",es:"WSW"}, color:"#DC2626", children:["N:SSW"]},
    "N:NNW":{label:{en:"NNW",zh:"NNW",es:"NNW"}, color:"#334155", children:[]},
    "N:SSW":{label:{en:"SSW",zh:"SSW",es:"SSW"}, color:"#EA580C", children:[]},

    "E:ENE":{label:{en:"ENE",zh:"ENE",es:"ENE"}, color:"#4B3FBF", children:[]},
    "E:WNW":{label:{en:"WNW",zh:"WNW",es:"WNW"}, color:"#9333EA", children:["E:NNW"]},
    "E:ESE":{label:{en:"ESE",zh:"ESE",es:"ESE"}, color:"#14B8A6", children:[]},
    "E:WSW":{label:{en:"WSW",zh:"WSW",es:"WSW"}, color:"#DC2626", children:["E:SSW"]},
    "E:NNW":{label:{en:"NNW",zh:"NNW",es:"NNW"}, color:"#334155", children:[]},
    "E:SSW":{label:{en:"SSW",zh:"SSW",es:"SSW"}, color:"#EA580C", children:[]},

    "S:ENE":{label:{en:"ENE",zh:"ENE",es:"ENE"}, color:"#4B3FBF", children:[]},
    "S:WNW":{label:{en:"WNW",zh:"WNW",es:"WNW"}, color:"#9333EA", children:["S:NNW"]},
    "S:ESE":{label:{en:"ESE",zh:"ESE",es:"ESE"}, color:"#14B8A6", children:[]},
    "S:WSW":{label:{en:"WSW",zh:"WSW",es:"WSW"}, color:"#DC2626", children:["S:SSW"]},
    "S:NNW":{label:{en:"NNW",zh:"NNW",es:"NNW"}, color:"#334155", children:[]},
    "S:SSW":{label:{en:"SSW",zh:"SSW",es:"SSW"}, color:"#EA580C", children:[]},

    "W:ENE":{label:{en:"ENE",zh:"ENE",es:"ENE"}, color:"#4B3FBF", children:[]},
    "W:WNW":{label:{en:"WNW",zh:"WNW",es:"WNW"}, color:"#9333EA", children:["W:NNW"]},
    "W:ESE":{label:{en:"ESE",zh:"ESE",es:"ESE"}, color:"#14B8A6", children:[]},
    "W:WSW":{label:{en:"WSW",zh:"WSW",es:"WSW"}, color:"#DC2626", children:["W:SSW"]},
    "W:NNW":{label:{en:"NNW",zh:"NNW",es:"NNW"}, color:"#334155", children:[]},
    "W:SSW":{label:{en:"SSW",zh:"SSW",es:"SSW"}, color:"#EA580C", children:[]},

    "N★:N":{label:{en:"N",zh:"N",es:"N"}, color:"#1F3A8A", children:[]},
    "N★:E":{label:{en:"E",zh:"E",es:"E"}, color:"#0EA5E9", children:[]},
    "N★:S":{label:{en:"S",zh:"S",es:"S"}, color:"#F59E0B", children:[]},
    "N★:W":{label:{en:"W",zh:"W",es:"W"}, color:"#7F1D1D", children:[]},

    "E★:N":{label:{en:"N",zh:"N",es:"N"}, color:"#1F3A8A", children:[]},
    "E★:E":{label:{en:"E",zh:"E",es:"E"}, color:"#0EA5E9", children:[]},
    "E★:S":{label:{en:"S",zh:"S",es:"S"}, color:"#F59E0B", children:[]},
    "E★:W":{label:{en:"W",zh:"W",es:"W"}, color:"#7F1D1D", children:[]},

    "S★:N":{label:{en:"N",zh:"N",es:"N"}, color:"#1F3A8A", children:[]},
    "S★:E":{label:{en:"E",zh:"E",es:"E"}, color:"#0EA5E9", children:[]},
    "S★:S":{label:{en:"S",zh:"S",es:"S"}, color:"#F59E0B", children:[]},
    "S★:W":{label:{en:"W",zh:"W",es:"W"}, color:"#7F1D1D", children:[]},

    "W★:N":{label:{en:"N",zh:"N",es:"N"}, color:"#1F3A8A", children:[]},
    "W★:E":{label:{en:"E",zh:"E",es:"E"}, color:"#0EA5E9", children:[]},
    "W★:S":{label:{en:"S",zh:"S",es:"S"}, color:"#F59E0B", children:[]},
    "W★:W":{label:{en:"W",zh:"W",es:"W"}, color:"#7F1D1D", children:[]}
  };

  function nodeLabel(id){
    const o=TREE[id] && TREE[id].label;
    if(!o) return id;
    if(lang==="zh") return o.zh;
    if(lang==="es") return o.es || o.en;
    return o.en;
  }

  // skeleton lines: Aspect → Process → Resolution (per lens)
  function skeleton(id, lens){
    const core = id.split(":")[0].replace("★","");
    const isSystem = (id==="APPENDIX"||id==="GLOSSARY"||id==="ABOUT"||id==="LINKS");
    if(lang==="zh"){
      if(isSystem){
        if(id==="APPENDIX") return lens==="formal"
          ? ["用途：收纳协议/证明/声明。","过程：为全站提供可引用骨架。","结果：统一版本与溯源。"]
          : ["附录：把关键包放在一个地方。","你不必到处找。","需要时一键跳。"];
        if(id==="GLOSSARY") return lens==="formal"
          ? ["用途：锁定术语。","过程：防止语义漂移。","结果：跨域可比较。"]
          : ["术语表：大家说同一套话。","少争论，多前进。","需要时一键跳。"];
        if(id==="ABOUT") return lens==="formal"
          ? ["用途：声明姿态与边界。","过程：避免主张膨胀。","结果：减少误读。"]
          : ["关于：告诉你这是什么/不是什么。","不卖信仰，只给结构。","需要时一键跳。"];
        return lens==="formal"
          ? ["用途：外部锚点目录。","过程：指向OSF/GitHub等。","结果：可核查。"]
          : ["链接：所有外部证据入口。","不解释，直接给锚点。","需要时一键跳。"];
      }
      if(lens==="formal"){
        if(core==="N") return ["定义：范围先于权力。","过程：锁定语义→约束扩张。","结果：避免漂移。"];
        if(core==="E") return ["执行：继承边界条件。","过程：表面遵循约束→可部署。","结果：可复制而不腐化。"];
        if(core==="S") return ["闸门：可采信由约束决定。","过程：无证据拒绝→阶段门控。","结果：扩张不越界。"];
        if(core==="W") return ["隔离：局部失败必须局部化。","过程：分段/回滚→阻断级联。","结果：恢复一致性。"];
      }else{
        if(core==="N") return ["先钉住含义。","然后才谈扩张怎么走。","不然会漂。"];
        if(core==="E") return ["先守边界再上线。","否则规模放大故障。","可用才算赢。"];
        if(core==="S") return ["闸门先行。","没边界就别扩张。","否则系统变烂。"];
        if(core==="W") return ["先隔离再修。","别让小问题变全局。","回到稳定再走。"];
      }
    }

    if(lang==="es"){
      if(isSystem){
        if(id==="APPENDIX") return lens==="formal"
          ? ["Propósito: paquetes, pruebas y avisos.","Proceso: referencia única del proyecto.","Resultado: versiones y proveniencia unificadas."]
          : ["Apéndice: todo lo crítico en un lugar.","No busques por todo el sitio.","Salta cuando lo necesites."];
        if(id==="GLOSSARY") return lens==="formal"
          ? ["Propósito: fijar términos canónicos.","Proceso: bloquear deriva semántica.","Resultado: comparación entre dominios."]
          : ["Glosario: mismas palabras, menos peleas.","Más claridad, menos ruido.","Salta cuando lo necesites."];
        if(id==="ABOUT") return lens==="formal"
          ? ["Propósito: postura y límites.","Proceso: evitar inflación de afirmaciones.","Resultado: menos malentendidos."]
          : ["Acerca: qué es y qué no es.","Sin venta; solo estructura.","Salta cuando lo necesites."];
        return lens==="formal"
          ? ["Propósito: directorio de anclas externas.","Proceso: OSF/GitHub y pruebas.","Resultado: verificabilidad."]
          : ["Enlaces: entradas directas a pruebas.","Sin charla; solo anclas.","Salta cuando lo necesites."];
      }
      if(lens==="formal"){
        if(core==="N") return ["Definición: el alcance precede a la autoridad.","Proceso: fijar significado → acotar expansión.","Resultado: deriva reducida."];
        if(core==="E") return ["Ejecución: hereda condiciones de borde.","Proceso: superficies dentro de límites → despliegue.","Resultado: réplica sin corrupción."];
        if(core==="S") return ["Compuertas: la restricción define admisibilidad.","Proceso: rechazo sin evidencia → fases.","Resultado: expansión disciplinada."];
        if(core==="W") return ["Contención: el fallo local debe permanecer local.","Proceso: segmentar/rollback → cortar cascada.","Resultado: coherencia restaurada."];
      }else{
        if(core==="N") return ["Fija el significado primero.","Luego decides cómo avanzar.","Si no, deriva."];
        if(core==="E") return ["Ejecuta con límites.","La escala amplifica fallos.","Funcionar es ganar."];
        if(core==="S") return ["Compuertas primero.","Sin límites no escales.","O se pudre."];
        if(core==="W") return ["Aísla y repara.","No dejes que se propague.","Vuelve estable y continúa."];
      }
    }

    // en
    if(isSystem){
      if(id==="APPENDIX") return lens==="formal"
        ? ["Purpose: packets, proofs, notices.","Process: single reference backbone.","Result: unified version + provenance."]
        : ["Appendix: everything critical in one place.","No hunting across the site.","Jump when needed."];
      if(id==="GLOSSARY") return lens==="formal"
        ? ["Purpose: lock canonical terms.","Process: prevent semantic drift.","Result: cross-domain comparability."]
        : ["Glossary: same words, less arguing.","More clarity, less noise.","Jump when needed."];
      if(id==="ABOUT") return lens==="formal"
        ? ["Purpose: posture and limits.","Process: prevent claim inflation.","Result: fewer misreads."]
        : ["About: what this is / is not.","No selling; only structure.","Jump when needed."];
      return lens==="formal"
        ? ["Purpose: external anchor directory.","Process: OSF/GitHub proof links.","Result: verifiability."]
        : ["Links: direct entrances to proof.","No talk; just anchors.","Jump when needed."];
    }

    if(lens==="formal"){
      if(core==="N") return ["Definition: scope precedes authority.","Process: lock meaning → bound expansion.","Result: drift reduced."];
      if(core==="E") return ["Execution: inherits boundary conditions.","Process: surfaces inside scope → deploy.","Result: replicate without corruption."];
      if(core==="S") return ["Gates: constraint defines admissibility.","Process: refuse without evidence → phase gates.","Result: disciplined expansion."];
      if(core==="W") return ["Containment: local failure stays local.","Process: segment/rollback → stop cascade.","Result: coherence restored."];
    }else{
      if(core==="N") return ["Lock meaning first.","Then decide how to move.","Otherwise drift."];
      if(core==="E") return ["Execute inside limits.","Scale amplifies failure.","Working is winning."];
      if(core==="S") return ["Gate first.","No limits, no scale.","Or it rots."];
      if(core==="W") return ["Isolate and repair.","Don’t let it spread.","Return stable, continue."];
    }

    return ["—","—","—"];
  }

  function analogSentence(id){
    const core = id.split(":")[0].replace("★","");
    if(lang==="zh"){
      if(core==="N") return "物理：边界映射；生物：代谢调控；工程：标定基准；治理：宪制约束；计算：不变量定义。";
      if(core==="E") return "物理：推进与作功；生物：执行链；工程：执行器；治理：行政执行；计算：状态转移。";
      if(core==="S") return "物理：摩擦/重力；生物：免疫门控；工程：安全联锁；治理：司法审查；计算：验证闸门。";
      if(core==="W") return "物理：分舱隔离；生物：细胞隔离；工程：断路器；治理：隔离处置；计算：回滚/分区恢复。";
      return "跨域：参考节点用于稳定语义与外部锚点。";
    }
    if(lang==="es"){
      if(core==="N") return "Físico: límites. Biológico: regulación. Ingeniería: calibración. Gobernanza: constitución. Computación: invariantes.";
      if(core==="E") return "Físico: acción. Biológico: ejecución. Ingeniería: actuadores. Gobernanza: ejecución. Computación: transiciones.";
      if(core==="S") return "Físico: fricción. Biológico: compuertas. Ingeniería: interlocks. Gobernanza: revisión. Computación: validación.";
      if(core==="W") return "Físico: compartimentos. Biológico: aislamiento. Ingeniería: disyuntores. Gobernanza: contención. Computación: rollback.";
      return "Multidominio: nodos de referencia estabilizan términos y anclas.";
    }
    if(core==="N") return "Physical: boundaries. Biological: regulation. Engineering: calibration. Governance: constitution. Computational: invariants.";
    if(core==="E") return "Physical: action. Biological: execution. Engineering: actuators. Governance: execution. Computational: transitions.";
    if(core==="S") return "Physical: friction. Biological: gates. Engineering: interlocks. Governance: review. Computational: validation.";
    if(core==="W") return "Physical: compartments. Biological: isolation. Engineering: breakers. Governance: containment. Computational: rollback.";
    return "Cross-domain: reference nodes stabilize terms and anchors.";
  }

  // overlays
  const ovJI=document.getElementById("ovJI");
  const panelJI=document.getElementById("panelJI");
  const jiClose=document.getElementById("jiClose");
  const jiTitle=document.getElementById("jiTitle");
  const jiList=document.getElementById("jiList");

  const ovJD=document.getElementById("ovJD");
  const panelJD=document.getElementById("panelJD");
  const jdClose=document.getElementById("jdClose");
  const jdTitle=document.getElementById("jdTitle");
  const jdBody=document.getElementById("jdBody");

  function openJI(){
    jiTitle.textContent = (lang==="zh")?"跳转目录":(lang==="es")?"ÍNDICE DE SALTOS":"JUMP INDEX";
    jiList.innerHTML="";
    Object.keys(TREE).forEach(id=>{
      const row=document.createElement("div");
      row.className="row";
      const top=document.createElement("div");
      top.className="rTop";
      const nm=document.createElement("div");
      nm.className="rName";
      nm.textContent=nodeLabel(id);
      const act=document.createElement("div");
      const jb=document.createElement("button");
      jb.className="btn";
      jb.type="button";
      jb.textContent=T().jump;
      jb.dataset.action="open-jd";
      jb.dataset.id=id;
      act.appendChild(jb);
      top.appendChild(nm);
      top.appendChild(act);

      const view = lsGet("hub_view") || (style==="informal" ? "informal" : "formal");
      const sent=document.createElement("div");
      sent.className="rSent";
      const lines = skeleton(id, view==="both" ? "formal" : view);
      sent.textContent = lines[0];
      row.appendChild(top);
      row.appendChild(sent);
      jiList.appendChild(row);
    });
    ovJI.classList.add("show");
    panelJI.classList.add("show");
  }
  function closeJI(){ovJI.classList.remove("show");panelJI.classList.remove("show");}

  function openJD(id){
    jdTitle.textContent = (lang==="zh")?"跳转卡组":(lang==="es")?"MAZO":"JUMP DECK";
    jdBody.innerHTML="";
    const row=document.createElement("div");
    row.className="row";
    const top=document.createElement("div");
    top.className="rTop";
    const nm=document.createElement("div");
    nm.className="rName";
    nm.textContent=nodeLabel(id);
    top.appendChild(nm);
    row.appendChild(top);

    const view = lsGet("hub_view") || (style==="informal" ? "informal" : "formal");
    const lines = skeleton(id, view==="both" ? "formal" : view);

    const s=document.createElement("div");
    s.className="rSent";
    s.textContent = lines.join(" ");
    row.appendChild(s);

    const a=document.createElement("div");
    a.className="rSent";
    a.textContent = analogSentence(id);
    row.appendChild(a);

    const note=document.createElement("div");
    note.className="rSent";
    note.style.opacity=".7";
    note.textContent = (lang==="zh")
      ? "（占位）此处将绑定到具体工具/产品/证明页面。"
      : (lang==="es")
      ? "(Marcador) Aquí se enlazará a herramienta/producto/prueba."
      : "(Placeholder) This will bind to a specific tool/product/proof page.";
    row.appendChild(note);

    jdBody.appendChild(row);

    ovJD.classList.add("show");
    panelJD.classList.add("show");
    lsSet("hub_active_node", id);
  }
  function closeJD(){ovJD.classList.remove("show");panelJD.classList.remove("show");}

  ovJI.addEventListener("pointerup", (e)=>{e.preventDefault();closeJI();}, {passive:false});
  ovJD.addEventListener("pointerup", (e)=>{e.preventDefault();closeJD();}, {passive:false});
  jiClose.addEventListener("click", closeJI);
  jdClose.addEventListener("click", closeJD);
  panelJI.addEventListener("click",(e)=>e.stopPropagation());
  panelJD.addEventListener("click",(e)=>e.stopPropagation());

  // dock
  const navExit=document.getElementById("navExit");
  const navJI=document.getElementById("navJI");
  const navJD=document.getElementById("navJD");
  const navActive=document.getElementById("navActive");
  navExit.textContent=T().exit;
  navJI.textContent=T().ji;
  navJD.textContent=T().jd;
  navActive.textContent=T().active;

  // focus pane
  const focus=document.getElementById("focus");
  const fTitle=document.getElementById("fTitle");
  const fClose=document.getElementById("fClose");
  const focusBody=document.getElementById("focusBody");

  function nodeLabelTitle(id){ return nodeLabel(id); }

  // build node (recursive only for compass; terminal for system)
  function buildNode(id){
    const info=TREE[id];
    const node=document.createElement("section");
    node.className="node";
    node.style.setProperty("--c", info.color || "#93C5FD");
    node.dataset.id=id;

    const head=document.createElement("div");
    head.className="nHead";
    head.dataset.action="toggle-node";
    head.innerHTML="<div class='nLeft'><div class='swatch' style='--c:"+ (info.color||"#93C5FD") +";'></div><div class='nLabel'>"+nodeLabel(id)+"</div></div><div>▸</div>";

    const body=document.createElement("div");
    body.className="nBody";

    // 3 lines per lens
    const inf = skeleton(id,"informal");
    const frm = skeleton(id,"formal");

    const li1=document.createElement("p"); li1.className="line"; li1.dataset.lens="informal"; li1.textContent=inf[0];
    const li2=document.createElement("p"); li2.className="line"; li2.dataset.lens="informal"; li2.textContent=inf[1];
    const li3=document.createElement("p"); li3.className="line"; li3.dataset.lens="informal"; li3.textContent=inf[2];

    const lf1=document.createElement("p"); lf1.className="line"; lf1.dataset.lens="formal"; lf1.textContent=frm[0];
    const lf2=document.createElement("p"); lf2.className="line"; lf2.dataset.lens="formal"; lf2.textContent=frm[1];
    const lf3=document.createElement("p"); lf3.className="line"; lf3.dataset.lens="formal"; lf3.textContent=frm[2];

    body.appendChild(li1); body.appendChild(li2); body.appendChild(li3);
    body.appendChild(lf1); body.appendChild(lf2); body.appendChild(lf3);

    // analog sub
    const sub=document.createElement("div");
    sub.className="subNode";
    const sh=document.createElement("div");
    sh.className="subHead";
    sh.dataset.action="toggle-analog";
    sh.innerHTML="<div>"+T().analog+"</div><div>▸</div>";
    const sb=document.createElement("div");
    sb.className="subBody";
    const ap=document.createElement("p");
    ap.className="analog";
    ap.textContent=analogSentence(id);
    sb.appendChild(ap);
    sub.appendChild(sh);
    sub.appendChild(sb);
    body.appendChild(sub);

    // actions
    const act=document.createElement("div");
    act.className="actRow";
    const ji=document.createElement("div");
    ji.className="pill ji";
    ji.textContent=T().jiPill;
    ji.dataset.action="open-ji";
    const jump=document.createElement("div");
    jump.className="pill";
    jump.textContent=T().jump;
    jump.dataset.action="open-jd";
    jump.dataset.id=id;
    act.appendChild(ji);
    act.appendChild(jump);
    body.appendChild(act);

    // recurse only if compass band (N/E/S/W) or their descendants
    const rootKey = id.split(":")[0].replace("★","");
    const isCompass = (rootKey==="N"||rootKey==="E"||rootKey==="S"||rootKey==="W");
    if(isCompass && info.children && info.children.length){
      const stack=document.createElement("div");
      stack.className="childStack";
      info.children.forEach(child=>stack.appendChild(buildNode(child)));
      body.appendChild(stack);
    }

    node.appendChild(head);
    node.appendChild(body);
    return node;
  }

  function openFocus(rootId){
    const info=TREE[rootId];
    lsSet("hub_active_node", rootId);

    // set title
    fTitle.textContent = nodeLabelTitle(rootId);

    // populate
    focusBody.innerHTML="";
    focusBody.appendChild(buildNode(rootId));

    // show focus and scroll to it
    focus.classList.add("show");
    setTimeout(()=>{
      focus.scrollIntoView({behavior:"smooth", block:"start"});
    }, 0);

    // highlight active plate
    document.querySelectorAll(".plate").forEach(p=>{
      p.classList.toggle("active", p.dataset.id===rootId);
    });
  }

  // build plates (geometry decides ordering)
  const bandA=document.getElementById("bandA");
  const bandB=document.getElementById("bandB");

  const ORDER_A=["N","E","S","W"]; // geometry lock: clockwise order left→right
  const ORDER_B=["APPENDIX","GLOSSARY","ABOUT","LINKS"];

  function plateHint(id){
    const view = lsGet("hub_view") || (style==="informal" ? "informal" : "formal");
    const lines = skeleton(id, view==="both" ? "formal" : view);
    return lines[0];
  }

  function makePlate(id){
    const info=TREE[id];
    const p=document.createElement("div");
    p.className="plate";
    p.dataset.id=id;
    p.style.setProperty("--c", info.color || "#93C5FD");

    const left=document.createElement("div");
    left.className="pLeft";

    const sw=document.createElement("div");
    sw.className="swatch";

    const txt=document.createElement("div");
    txt.className="pTxt";

    const name=document.createElement("div");
    name.className="pName";
    name.textContent=nodeLabel(id);

    const hint=document.createElement("div");
    hint.className="pHint";
    hint.textContent=plateHint(id);

    txt.appendChild(name);
    txt.appendChild(hint);
    left.appendChild(sw);
    left.appendChild(txt);

    const chev=document.createElement("div");
    chev.className="pChev";
    chev.textContent="›";

    p.appendChild(left);
    p.appendChild(chev);

    p.addEventListener("click", ()=>openFocus(id));
    return p;
  }

  bandA.innerHTML="";
  ORDER_A.forEach(id=>bandA.appendChild(makePlate(id)));

  bandB.innerHTML="";
  ORDER_B.forEach(id=>bandB.appendChild(makePlate(id)));

  // close focus
  fClose.addEventListener("click", ()=>{
    focus.classList.remove("show");
    document.querySelectorAll(".plate").forEach(p=>p.classList.remove("active"));
  });

  // delegated interactions inside focus pane + overlays
  function onTap(e){
    const t = e.target;
    const el = t.closest("[data-action], .nHead, .subHead, .pill");
    if(!el) return;

    const action = el.dataset.action || "";

    if(action==="toggle-node" || el.classList.contains("nHead")){
      const node = el.closest(".node");
      if(node) node.classList.toggle("open");
      return;
    }
    if(action==="toggle-analog" || el.classList.contains("subHead")){
      const sub = el.closest(".subNode");
      if(sub) sub.classList.toggle("open");
      return;
    }
    if(action==="open-ji"){
      openJI();
      return;
    }
    if(action==="open-jd"){
      openJD(el.dataset.id || lsGet("hub_active_node") || "N");
      return;
    }
  }
  focus.addEventListener("click", onTap);

  // open/close overlays via delegation
  document.addEventListener("click", function(e){
    const btn = e.target.closest("[data-action]");
    if(!btn) return;
    const a = btn.dataset.action;

    if(a==="open-jd"){
      e.preventDefault();
      openJD(btn.dataset.id || lsGet("hub_active_node") || "N");
    }
  });

  // dock actions
  navExit.addEventListener("click", ()=>location.href="/door/"+makeQS());
  navJI.addEventListener("click", openJI);
  navJD.addEventListener("click", ()=>openJD(lsGet("hub_active_node")||"N"));
  navActive.addEventListener("click", ()=>openJD(lsGet("hub_active_node")||"N"));

  // i18n dock labels
  navExit.textContent=T().exit;
  navJI.textContent=T().ji;
  navJD.textContent=T().jd;
  navActive.textContent=T().active;

  // default open last active
  const last = lsGet("hub_active_node") || "N";
  const start = TREE[last] ? last : "N";
  openFocus(start);

})();
</script>

</body>
</html>
