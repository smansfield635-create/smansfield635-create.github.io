<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Alignment diagnostic</title><link rel="stylesheet" href="/assets/ui.css"/><style>.grid{display:grid;grid-template-columns:1fr;gap:12px}.sec{padding:14px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,.07),rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.14);text-align:left}.sec h3{margin-bottom:8px}.opt{display:flex;gap:10px;align-items:flex-start;padding:10px;border-radius:14px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.10);cursor:pointer}.opt input{margin-top:4px}.muted{color:#b9c6d3}.bar{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;margin:10px 0}.pill{padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06)}</style></head><body><main class="page"><div class="h1">Make selections</div><div class="h2">Complete all 16 sections. Then optional +4 refinement unlocks.</div><section class="panel"><div class="bar"><div class="pill">Required: <b id="req">0</b>/16</div><div class="pill">Refine: <b id="ref">0</b>/4</div></div><div class="btnrow"><a class="btn" href="/landing/diagnostic/">Back</a><a class="btn" href="/home/">Skip to site</a><a class="btn" href="/landing/exit.html">Exit</a><a class="btn primary" id="finish16" href="/landing/diagnostic/results/" style="pointer-events:none;opacity:.55;">Finish</a></div><div class="grid" id="sections"></div><div class="sec" id="refineBox" style="display:none;"><h3>Optional refinement (+4)</h3><div class="muted">Unlocked after 16/16. Choose up to four additional lines from the pool.</div><div id="refineList" style="margin-top:10px;display:flex;flex-direction:column;gap:10px;"></div></div><div class="footer">Check yourself before you wreck yourself.</div></section></main><script>(async function(){const DATA=await (await fetch("/landing/diagnostic/data/sayings.json?v="+Date.now())).json();const map=new Map(DATA.sayings.map(s=>[s.id,s]));const reqKey="gd_req",refKey="gd_ref";const req=JSON.parse(localStorage.getItem(reqKey)||"{}");const ref=JSON.parse(localStorage.getItem(refKey)||"[]");function countReq(){return Object.keys(req).length}function countRef(){return ref.length}function save(){localStorage.setItem(reqKey,JSON.stringify(req));localStorage.setItem(refKey,JSON.stringify(ref));localStorage.setItem("gd_diag_data",JSON.stringify({req,ref}));}function updateTop(){document.getElementById("req").textContent=String(countReq());document.getElementById("ref").textContent=String(countRef());const ok=countReq()>=16;const btn=document.getElementById("finish16");btn.style.pointerEvents=ok?"auto":"none";btn.style.opacity=ok?"1":".55";document.getElementById("refineBox").style.display=ok?"block":"none";}function render(){const root=document.getElementById("sections");root.innerHTML="";DATA.sections.forEach(sec=>{const box=document.createElement("div");box.className="sec";const h=document.createElement("h3");h.textContent=sec.label;box.appendChild(h);sec.ids.forEach((id)=>{const s=map.get(id);const row=document.createElement("label");row.className="opt";const rb=document.createElement("input");rb.type="radio";rb.name=sec.id;rb.checked=(req[sec.id]===id);const text=document.createElement("div");text.innerHTML=`<div><b>${s.text}</b></div><div class="muted">${s.source} · ${s.primary}${s.secondary?(" / "+s.secondary):""}</div>`;row.appendChild(rb);row.appendChild(text);row.onclick=(e)=>{if(e.target.tagName!=="INPUT"){rb.checked=true;}req[sec.id]=id;save();updateTop();};box.appendChild(row);});root.appendChild(box);});updateTop();renderRefine();}function renderRefine(){if(countReq()<16) return;const pool=DATA.refine_pool.map(id=>map.get(id)).filter(Boolean);const list=document.getElementById("refineList");list.innerHTML="";pool.forEach(s=>{const row=document.createElement("label");row.className="opt";const cb=document.createElement("input");cb.type="checkbox";cb.checked=ref.includes(s.id);cb.disabled=!cb.checked && ref.length>=4;const text=document.createElement("div");text.innerHTML=`<div><b>${s.text}</b></div><div class="muted">${s.source} · ${s.primary}${s.secondary?(" / "+s.secondary):""}</div>`;row.appendChild(cb);row.appendChild(text);row.onclick=(e)=>{if(e.target.tagName!=="INPUT"){cb.checked=!cb.checked;}let cur=ref.slice();if(cb.checked){if(!cur.includes(s.id)){if(cur.length>=4){cb.checked=false;return;}cur.push(s.id);}}else{cur=cur.filter(x=>x!==s.id);}ref.length=0;cur.forEach(x=>ref.push(x));save();updateTop();renderRefine();};list.appendChild(row);});}save();render();})();</script></body></html>
