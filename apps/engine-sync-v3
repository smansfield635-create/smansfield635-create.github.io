<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Engine Sync (v3) · Geodiametrics</title>

  <style>
    :root{
      --bg:#070b14;
      --panel:rgba(12,16,34,.62);
      --stroke:rgba(233,238,252,.14);
      --stroke2:rgba(233,238,252,.10);
      --text:#e9eefc;
      --muted:rgba(233,238,252,.72);
      --muted2:rgba(233,238,252,.55);
      --shadow:0 18px 55px rgba(0,0,0,.55);
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background:
        radial-gradient(1100px 680px at 18% 22%, rgba(120,150,255,.22), transparent 60%),
        radial-gradient(980px 620px at 82% 70%, rgba(255,140,210,.14), transparent 65%),
        linear-gradient(180deg, #050816, #070b14);
      overflow-x:hidden;
    }
    /* light star field (static; motion comes later in 4TNT) */
    body:before{
      content:"";
      position:fixed; inset:0;
      background-image:
        radial-gradient(1px 1px at 12% 18%, rgba(255,255,255,.55), transparent 60%),
        radial-gradient(1px 1px at 36% 28%, rgba(255,255,255,.45), transparent 60%),
        radial-gradient(1px 1px at 58% 22%, rgba(255,255,255,.50), transparent 60%),
        radial-gradient(1px 1px at 78% 36%, rgba(255,255,255,.40), transparent 60%),
        radial-gradient(1px 1px at 24% 62%, rgba(255,255,255,.42), transparent 60%),
        radial-gradient(1px 1px at 68% 68%, rgba(255,255,255,.38), transparent 60%),
        radial-gradient(1px 1px at 86% 78%, rgba(255,255,255,.44), transparent 60%),
        radial-gradient(1px 1px at 44% 84%, rgba(255,255,255,.36), transparent 60%);
      opacity:.55;
      pointer-events:none;
      z-index:-1;
    }

    header{
      position:sticky; top:0; z-index:10;
      background:rgba(8,12,26,.55);
      backdrop-filter:blur(10px);
      border-bottom:1px solid var(--stroke2);
    }
    .bar{
      max-width:1100px;
      margin:0 auto;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }
    .brand{
      font-weight:900;
      letter-spacing:.35px;
      color:var(--text);
      opacity:.95;
      white-space:nowrap;
    }
    nav a{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.06);
      color:var(--text);
      text-decoration:none;
      font-weight:700;
      min-width:120px;
      box-shadow:0 10px 26px rgba(0,0,0,.35);
    }

    main{
      max-width:900px;
      margin:0 auto;
      padding:34px 16px 84px;
    }
    h1{
      font-size:44px;
      margin:22px 0 10px;
      letter-spacing:.2px;
    }
    .sub{
      max-width:70ch;
      color:var(--muted);
      margin:0 0 22px;
      line-height:1.55;
      font-size:16px;
    }
    .ruleline{
      height:1px;
      background:linear-gradient(90deg, transparent, var(--stroke), transparent);
      margin:18px 0 28px;
    }

    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:var(--radius);
      padding:20px;
      box-shadow:var(--shadow);
      margin:0 0 18px;
    }
    .kicker{
      font-weight:900;
      letter-spacing:.6px;
      font-size:18px;
      margin:0 0 8px;
      text-transform:uppercase;
    }
    .desc{
      color:var(--muted);
      margin:0 0 14px;
      line-height:1.55;
    }

    .pillrow{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      margin-top:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:10px 14px;
      border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.06);
      color:var(--text);
      font-weight:800;
      letter-spacing:.2px;
      box-shadow:0 10px 26px rgba(0,0,0,.35);
      cursor:pointer;
      user-select:none;
    }
    .pill.secondary{
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-weight:800;
    }
    .pill:active{transform:translateY(1px)}

    .kv{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      color:var(--muted2);
      font-weight:700;
    }
    .kv span{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid var(--stroke2);
      background:rgba(255,255,255,.04);
    }

    .big{
      font-size:18px;
      font-weight:900;
      color:var(--text);
    }
    .muted{
      color:var(--muted2);
      font-weight:800;
    }

    footer{
      margin-top:30px;
      padding-top:20px;
      border-top:1px solid var(--stroke2);
      text-align:center;
      color:var(--muted2);
      font-size:13px;
    }
  </style>
</head>

<body>
  <header>
    <div class="bar">
      <div class="brand">Geodiametrics</div>
      <nav>
        <a href="/apps/">Apps</a>
      </nav>
    </div>
  </header>

  <main>
    <h1>Engine Sync (v3)</h1>
    <p class="sub">
      Third engine instance with an independent local state namespace. Use this for parallel runs, A/B execution,
      and clean resets without touching v1 or v2.
    </p>
    <div class="ruleline"></div>

    <!-- CONTINUATION -->
    <section class="card" id="continuation">
      <div class="kicker">Continuation</div>
      <p class="desc">Persistent execution state. Reload-safe. Operator-controlled.</p>

      <div class="kv">
        <span><span class="muted">Current</span> <span class="big" id="cycleLabel">UNKNOWN</span></span>
        <span><span class="muted">Last set</span> <span class="big" id="lastSet">—</span></span>
      </div>

      <div class="pillrow" aria-label="Cycle controls">
        <div class="pill" data-cycle="RUNNING">1 · RUNNING</div>
        <div class="pill" data-cycle="HURDLE">2 · HURDLE</div>
        <div class="pill" data-cycle="WALL">3 · WALL</div>
        <div class="pill" data-cycle="COMPLETE">4 · COMPLETE</div>
        <div class="pill secondary" id="resetCycle">Reset</div>
      </div>

      <p class="desc" style="margin-top:12px">
        RUNNING = executing (reduce/contrast/condense/dedup/improve).<br/>
        HURDLE = friction; continue internally; no escalation.<br/>
        WALL = proven blocker; notify; await decision.<br/>
        COMPLETE = stable minimal state; advance cycle.
      </p>
    </section>

    <!-- SELECTION -->
    <section class="card" id="selection">
      <div class="kicker">Selection</div>
      <p class="desc">Admissibility gate. Inputs must satisfy constraints.</p>

      <div class="pillrow">
        <div class="pill" id="admitBtn">Submit Admissible Input</div>
        <div class="pill secondary" id="rejectBtn">Submit Rejected Input</div>
        <div class="pill secondary" id="clearSelection">Clear</div>
      </div>

      <p class="desc" style="margin-top:12px">
        <span class="big">Selection:</span>
        <span class="big" id="selectionLabel">—</span>
      </p>
    </section>

    <!-- RESOLUTION -->
    <section class="card" id="resolution">
      <div class="kicker">Resolution</div>
      <p class="desc">Minimal structural completion. One admitted input resolves.</p>

      <div class="pillrow">
        <div class="pill" id="resolveBtn">Resolve</div>
        <div class="pill secondary" id="resetResolution">Reset Resolution</div>
      </div>

      <p class="desc" style="margin-top:12px">
        <span class="big">Resolution:</span>
        <span class="big" id="resolutionLabel">—</span>
      </p>
    </section>

    <!-- COMMITMENT -->
    <section class="card" id="commitment">
      <div class="kicker">Commitment</div>
      <p class="desc">No rollback once committed.</p>

      <div class="pillrow">
        <div class="pill" id="commitBtn">Commit</div>
        <div class="pill secondary" id="resetEngine">Reset Engine</div>
      </div>

      <p class="desc" style="margin-top:12px">
        <span class="big">Commitment:</span>
        <span class="big" id="commitLabel">—</span>
      </p>

      <p class="desc" style="margin-top:10px">
        Rule: Commit is admissible only when Selection = ADMITTED and Resolution = RESOLVED.
      </p>
    </section>

    <footer>© 2026 Geodiametrics · Engine Sync (v3)</footer>
  </main>

  <script>
    (function(){
      // v3 namespace (independent)
      const NS = "engine_sync_v3";
      const KEY = NS;

      const $ = (id)=>document.getElementById(id);

      const state = {
        cycle: "UNKNOWN",
        lastSet: null,
        selection: null, // "ADMITTED" | "REJECTED" | null
        resolution: null, // "RESOLVED" | null
        commitment: null  // "COMMITTED" | null
      };

      function nowISO(){ return new Date().toISOString(); }

      function load(){
        try{
          const raw = localStorage.getItem(KEY);
          if(!raw) return;
          const obj = JSON.parse(raw);
          if(!obj || typeof obj !== "object") return;
          Object.assign(state, obj);
        }catch(e){}
      }

      function save(){
        try{
          localStorage.setItem(KEY, JSON.stringify(state));
        }catch(e){}
      }

      function render(){
        $("cycleLabel").textContent = state.cycle || "UNKNOWN";
        $("lastSet").textContent = state.lastSet || "—";
        $("selectionLabel").textContent = state.selection || "—";
        $("resolutionLabel").textContent = state.resolution || "—";
        $("commitLabel").textContent = state.commitment || "—";
      }

      function setCycle(c){
        state.cycle = c;
        state.lastSet = nowISO();
        save();
        render();
      }

      function resetCycle(){
        state.cycle = "UNKNOWN";
        state.lastSet = null;
        save();
        render();
      }

      function setSelection(v){
        state.selection = v;
        // Resolution/Commitment should clear if selection changes
        state.resolution = null;
        state.commitment = null;
        save();
        render();
      }

      function clearSelection(){
        state.selection = null;
        state.resolution = null;
        state.commitment = null;
        save();
        render();
      }

      function resolve(){
        if(state.selection !== "ADMITTED"){
          alert("Resolve blocked: Selection must be ADMITTED.");
          return;
        }
        state.resolution = "RESOLVED";
        save();
        render();
      }

      function resetResolution(){
        state.resolution = null;
        state.commitment = null;
        save();
        render();
      }

      function commit(){
        if(state.selection !== "ADMITTED"){
          alert("Commit blocked: Selection must be ADMITTED.");
          return;
        }
        if(state.resolution !== "RESOLVED"){
          alert("Commit blocked: Resolution must be RESOLVED.");
          return;
        }
        state.commitment = "COMMITTED";
        save();
        render();
      }

      function resetEngine(){
        state.selection = null;
        state.resolution = null;
        state.commitment = null;
        save();
        render();
      }

      // wire buttons
      document.querySelectorAll("[data-cycle]").forEach(btn=>{
        btn.addEventListener("click", ()=>setCycle(btn.getAttribute("data-cycle")));
      });
      $("resetCycle").addEventListener("click", resetCycle);

      $("admitBtn").addEventListener("click", ()=>setSelection("ADMITTED"));
      $("rejectBtn").addEventListener("click", ()=>setSelection("REJECTED"));
      $("clearSelection").addEventListener("click", clearSelection);

      $("resolveBtn").addEventListener("click", resolve);
      $("resetResolution").addEventListener("click", resetResolution);

      $("commitBtn").addEventListener("click", commit);
      $("resetEngine").addEventListener("click", resetEngine);

      // boot
      load();
      render();
    })();
  </script>
</body>
</html>
