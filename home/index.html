<!-- ============================
TNT: /home/index.html
REPLACE ENTIRE FILE
Purpose: Hub.
Reads localStorage.geo_lang + geo_depth.
Renders: Quadrant routes (NW/NE/SW/SE) + Cardinal plate (N/E/S/W).
No repeated language choice.
“Jump to Site” appears everywhere.
Depth controls density:
- explore: summaries only
- learn: deeper detail bubbles (still tappable)
- try: more “Open” links surfaced
============================ -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Home · Geodiametrics</title>

  <link rel="stylesheet" href="/assets/ui.css?v=2001"/>
  <link rel="stylesheet" href="/assets/branch.css?v=2001"/>

  <style>
    :root{
      --bg0:#05070c;
      --bg1:#24060a;
      --bg2:#4a0a10;
      --glass:rgba(255,255,255,.06);
      --glass2:rgba(255,255,255,.09);
      --line:rgba(255,255,255,.10);
      --text:#eaf2f6;
      --muted:rgba(234,242,246,.72);
      --chip:rgba(0,0,0,.28);
    }
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      background:
        radial-gradient(1200px 800px at 50% 18%, rgba(140,20,30,.55) 0%, rgba(0,0,0,0) 55%),
        radial-gradient(1200px 900px at 50% 18%, var(--bg2) 0%, var(--bg1) 45%, var(--bg0) 100%);
      overflow-x:hidden;
    }
    .page{
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      padding:36px 16px 36px;
      gap:16px;
      position:relative;
      z-index:1;
    }
    .h{
      width:min(980px,94vw);
      text-align:left;
      position:relative;
      z-index:10;
    }
    .h h1{
      margin:0;
      font-size:clamp(40px,7vw,64px);
      font-weight:950;
    }
    .h p{
      margin:10px 0 0;
      font-size:clamp(14px,3vw,18px);
      color:var(--muted);
      line-height:1.35;
    }
    .meta{
      width:min(980px,94vw);
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
      margin-top:4px;
    }
    .chip{
      padding:10px 12px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.10);
      letter-spacing:.10em;
      font-weight:850;
      font-size:12px;
      opacity:.92;
    }
    .stage{
      width:min(980px,94vw);
      display:grid;
      grid-template-columns:1fr;
      gap:14px;
      align-items:start;
      justify-content:center;
      margin-top:4px;
    }
    .panel{
      border-radius:24px;
      background:var(--glass);
      box-shadow:inset 0 0 0 1px var(--line), 0 28px 90px rgba(0,0,0,.65);
      padding:14px;
      backdrop-filter: blur(14px);
    }
    .panel h2{
      margin:0 0 10px;
      font-size:13px;
      letter-spacing:.22em;
      opacity:.85;
    }

    /* Bubble accordion */
    details{
      border-radius:18px;
      background:rgba(0,0,0,.20);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);
      padding:10px 12px;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      list-style:none;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      user-select:none;
      -webkit-tap-highlight-color:transparent;
    }
    summary::-webkit-details-marker{display:none}
    .sumL{
      display:flex; align-items:center; gap:10px;
    }
    .badge{
      min-width:44px;
      text-align:center;
      padding:10px 10px;
      border-radius:14px;
      background:rgba(255,255,255,.06);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.10);
      font-weight:900;
      letter-spacing:.14em;
      opacity:.95;
    }
    .sumTxt{
      display:flex; flex-direction:column; gap:4px;
    }
    .tMain{
      font-weight:950;
      letter-spacing:.06em;
    }
    .tSub{
      font-size:13px;
      color:rgba(234,242,246,.70);
    }
    .caret{
      width:44px;
      height:44px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:rgba(255,255,255,.06);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.10);
      opacity:.9;
      flex:0 0 auto;
    }
    .body{
      margin-top:10px;
      color:rgba(234,242,246,.86);
      line-height:1.55;
      font-size:15px;
    }
    .body ul{margin:10px 0 0 20px}
    .jumpRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    .jump{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      padding:12px 14px;
      border-radius:14px;
      background:rgba(255,255,255,.08);
      box-shadow:inset 0 0 0 1px rgba(255,255,255,.10);
      color:var(--text);
      text-decoration:none;
      font-weight:900;
      letter-spacing:.08em;
      font-size:12px;
      opacity:.95;
    }
    .jump:active{transform:translateY(1px); filter:brightness(1.05)}

    /* Cardinal plate container (uses branch.css diamonds) */
    .plateWrap{
      display:flex;
      align-items:center;
      justify-content:center;
      padding:6px 0 0;
    }
    .platform{
      margin:6px auto 0;
    }

    footer{
      width:min(980px,94vw);
      margin-top:8px;
      text-align:center;
      letter-spacing:3px;
      font-size:12px;
      opacity:.55;
      position:relative;
      z-index:10;
    }
  </style>
</head>

<body>
<div class="shooting-stars"></div>

<div class="page">
  <div class="h">
    <h1 id="H1">Home</h1>
    <p id="H2">Unified hub. Expand to explore. Tap “Jump to Site” when ready.</p>
  </div>

  <div class="meta">
    <div class="chip" id="CH_LANG">LANG · EN</div>
    <div class="chip" id="CH_DEPTH">DEPTH · EXPLORE</div>
    <a class="chip" href="/" id="CH_RESET" style="text-decoration:none;color:inherit;">RESET</a>
  </div>

  <div class="stage">

    <div class="panel">
      <h2 id="QH">QUADRANT ROUTES (NW / NE / SW / SE)</h2>

      <!-- NW -->
      <details id="Q_NW">
        <summary>
          <div class="sumL">
            <div class="badge">NW</div>
            <div class="sumTxt">
              <div class="tMain" id="NW_T">Northwest</div>
              <div class="tSub" id="NW_S">Definitions · language · structure</div>
            </div>
          </div>
          <div class="caret">▾</div>
        </summary>
        <div class="body" id="NW_B">
          <ul id="NW_LIST">
            <li>SSG (Simplified Syntax Geometry)</li>
            <li>Diamond grammar (4 routes, one choice)</li>
            <li>DOT.GRID (256-state indexing)</li>
            <li>Acronyms & glossary (organized)</li>
          </ul>
          <div class="jumpRow">
            <a class="jump" href="/laws/">JUMP · LAWS</a>
            <a class="jump" href="/laws/categories/">JUMP · CATEGORIES</a>
          </div>
        </div>
      </details>

      <!-- NE -->
      <details id="Q_NE">
        <summary>
          <div class="sumL">
            <div class="badge">NE</div>
            <div class="sumTxt">
              <div class="tMain" id="NE_T">Northeast</div>
              <div class="tSub" id="NE_S">Execution · surfaces · examples</div>
            </div>
          </div>
          <div class="caret">▾</div>
        </summary>
        <div class="body" id="NE_B">
          <ul id="NE_LIST">
            <li>Execution surfaces (apps / portals)</li>
            <li>Workflows & receipts (audit trails)</li>
            <li>Examples (how to use the system)</li>
            <li>Packaged outputs (downloadables)</li>
          </ul>
          <div class="jumpRow">
            <a class="jump" href="/products/">JUMP · PRODUCTS</a>
            <a class="jump" href="/rgsc/">JUMP · RGSC</a>
          </div>
        </div>
      </details>

      <!-- SW -->
      <details id="Q_SW">
        <summary>
          <div class="sumL">
            <div class="badge">SW</div>
            <div class="sumTxt">
              <div class="tMain" id="SW_T">Southwest</div>
              <div class="tSub" id="SW_S">Measurement · diagnostics · rules</div>
            </div>
          </div>
          <div class="caret">▾</div>
        </summary>
        <div class="body" id="SW_B">
          <ul id="SW_LIST">
            <li>Gauges (measurement instruments)</li>
            <li>Diagnostics (classification under constraint)</li>
            <li>Rules (navigation + integrity)</li>
            <li>Return protocol (hub-first)</li>
          </ul>
          <div class="jumpRow">
            <a class="jump" href="/gauges/">JUMP · GAUGES</a>
            <a class="jump" href="/diagnostic/">JUMP · DIAGNOSTIC</a>
          </div>
        </div>
      </details>

      <!-- SE -->
      <details id="Q_SE">
        <summary>
          <div class="sumL">
            <div class="badge">SE</div>
            <div class="sumTxt">
              <div class="tMain" id="SE_T">Southeast</div>
              <div class="tSub" id="SE_S">Identity · references · links</div>
            </div>
          </div>
          <div class="caret">▾</div>
        </summary>
        <div class="body" id="SE_B">
          <ul id="SE_LIST">
            <li>OSF project registry</li>
            <li>ORCID identity</li>
            <li>Contact</li>
            <li>Reference anchors</li>
          </ul>
          <div class="jumpRow">
            <a class="jump" href="/links/">JUMP · LINKS</a>
            <a class="jump" href="/contact/">JUMP · CONTACT</a>
          </div>
        </div>
      </details>

    </div>

    <div class="panel">
      <h2 id="PH">CARDINAL PLATE (N / E / S / W)</h2>
      <div class="plateWrap">
        <div class="platform">
          <a class="diamond top" href="/laws/"><span>N<small id="P_N">Laws</small></span></a>
          <a class="diamond right" href="/products/"><span>E<small id="P_E">Products</small></span></a>
          <a class="diamond bottom" href="/gauges/"><span>S<small id="P_S">Gauges</small></span></a>
          <a class="diamond left" href="/links/"><span>W<small id="P_W">Links</small></span></a>

          <a class="diamond mini mini-left" href="/"><span><small id="P_BACK">ROOT</small></span></a>
          <a class="diamond mini mini-right" href="/rgsc/"><span><small id="P_R">RGSC</small></span></a>
        </div>
      </div>
    </div>

  </div>

  <footer>CANONICAL · STABLE · © GEODIAMETRICS</footer>
</div>

<script>
  (function(){
    function safeGet(k, fallback){
      try{ return localStorage.getItem(k) || fallback; }catch(_){ return fallback; }
    }
    function safeSet(k,v){ try{ localStorage.setItem(k,v); }catch(_){ } }

    // Ensure lang chosen once: if missing, send to /
    const lang = safeGet('geo_lang', '');
    if(!lang){ location.replace('/'); return; }

    const depth = safeGet('geo_depth', 'explore'); // explore | learn | try
    document.getElementById('CH_LANG').textContent = (lang === 'zh') ? 'LANG · 中文' : 'LANG · EN';
    document.getElementById('CH_DEPTH').textContent =
      'DEPTH · ' + (depth || 'explore').toUpperCase();

    document.getElementById('CH_RESET').addEventListener('click', ()=>{
      try{
        localStorage.removeItem('geo_lang');
        localStorage.removeItem('geo_depth');
      }catch(_){}
    }, {passive:true});

    // Density control:
    // explore: keep quadrant lists short, close all by default
    // learn: keep as-is, still closed by default
    // try: emphasize jump rows by opening jump-heavy quadrants slightly (but not auto-open details)
    function trimList(id, n){
      const ul = document.getElementById(id);
      if(!ul) return;
      const items = Array.from(ul.querySelectorAll('li'));
      items.forEach((li, idx)=>{ if(idx >= n) li.style.display='none'; });
    }

    // default: keep all details closed
    // We do NOT auto-open anything (per your rule).
    if(depth === 'explore'){
      trimList('NW_LIST', 2);
      trimList('NE_LIST', 2);
      trimList('SW_LIST', 2);
      trimList('SE_LIST', 2);
    }

    // Language swap of surface text (full-page, no second prompt)
    if(lang === 'zh'){
      document.documentElement.lang = "zh";
      document.getElementById('H1').textContent = "主页";
      document.getElementById('H2').textContent = "统一枢纽。展开浏览；准备好后点“跳转”。";

      document.getElementById('QH').textContent = "象限路线（NW / NE / SW / SE）";
      document.getElementById('PH').textContent = "主盘（N / E / S / W）";

      document.getElementById('NW_T').textContent = "西北";
      document.getElementById('NW_S').textContent = "定义 · 语言 · 结构";
      document.getElementById('NE_T').textContent = "东北";
      document.getElementById('NE_S').textContent = "执行 · 界面 · 示例";
      document.getElementById('SW_T').textContent = "西南";
      document.getElementById('SW_S').textContent = "测量 · 诊断 · 规则";
      document.getElementById('SE_T').textContent = "东南";
      document.getElementById('SE_S').textContent = "身份 · 引用 · 链接";

      document.getElementById('P_N').textContent = "法则";
      document.getElementById('P_E').textContent = "产品";
      document.getElementById('P_S').textContent = "量表";
      document.getElementById('P_W').textContent = "链接";
      document.getElementById('P_BACK').textContent = "根";
      document.getElementById('P_R').textContent = "RGSC";

      // Update some bullet labels (keep short; details pages can go deep)
      document.getElementById('NW_LIST').innerHTML =
        "<li>SSG（简化语法几何）</li><li>钻石语法（四路一选）</li><li>DOT.GRID（256态索引）</li><li>缩写与术语（整理）</li>";
      document.getElementById('NE_LIST').innerHTML =
        "<li>执行界面（应用/入口）</li><li>流程与回执（审计）</li><li>示例（如何使用）</li><li>打包输出（下载）</li>";
      document.getElementById('SW_LIST').innerHTML =
        "<li>量表（测量工具）</li><li>诊断（约束分类）</li><li>规则（导航/一致性）</li><li>返回协议（枢纽优先）</li>";
      document.getElementById('SE_LIST').innerHTML =
        "<li>OSF 项目</li><li>ORCID 身份</li><li>联系方式</li><li>参考锚点</li>";

      // Trim for explore mode in Chinese too
      if(depth === 'explore'){
        trimList('NW_LIST', 2);
        trimList('NE_LIST', 2);
        trimList('SW_LIST', 2);
        trimList('SE_LIST', 2);
      }

      // Replace jump labels (routes remain same)
      const jumps = document.querySelectorAll('.jump');
      jumps.forEach(a=>{
        if(a.textContent.includes('JUMP · LAWS')) a.textContent = '跳转 · 法则';
        if(a.textContent.includes('JUMP · CATEGORIES')) a.textContent = '跳转 · 分类';
        if(a.textContent.includes('JUMP · PRODUCTS')) a.textContent = '跳转 · 产品';
        if(a.textContent.includes('JUMP · RGSC')) a.textContent = '跳转 · RGSC';
        if(a.textContent.includes('JUMP · GAUGES')) a.textContent = '跳转 · 量表';
        if(a.textContent.includes('JUMP · DIAGNOSTIC')) a.textContent = '跳转 · 诊断';
        if(a.textContent.includes('JUMP · LINKS')) a.textContent = '跳转 · 链接';
        if(a.textContent.includes('JUMP · CONTACT')) a.textContent = '跳转 · 联系';
      });
    }

    // “Try” mode: make jump buttons more visually obvious (no auto-open)
    if(depth === 'try'){
      const jumps = document.querySelectorAll('.jump');
      jumps.forEach(a=>{
        a.style.background = "rgba(255,255,255,.12)";
        a.style.boxShadow = "inset 0 0 0 1px rgba(255,255,255,.16), 0 0 22px rgba(255,120,120,.10)";
      });
    }

  })();
</script>
</body>
</html>
