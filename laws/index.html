<!-- TNT — /laws/index.html  (LAWS HUB · GEM STANDARD · 4 DIRECTIONS)
     REQUIREMENTS MET:
     ✅ Full-file TNT (one file)
     ✅ Gem uniformity matches HUB/PRODUCTS/SOFTWARE (obsidian-opal + gold crust)
     ✅ Dual language every time (EN + 中文) via gd_lang + ?lang=
     ✅ NO lenses on main page (lenses live inside modal only)
     ✅ Clicking N/E/S/W opens centered modal:
        - 4 sections (boxes)
        - each box has 4 bulletins
     ✅ State propagates across all links (lang/style/time)
     ✅ Modal is centered with internal scroll; no “dropdown too low”
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>LAWS · Cardinal Axis</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --R:124px;
  --gold:rgba(212,175,55,.9);
  --goldSoft:rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
  --mut:rgba(255,255,255,.84);
  --mut2:rgba(255,255,255,.68);
}

body{
  margin:0;
  min-height:100vh;
  background:
    radial-gradient(circle at 50% 40%, rgba(90,140,255,.10), transparent 60%),
    repeating-linear-gradient(45deg, rgba(255,255,255,.02) 0 1px, transparent 1px 100px),
    linear-gradient(180deg,#b00000 0%,#7a0000 60%,#550000 100%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:#fff;
  overflow-x:hidden;
}

/* Top-left */
.top-left{
  position:fixed;left:16px;top:16px;z-index:90;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}

/* Buttons */
.btn{
  padding:10px 16px;
  border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:white;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;
  font-weight:900;
  letter-spacing:.2px;
  text-decoration:none;
}
.btn:hover{ box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px var(--goldSoft); }
.btn.active{
  border-color:rgba(212,175,55,.25);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 22px rgba(212,175,55,.30);
}

/* Brand */
.brand{
  position:fixed;
  left:50%;
  top:16px;
  transform:translateX(-50%);
  z-index:80;
  text-align:center;
  padding:10px 14px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);
  backdrop-filter:blur(8px);
}
.brand .name{ font-weight:950; letter-spacing:1.2px; font-size:12px; opacity:.95; }
.brand .tag{ font-size:11px; letter-spacing:.6px; opacity:.70; margin-top:2px; }

/* Stage */
.stage{
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(560px,92vw);
  height:min(560px,92vw);
  z-index:40;
}

/* Outer diamond */
.outer{
  position:absolute;
  left:50%;top:50%;
  width:min(560px,92vw);
  height:min(560px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  background:
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.14), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.45) 0%, rgba(7,11,18,.62) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 90px 260px rgba(0,0,0,.62),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -50px 90px rgba(0,0,0,.55);
  pointer-events:none;
  opacity:.55;
}
.outer::after{
  content:"";
  position:absolute; inset:0; border-radius:60px;
  background:repeating-conic-gradient(from 0deg, rgba(255,255,255,.04) 0deg 6deg, transparent 6deg 18deg);
  opacity:.14;
}

/* Diamonds */
.d{
  width:150px;height:150px;
  position:absolute;
  left:50%;top:50%;
  transform-origin:center;
  border-radius:26px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;

  background:
    radial-gradient(circle at 35% 25%, rgba(255,255,255,.14), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.18), transparent 60%),
    linear-gradient(160deg, rgba(12,22,38,.92) 0%, rgba(7,11,18,.95) 70%);

  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 28px 84px rgba(0,0,0,.78),
    inset 0 2px 0 rgba(255,255,255,.14),
    inset 0 -28px 44px rgba(0,0,0,.62);
  transition:transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
}
.d::before{
  content:"";
  position:absolute; inset:0; border-radius:26px; padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.45;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  pointer-events:none;
}
.d::after{
  content:"";
  position:absolute;
  left:12%; right:12%;
  top:10%;
  height:28%;
  border-radius:999px;
  background:linear-gradient(to bottom, rgba(255,255,255,.16), rgba(255,255,255,0));
  opacity:.85;
  transform:rotate(-10deg);
  pointer-events:none;
}
.d:hover{
  transform:translate(-50%,-50%) rotate(45deg) scale(1.02);
  box-shadow:
    0 34px 110px rgba(0,0,0,.88),
    0 0 18px rgba(212,175,55,.18),
    inset 0 2px 0 rgba(255,255,255,.18),
    inset 0 -32px 52px rgba(0,0,0,.68);
}
.d.active{
  border-color:rgba(212,175,55,.55);
  box-shadow:
    0 34px 110px rgba(0,0,0,.88),
    0 0 30px rgba(212,175,55,.40),
    inset 0 2px 0 rgba(255,255,255,.18),
    inset 0 -32px 52px rgba(0,0,0,.68);
}

.d-n{ transform:translate(-50%,-50%) translate(0, calc(var(--R) * -1)) rotate(45deg); }
.d-e{ transform:translate(-50%,-50%) translate(var(--R), 0) rotate(45deg); }
.d-s{ transform:translate(-50%,-50%) translate(0, var(--R)) rotate(45deg); }
.d-w{ transform:translate(-50%,-50%) translate(calc(var(--R) * -1), 0) rotate(45deg); }

.inner{
  width:100%; height:100%;
  transform:rotate(-45deg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:16px;
  gap:8px;
  pointer-events:none;
  user-select:none;
}
.lab{ font-weight:950; letter-spacing:.8px; font-size:16px; }
.sub{ font-size:13px; opacity:.86; line-height:1.35; max-width:16em; }

/* Core */
.core{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:64px;height:64px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  box-shadow:0 18px 44px rgba(0,0,0,.62), inset 0 2px 0 rgba(255,255,255,.10);
  display:grid; place-items:center;
  font-weight:950; letter-spacing:.5px;
  opacity:.92;
  pointer-events:none;
}

/* Dock */
.dock{
  position:fixed;
  left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;
  width:min(900px,94vw);
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);
  backdrop-filter:blur(8px);
}

/* Modal */
.bd{
  position:fixed;inset:0;z-index:200;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(10px);
  display:none;
}
.bd.show{display:block;}
.modal{
  position:fixed;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:min(1020px,94vw);
  max-height:88vh;
  display:none;
  z-index:210;
}
.modal.show{display:block;}
.shell{
  height:88vh;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 50% 18%, rgba(176,0,0,.20), transparent 55%),
    radial-gradient(circle at 40% 25%, rgba(90,140,255,.12), transparent 55%),
    linear-gradient(160deg,var(--obs2) 0%, var(--obs1) 65%);
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  position:relative;
}
.shell::before{
  content:"";
  position:absolute;
  left:50%;
  top:58%;
  width:min(980px,94vw);
  height:min(980px,94vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:70px;
  background:
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.16), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.45) 0%, rgba(7,11,18,.68) 70%);
  box-shadow:
    0 100px 280px rgba(0,0,0,.72),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -55px 100px rgba(0,0,0,.55);
  opacity:.55;
  pointer-events:none;
}
.mhead{
  display:flex;justify-content:space-between;align-items:center;
  gap:10px;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08);
  position:relative;z-index:2;
}
.mtitle{ margin:0; font-weight:950; letter-spacing:.3px; font-size:16px; }
.mclose{ border:0; background:transparent; color:#fff; font-size:18px; cursor:pointer; padding:8px 10px; }
.mbody{
  padding:14px 16px 18px;
  overflow:auto;-webkit-overflow-scrolling:touch;
  flex:1 1 auto;
  position:relative;z-index:2;
}
.lensbar{
  display:flex;gap:10px;flex-wrap:wrap;
  align-items:center;justify-content:center;
  padding:10px 10px 14px;border-bottom:1px solid rgba(255,255,255,.08);
  margin:-6px -6px 14px;
}
.chip{
  padding:10px 16px;border-radius:999px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;font-weight:900;letter-spacing:.2px;color:#fff;
}
.chip.active{
  border-color:rgba(212,175,55,.35);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 16px rgba(212,175,55,.30);
}
.mgrid{ display:grid; gap:14px; }
@media (min-width:920px){ .mgrid{ grid-template-columns:1fr 1fr; } }
.box{
  padding:16px 18px;border-radius:22px;
  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.08), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 18px 60px rgba(0,0,0,.70), inset 0 2px 0 rgba(255,255,255,.06);
  position:relative;
}
.box::before{
  content:"";
  position:absolute;inset:0;border-radius:22px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  pointer-events:none;
}
.h{ margin:0 0 8px; font-weight:950; letter-spacing:.2px; }
.p{ margin:0 0 10px; color:var(--mut); line-height:1.55; }
.ul{ margin:0 0 0 18px; padding:0; color:var(--mut2); }
.ul li{ margin:6px 0; }

.mact{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin-top:14px; }
.sbtn{
  padding:12px 18px;border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:#fff;border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;font-weight:900;letter-spacing:.2px;text-decoration:none;
}
.sbtn:hover{ box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px var(--goldSoft); }

@media (max-width:520px){
  :root{ --R: 116px; }
  .stage{ width:min(520px,92vw); height:min(520px,92vw); }
  .outer{ width:min(520px,92vw); height:min(520px,92vw); }
  .core{ width:58px; height:58px; }
  .shell{ height:90vh; }
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnHub" href="/home/">HUB</a>
  <a class="btn" id="btnExit" href="/door/">EXIT</a>
</div>

<div class="brand">
  <div class="name" id="brandName">CARDINAL AXIS</div>
  <div class="tag" id="brandTag">LAWS · STANDARDS & RULES</div>
</div>

<div class="stage" aria-label="Laws diamond">
  <div class="outer"></div>

  <div class="d d-n" id="north" role="button" tabindex="0">
    <div class="inner"><div class="lab" id="nLab">FOUNDATION</div><div class="sub" id="nSub">Keys · topology · invariants.</div></div>
  </div>

  <div class="d d-e" id="east" role="button" tabindex="0">
    <div class="inner"><div class="lab" id="eLab">DEFINITIONS</div><div class="sub" id="eSub">Primitives · measures · terms.</div></div>
  </div>

  <div class="d d-s" id="south" role="button" tabindex="0">
    <div class="inner"><div class="lab" id="sLab">ENFORCEMENT</div><div class="sub" id="sSub">Gates · tiers · revocation.</div></div>
  </div>

  <div class="d d-w" id="west" role="button" tabindex="0">
    <div class="inner"><div class="lab" id="wLab">GOVERNANCE</div><div class="sub" id="wSub">Anti-capture · audit · freeze.</div></div>
  </div>

  <div class="core">◆</div>
</div>

<nav class="dock" id="dock">
  <a class="btn" id="goTerminal" href="/index.html">TERMINAL</a>
  <a class="btn" id="goLinks" href="/links/">LINKS</a>
  <a class="btn" id="goProducts" href="/products/">PRODUCTS</a>
  <a class="btn active" id="goLaws" href="/laws/">LAWS</a>
  <a class="btn" id="goGauges" href="/gauges/">GAUGES</a>
</nav>

<div class="bd" id="bd"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">DETAIL</h3>
      <button class="mclose" id="mClose" aria-label="Close" type="button">✕</button>
    </div>

    <div class="mbody">
      <div class="lensbar">
        <button class="chip" id="styleChip" type="button">STYLE: FORMAL</button>
        <button class="chip" data-time="origin" id="chipConcept" type="button">CONCEPT</button>
        <button class="chip" data-time="now" id="chipNow" type="button">NOW</button>
        <button class="chip" data-time="post" id="chipPost" type="button">POST</button>
      </div>

      <div class="mgrid">
        <div class="box"><h4 class="h" id="h1"></h4><p class="p" id="p1"></p><ul class="ul" id="u1"></ul></div>
        <div class="box"><h4 class="h" id="h2"></h4><p class="p" id="p2"></p><ul class="ul" id="u2"></ul></div>
        <div class="box"><h4 class="h" id="h3"></h4><p class="p" id="p3"></p><ul class="ul" id="u3"></ul></div>
        <div class="box"><h4 class="h" id="h4"></h4><p class="p" id="p4"></p><ul class="ul" id="u4"></ul></div>
      </div>

      <div class="mact">
        <button class="sbtn" id="mReturn" type="button">RETURN</button>
        <a class="sbtn" id="mGoHub" href="/home/">GO HUB</a>
        <a class="sbtn" id="mGoProducts" href="/products/">GO PRODUCTS</a>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  /* URL → STATE HYDRATION */
  var qs=new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";

  if(lang!=="en" && lang!=="zh") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time==="trajectory") time="post";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";

  try{
    localStorage.setItem("gd_lang", lang);
    localStorage.setItem("gd_style", style);
    localStorage.setItem("gd_time", time);
  }catch(e){}

  function q(){ return "lang="+encodeURIComponent(lang)+"&style="+encodeURIComponent(style)+"&time="+encodeURIComponent(time); }
  function setLinks(){
    var s=q();
    document.getElementById("btnHub").href="/home/?"+s;
    document.getElementById("btnExit").href="/door/?"+s;

    document.getElementById("goTerminal").href="/index.html?"+s;
    document.getElementById("goLinks").href="/links/?"+s;
    document.getElementById("goProducts").href="/products/?"+s;
    document.getElementById("goLaws").href="/laws/?"+s;
    document.getElementById("goGauges").href="/gauges/?"+s;

    document.getElementById("mGoHub").href="/home/?"+s;
    document.getElementById("mGoProducts").href="/products/?"+s;
  }

  var UI={
    en:{
      brand:"CARDINAL AXIS",
      tag:"LAWS · STANDARDS & RULES",
      lens:{formal:"FORMAL",informal:"INFORMAL",concept:"CONCEPT",now:"NOW",post:"POST"},
      d:{
        n:{lab:"FOUNDATION",sub:"Keys · topology · invariants."},
        e:{lab:"DEFINITIONS",sub:"Primitives · measures · terms."},
        s:{lab:"ENFORCEMENT",sub:"Gates · tiers · revocation."},
        w:{lab:"GOVERNANCE",sub:"Anti-capture · audit · freeze."}
      }
    },
    zh:{
      brand:"枢轴罗盘",
      tag:"法则 · 标准与规则",
      lens:{formal:"正式",informal:"非正式",concept:"概念",now:"当前",post:"后续"},
      d:{
        n:{lab:"基础",sub:"键 · 拓扑 · 不变量。"},
        e:{lab:"定义",sub:"原语 · 指标 · 术语。"},
        s:{lab:"执行",sub:"门控 · 分层 · 撤销。"},
        w:{lab:"治理",sub:"反俘获 · 审计 · 冻结。"}
      }
    }
  };

  var pack=(lang==="zh")?UI.zh:UI.en;
  document.documentElement.lang = (lang==="zh")?"zh":"en";

  document.getElementById("brandName").textContent=pack.brand;
  document.getElementById("brandTag").textContent=pack.tag;

  document.getElementById("nLab").textContent=pack.d.n.lab;
  document.getElementById("nSub").textContent=pack.d.n.sub;
  document.getElementById("eLab").textContent=pack.d.e.lab;
  document.getElementById("eSub").textContent=pack.d.e.sub;
  document.getElementById("sLab").textContent=pack.d.s.lab;
  document.getElementById("sSub").textContent=pack.d.s.sub;
  document.getElementById("wLab").textContent=pack.d.w.lab;
  document.getElementById("wSub").textContent=pack.d.w.sub;

  // Modal refs
  var bd=document.getElementById("bd");
  var modal=document.getElementById("modal");
  var mClose=document.getElementById("mClose");
  var mTitle=document.getElementById("mTitle");

  var styleChip=document.getElementById("styleChip");
  var chipConcept=document.getElementById("chipConcept");
  var chipNow=document.getElementById("chipNow");
  var chipPost=document.getElementById("chipPost");

  var h1=document.getElementById("h1"),p1=document.getElementById("p1"),u1=document.getElementById("u1");
  var h2=document.getElementById("h2"),p2=document.getElementById("p2"),u2=document.getElementById("u2");
  var h3=document.getElementById("h3"),p3=document.getElementById("p3"),u3=document.getElementById("u3");
  var h4=document.getElementById("h4"),p4=document.getElementById("p4"),u4=document.getElementById("u4");

  function fill(hEl,pEl,uEl,b){
    hEl.textContent=b.h; pEl.textContent=b.p; uEl.innerHTML="";
    b.u.forEach(function(x){ var li=document.createElement("li"); li.textContent=x; uEl.appendChild(li); });
  }

  function persist(){
    try{
      localStorage.setItem("gd_lang", lang);
      localStorage.setItem("gd_style", style);
      localStorage.setItem("gd_time", time);
    }catch(e){}
  }

  function setLensLabels(){
    styleChip.textContent = "STYLE: " + (style==="formal" ? pack.lens.formal : pack.lens.informal);
    chipConcept.textContent = pack.lens.concept;
    chipNow.textContent = pack.lens.now;
    chipPost.textContent = pack.lens.post;

    chipConcept.classList.toggle("active", time==="origin");
    chipNow.classList.toggle("active", time==="now");
    chipPost.classList.toggle("active", time==="post");
  }

  // Laws content (dense, 4×4)
  function view(dir){
    const EN={
      n:{
        origin:{formal:{title:"FOUNDATION",b1:{h:"Canonical keys",p:"Only gd_* keys govern language and lenses; no mixed namespaces are allowed.",u:["gd_lang ∈ {en, zh}.","gd_style ∈ {formal, informal}.","gd_time ∈ {origin, now, post}.","gd_depth only where needed."]},
                                   b2:{h:"Route topology",p:"Routes must match folders and labels to prevent 404 and semantic drift.",u:["/door/ = language.","/index.html = terminal.","/home/ = hub.","/products/ /laws/ /gauges/ = hubs."]},
                                   b3:{h:"CSS ownership",p:"Background is owned by ui.css; geometry by branch.css—no page overrides.",u:["No page body gradients.","No page :root overrides.","ui.css first.","branch.css second."]},
                                   b4:{h:"Interaction contract",p:"Tap → centered modal → return. This contract is non-negotiable.",u:["No scroll jumps.","Backdrop blocks drift.","Return always works.","Dock always present."]}},
            informal:{title:"FOUNDATION",b1:{h:"Keys",p:"Only gd_* keys.",u:["Language.","Style.","Time.","Depth when needed."]},
                                   b2:{h:"Routes",p:"Folders and labels must match.",u:["Door.","Terminal.","Hub.","Hubs."]},
                                   b3:{h:"CSS",p:"No CSS fights.",u:["ui owns background.","branch owns geometry.","No overrides.","Order fixed."]},
                                   b4:{h:"Contract",p:"Tap → modal → return.",u:["Centered.","Stable.","No jump.","No drift."]}}},
        now:{formal:{title:"FOUNDATION",b1:{h:"Now",p:"This law set keeps the site deterministic while building live.",u:["Uniform gems.","Uniform modals.","Uniform dock.","Uniform keys."]},
                                b2:{h:"Debug rule",p:"When something breaks, diagnose deterministically before editing.",u:["Check URL.","Check view-source.","Check localStorage.","Check 404."]},
                                b3:{h:"No empty nodes",p:"Every bubble must contain real bulletins; empty bubbles are forbidden.",u:["4 sections.","4 bullets each.","Lens-aware text.","Dual language aware."]},
                                b4:{h:"Propagation",p:"All links propagate lang/style/time forward.",u:["Query propagation.","LocalStorage fallback.","No silent overwrites.","Fallback safe."]}},
            informal:{title:"FOUNDATION",b1:{h:"Now",p:"Uniform pattern is the rule.",u:["Same gems.","Same modal.","Same dock.","Same keys."]},
                                b2:{h:"Debug",p:"Check before changing.",u:["URL.","Source.","Storage.","404."]},
                                b3:{h:"No empties",p:"Every node has content.",u:["Bulletins.","Meaning.","Lenses work.","Bilingual."]},
                                b4:{h:"Carry state",p:"State follows you.",u:["Lang.","Style.","Time.","No surprises."]}}},
        post:{formal:{title:"FOUNDATION",b1:{h:"Post",p:"Foundation becomes a published reference layer with versions and freezes.",u:["Version tags.","Changelog.","Hash anchors.","Citable references."]},
                                 b2:{h:"Scaling",p:"Scaling is cloning under contract, not redesign.",u:["Clone pages.","Swap content.","Keep contract.","No drift."]},
                                 b3:{h:"Auditability",p:"State and artifacts become replayable evidence bundles.",u:["Window logs.","Hash exports.","Registry ties.","Reason codes."]},
                                 b4:{h:"Public safety",p:"Uniform navigation + dense bulletins makes it safe to publish.",u:["Predictable UI.","Clear meaning.","Stable returns.","No broken flows."]}},
            informal:{title:"FOUNDATION",b1:{h:"Next",p:"Publish the reference layer.",u:["Versions.","Logs.","Hashes.","Cites."]},
                                 b2:{h:"Scale",p:"Clone, don’t redesign.",u:["Copy.","Edit content.","Keep rules.","Ship."]},
                                 b3:{h:"Proof",p:"Make it replayable.",u:["Logs.","Exports.","Registry.","Reasons."]},
                                 b4:{h:"Public",p:"Safe to publish.",u:["Stable.","Clear.","Predictable.","Ready."]}}}
      },
      e:{
        origin:{formal:{title:"DEFINITIONS",b1:{h:"Primitives",p:"Define core primitives (ρ, TC, Δρ, ΔTC, λ_proxy) in a neutral, operational way.",u:["ρ = correlated exposure.","TC = driver alignment.","Δ = acceleration.","λ_proxy = hazard composite."]},
                                   b2:{h:"Windows",p:"Define measurement windows deterministically by domain adapter registry.",u:["W by domain.","Locked in registry.","No silent changes.","Freeze window honored."]},
                                   b3:{h:"EffectiveSegZones",p:"Define a deterministic calculator for ‘independence’ not cosmetic zones.",u:["Update pipeline zones.","Trust boundary zones.","Rollback authority zones.","Upstream dependency zones."]},
                                   b4:{h:"Unknown policy",p:"Define UNKNOWN quotas per tier to prevent gaming.",u:["Tier 2: ≤1 unknown.","Tier 3+: 0 for core gates.","Tier 4: 0 unknown overall.","Publish exclusions."]}},
            informal:{title:"DEFINITIONS",b1:{h:"Basics",p:"Define the core measures.",u:["ρ exposure.","TC alignment.","Δ drift.","λ hazard."]},
                                   b2:{h:"Windows",p:"Lock window rules.",u:["By domain.","In a registry.","No silent change.","Freeze honored."]},
                                   b3:{h:"Zones",p:"Make ‘zones’ real.",u:["Independence.","Not cosmetic.","Deterministic calc.","Auditable."]},
                                   b4:{h:"Unknowns",p:"Limit unknowns.",u:["Quota.","No gaming.","Publish reasons.","Stay honest."]}}},
        now:{formal:{title:"DEFINITIONS",b1:{h:"Now",p:"Definitions govern how Explore becomes Products and Products become certifiable.",u:["Stable terms.","Stable windows.","Stable gates.","Stable outputs."]},
                                b2:{h:"Adapters",p:"Domain adapters define driver vectors and sign conventions.",u:["4 drivers per domain.","Normalization method.","Missing-data rules.","Sign convention (+1 risk)."]},
                                b3:{h:"Evidence schema",p:"UCI_EVENT schema is the universal intake for audits.",u:["timestamp_utc.","system_id/unit_id.","event_type.","rollout/gate fields."]},
                                b4:{h:"Publish rule",p:"Short definitions on page; dense bulletins in modal.",u:["Readable surface.","Deep detail inside.","Lens-aware.","Bilingual."]}},
            informal:{title:"DEFINITIONS",b1:{h:"Now",p:"Definitions keep everything consistent.",u:["Same terms.","Same windows.","Same gates.","Same outputs."]},
                                b2:{h:"Adapters",p:"Drivers are defined per domain.",u:["4 drivers.","Normalize.","Missing rules.","Sign convention."]},
                                b3:{h:"Schema",p:"Same intake format.",u:["Timestamp.","IDs.","Event type.","Gate fields."]},
                                b4:{h:"Publish",p:"Readable outside, dense inside.",u:["Surface simple.","Modal deep.","Lenses work.","Bilingual."]}}},
        post:{formal:{title:"DEFINITIONS",b1:{h:"Post",p:"Definitions become a stable reference and citation layer (CARES pages).",u:["Neutral standard page.","Versioned registry.","Audit-ready wording.","Public-safe."]},
                                 b2:{h:"Cross-check",p:"Two independent implementations cross-check definitions and outputs.",u:["Dual engines.","Tolerance bounds.","Auto-suspension.","Audit triggers."]},
                                 b3:{h:"Extension",p:"Extend definitions only via registry with compatibility.",u:["No ad-hoc keys.","No silent changes.","Back-compat.","Changelog."]},
                                 b4:{h:"Outcome",p:"Definitions remain observer-invariant across domains.",u:["Same evidence → same classification.","Same thresholds.","Same outputs.","Same meaning."]}},
            informal:{title:"DEFINITIONS",b1:{h:"Next",p:"Definitions become the standard page.",u:["Neutral.","Versioned.","Audit-ready.","Public-safe."]},
                                 b2:{h:"Cross-check",p:"Two engines agree or stop.",u:["Dual compute.","Tolerance.","Auto suspend.","Audit."]},
                                 b3:{h:"Extend safely",p:"Only by registry.",u:["No hacks.","No drift.","Compatible.","Logged."]},
                                 b4:{h:"Result",p:"Same meaning everywhere.",u:["Same evidence.","Same outputs.","Same thresholds.","Same classification."]}}}
      },
      s:{
        origin:{formal:{title:"ENFORCEMENT",b1:{h:"HIP gates",p:"Enforce WaveCap, SegZones, Rollback, AuditLatency, and Δρ slope.",u:["WaveCap ≤ 0.20.","EffectiveSegZones ≥ 4.","Rollback ≤ 15 min.","AuditLatency ≤ 72h."]},
                                   b2:{h:"Tiering",p:"Define tiers as claims with revocation rules.",u:["Tier 0 observed.","Tier 1 monitored.","Tier 2 compliant.","Tier 3/4 certified."]},
                                   b3:{h:"Revocation",p:"Define automatic suspension triggers.",u:["Critical gate FAIL.","Sustained ρ>0.50.","Audit refusal/falsification.","Red-team failure."]},
                                   b4:{h:"Anti-splitting",p:"Prevent micro-wave gaming by cumulative exposure accounting.",u:["Group by dependency.","≤30d window merge.","Cumulative ρ_change.","Publish disputes."]}},
            informal:{title:"ENFORCEMENT",b1:{h:"Gates",p:"Hard limits for safe change.",u:["Wave cap.","Real zones.","Fast rollback.","Fast audit."]},
                                   b2:{h:"Tiers",p:"Tiers are claims.",u:["Observed.","Monitored.","Compliant.","Certified."]},
                                   b3:{h:"Revokes",p:"Fails trigger suspension.",u:["Gate fail.","ρ too high.","Audit refused.","Red-team fail."]},
                                   b4:{h:"No gaming",p:"No micro-wave loopholes.",u:["Cumulative exposure.","Same dependency group.","Same window.","Auditable."]}}},
        now:{formal:{title:"ENFORCEMENT",b1:{h:"Now",p:"Enforcement is expressed as gate flags and reason codes.",u:["PASS/FAIL/UNKNOWN.","Reason codes.","Exports.","Dashboards."]},
                                b2:{h:"Change discipline",p:"Pilots validate certification; certification never weakens for pilots.",u:["No threshold relaxing.","Implementation remediation only.","Audit required.","Freeze honored."]},
                                b3:{h:"Operator workflows",p:"Enforcement outputs map to operator actions.",u:["Stop rollout.","Rollback.","Segment zones.","Audit within bound."]},
                                b4:{h:"Public claims",p:"Public claims require registry status and evidence hash.",u:["Serial lookup.","Tier shown.","Status shown.","Reason codes shown."]}},
            informal:{title:"ENFORCEMENT",b1:{h:"Now",p:"You get clear pass/fail.",u:["Gate flags.","Reasons.","Reports.","Exports."]},
                                b2:{h:"Rule",p:"Pilots don’t change standards.",u:["No relaxing.","Fix implementation.","Audit it.","Stay honest."]},
                                b3:{h:"Actions",p:"Outputs tell you what to do.",u:["Stop.","Rollback.","Segment.","Audit."]},
                                b4:{h:"Claims",p:"Claims must be verifiable.",u:["Serial.","Tier.","Status.","Reasons."]}}},
        post:{formal:{title:"ENFORCEMENT",b1:{h:"Post",p:"Enforcement becomes automated with time locks and signatures.",u:["Multi-sig changes.","Time lock.","Public log.","Override limits."]},
                                 b2:{h:"Red-team",p:"Quarterly injections become mandatory for Tier ≥3.",u:["Monoculture shock.","Wave overload.","Seg collapse.","Audit delay."]},
                                 b3:{h:"Enterprise",p:"Enforcement integrates with CI/CD and change control.",u:["Wave gating.","Rollback checks.","Zone validation.","Audit pipelines."]},
                                 b4:{h:"Outcome",p:"A defensible enforcement layer that resists capture.",u:["Separation of powers.","Public transparency.","Hard constraints.","Stable meaning."]}},
            informal:{title:"ENFORCEMENT",b1:{h:"Next",p:"Automation + locks.",u:["Signatures.","Time locks.","Logs.","Overrides limited."]},
                                 b2:{h:"Red-team",p:"Mandatory testing.",u:["Shocks.","Overloads.","Collapse tests.","Audit delay."]},
                                 b3:{h:"Enterprise",p:"CI/CD gates.",u:["Wave caps.","Rollback checks.","Zones.","Audit pipeline."]},
                                 b4:{h:"Result",p:"Hard to capture.",u:["Separation.","Transparency.","Constraints.","Stable."]}}}
      },
      w:{
        origin:{formal:{title:"GOVERNANCE",b1:{h:"Separation of powers",p:"Different roles cannot tune outcomes or thresholds.",u:["Engineering builds.","Authority issues.","Commercial sells.","Audit verifies."]},
                                   b2:{h:"Freeze window",p:"No threshold relaxation during freeze window.",u:["Lock thresholds.","Allow clarifications only.","Changelog required.","Time-lock changes."]},
                                   b3:{h:"Survival boundary",p:"Define W ∩ S = 0 boundary by domain map.",u:["Define survival components.","Measure pay-to-prioritize.","Bound W_S.","Publish violations."]},
                                   b4:{h:"Public audit",p:"No silent revocations and no silent exclusions.",u:["Publish reason codes.","Publish status.","Publish exclusions.","Audit logs."]}},
            informal:{title:"GOVERNANCE",b1:{h:"Roles",p:"Different people do different things.",u:["Builders build.","Issuers issue.","Sellers sell.","Auditors audit."]},
                                   b2:{h:"Freeze",p:"No relaxing rules.",u:["Lock thresholds.","Log changes.","No silent edits.","Time-lock."]},
                                   b3:{h:"Boundary",p:"No pay-to-prioritize in survival systems.",u:["Define survival map.","Measure W_S.","Publish issues.","Enforce."]},
                                   b4:{h:"Public",p:"No silent actions.",u:["Status visible.","Reasons visible.","Exclusions visible.","Audits visible."]}}},
        now:{formal:{title:"GOVERNANCE",b1:{h:"Now",p:"Governance is expressed as stable pages + registry-ready logic.",u:["Uniform pages.","Uniform language.","Uniform keys.","Uniform contracts."]},
                                b2:{h:"Anti-capture rule",p:"No single group can change thresholds or outcomes.",u:["Multi-sig.","Time lock.","Public log.","Audit cross-check."]},
                                b3:{h:"Neutrality",p:"Language remains technical and operational, not ideological.",u:["No metaphysics.","No moral framing.","Just constraints.","Just measures."]},
                                b4:{h:"Outcome",p:"Governance supports public reintroduction safely.",u:["Stable UI.","Dense bulletins.","Bilingual.","Upgradeable."]}},
            informal:{title:"GOVERNANCE",b1:{h:"Now",p:"Governance is stable.",u:["Pages.","Keys.","Contracts.","Registry-ready."]},
                                b2:{h:"No capture",p:"Nobody can tune outcomes quietly.",u:["Locks.","Logs.","Audits.","Cross-checks."]},
                                b3:{h:"Neutral",p:"Technical language only.",u:["No ideology.","No preaching.","Just rules.","Just measures."]},
                                b4:{h:"Result",p:"Safe to publish.",u:["Stable.","Dense.","Bilingual.","Ready."]}}},
        post:{formal:{title:"GOVERNANCE",b1:{h:"Post",p:"Governance becomes the backbone of certification and underwriting.",u:["Public registry.","Third-party audits.","Evidence hashes.","Subscription interfaces."]},
                                 b2:{h:"Entropy index",p:"Track override frequency and threshold change attempts.",u:["Override logs.","Auto downgrades.","Audit requirements.","Stability flags."]},
                                 b3:{h:"Global deployment",p:"Governance maps to institutions and policy.",u:["Utilities.","Data centers.","Industry.","Financial infra."]},
                                 b4:{h:"Outcome",p:"A resilient governance layer that scales.",u:["Capture resistance.","Auditability.","Clarity.","Trust."]}},
            informal:{title:"GOVERNANCE",b1:{h:"Next",p:"Registry + audits.",u:["Public status.","Audits.","Hashes.","Subscriptions."]},
                                 b2:{h:"Entropy",p:"Track overrides.",u:["Logs.","Flags.","Downgrades.","Audits."]},
                                 b3:{h:"Scale",p:"Institution adoption.",u:["Utilities.","Cloud.","Industry.","Finance."]},
                                 b4:{h:"Result",p:"Trust at scale.",u:["Resists capture.","Auditable.","Clear.","Stable."]}}}
      }
    };
    const v = EN[dir][time][style];
    return v;
  }

  var active=null;

  function setActiveDiamond(id){
    ["north","east","south","west"].forEach(function(x){
      document.getElementById(x).classList.toggle("active", x===id);
    });
  }

  function open(dir){
    active=dir;
    setActiveDiamond(dir);
    render();
    bd.classList.add("show");
    modal.classList.add("show");
  }

  function close(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    setActiveDiamond("__none__");
    active=null;
  }

  function render(){
    persist();
    setLinks();
    setLensLabels();

    var v = view(active);
    mTitle.textContent = v.title;
    fill(h1,p1,u1,v.b1);
    fill(h2,p2,u2,v.b2);
    fill(h3,p3,u3,v.b3);
    fill(h4,p4,u4,v.b4);
  }

  // Lens labels
  setLensLabels();

  // Wire diamonds
  ["north","east","south","west"].forEach(function(id){
    var el=document.getElementById(id);
    el.onclick=function(){ open(id); };
    el.onkeydown=function(e){ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); open(id);} };
  });

  // Lens controls
  styleChip.onclick=function(){ style = (style==="formal") ? "informal" : "formal"; render(); };
  chipConcept.onclick=function(){ time="origin"; render(); };
  chipNow.onclick=function(){ time="now"; render(); };
  chipPost.onclick=function(){ time="post"; render(); };

  // Close controls
  bd.onclick=close;
  mClose.onclick=close;
  document.getElementById("mReturn").onclick=close;

  // Init
  setLinks();
})();
</script>

</body>
</html>
