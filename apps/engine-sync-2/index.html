<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Engine Sync (v2) · Geodiametrics</title>
  <style>
    :root{
      --fg:#e9eefc;
      --muted:rgba(233,238,252,.72);
      --stroke:rgba(233,238,252,.14);
      --panel:rgba(10,14,26,.68);
      --glass:rgba(8,12,26,.55);
      --chip:rgba(10,14,26,.60);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--fg);
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      overflow-x:hidden;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(120,150,255,.18), transparent 60%),
        radial-gradient(1000px 700px at 80% 70%, rgba(255,120,200,.14), transparent 65%),
        linear-gradient(180deg, #050816, #060b1e);
    }
    body::before{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(2px 2px at 12% 18%, rgba(255,255,255,.95), transparent 60%),
        radial-gradient(1px 1px at 22% 72%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(2px 2px at 38% 32%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(1px 1px at 48% 86%, rgba(255,255,255,.85), transparent 60%),
        radial-gradient(2px 2px at 66% 28%, rgba(255,255,255,.9), transparent 60%),
        radial-gradient(1px 1px at 78% 58%, rgba(255,255,255,.85), transparent 60%),
        radial-gradient(2px 2px at 92% 22%, rgba(255,255,255,.9), transparent 60%);
      opacity:.55;
      z-index:-2;
    }
    body::after{
      content:"";
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(1100px 380px at 55% 55%, rgba(120,180,255,.10), transparent 75%),
        radial-gradient(900px 280px at 48% 52%, rgba(255,190,220,.08), transparent 78%);
      opacity:.9;
      z-index:-1;
      filter:blur(1px);
    }

    header{
      position:sticky; top:0; z-index:10;
      border-bottom:1px solid var(--stroke);
      background:var(--glass);
      backdrop-filter:blur(10px);
    }
    .bar{
      max-width:1100px;
      margin:0 auto;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{font-weight:900;letter-spacing:.35px}
    .navBubbles{display:flex;flex-wrap:wrap;gap:10px;justify-content:flex-end}
    .pill{
      display:inline-flex;align-items:center;justify-content:center;
      padding:10px 14px;border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(10,14,26,.55);
      color:var(--muted);text-decoration:none;font-weight:800
    }
    .pill:hover{color:var(--fg)}

    main{max-width:1100px;margin:0 auto;padding:34px 16px 70px}
    h1{margin:10px 0 10px;font-size:44px;letter-spacing:.2px}
    .sub{max-width:78ch;color:var(--muted);line-height:1.7;margin:0 0 22px}

    .grid{display:grid;gap:16px;grid-template-columns:repeat(auto-fit,minmax(320px,1fr))}
    .card{
      background:var(--panel);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:18px;
      box-shadow:0 14px 36px rgba(0,0,0,.35);
    }
    .card h2{margin:0 0 8px;font-size:20px;letter-spacing:.2px}
    .card p{margin:0 0 14px;color:var(--muted);line-height:1.6}

    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .chip{
      display:inline-flex;align-items:center;justify-content:center;
      padding:10px 12px;border-radius:999px;
      border:1px solid var(--stroke);
      background:var(--chip);
      color:var(--fg);
      font-weight:900;
    }
    .chip.muted{color:var(--muted);font-weight:800}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      padding:12px 16px;border-radius:999px;
      border:1px solid var(--stroke);
      background:rgba(10,14,26,.60);
      color:var(--fg);
      font-weight:900;
      letter-spacing:.2px;
      cursor:pointer;
      text-decoration:none;
    }
    .btn:hover{filter:brightness(1.05)}
    .btn.small{padding:10px 12px;font-weight:800}
    .btn.on{outline:2px solid rgba(233,238,252,.18)}
    .divider{height:1px;background:rgba(233,238,252,.12);margin:14px 0}
    footer{
      max-width:1100px;margin:0 auto;
      padding:18px 16px 26px;
      border-top:1px solid var(--stroke);
      color:rgba(233,238,252,.55);
      text-align:center;
    }
    .kv{display:grid;grid-template-columns:auto 1fr;gap:8px 12px;color:var(--muted)}
    .k{color:rgba(233,238,252,.55);font-weight:800}
    .v{color:var(--fg);font-weight:900}
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">Geodiametrics</div>
      <div class="navBubbles">
        <a class="pill" href="/">Home</a>
        <a class="pill" href="/methods/">Methods</a>
        <a class="pill" href="/dashboard/">Dashboard</a>
        <a class="pill" href="/apps/">Apps</a>
        <a class="pill" href="/reference/">Reference</a>
        <a class="pill" href="/problem/">Problem</a>
      </div>
    </div>
  </header>

  <main>
    <h1>Engine Sync (v2)</h1>
    <p class="sub">
      Second engine instance with an independent local state namespace. Use this for parallel runs, A/B execution, and clean resets without touching v1.
    </p>

    <div class="grid">
      <!-- Continuation -->
      <section class="card" aria-label="Continuation">
        <h2>CONTINUATION</h2>
        <p>Persistent execution state. Reload-safe. Operator-controlled.</p>

        <div class="row" style="margin-bottom:10px">
          <span class="chip muted">Current</span>
          <span class="chip" id="cycleChip">—</span>
          <span class="chip muted">Last set</span>
          <span class="chip" id="cycleTs">—</span>
        </div>

        <div class="row">
          <button class="btn small" data-cycle="RUNNING">1 · RUNNING</button>
          <button class="btn small" data-cycle="HURDLE">2 · HURDLE</button>
          <button class="btn small" data-cycle="WALL">3 · WALL</button>
          <button class="btn small" data-cycle="COMPLETE">4 · COMPLETE</button>
        </div>

        <div class="divider"></div>
        <p style="margin:0;color:var(--muted)">
          RUNNING = executing (reduce/contrast/condense/dedup/improve).<br/>
          HURDLE = friction; continue internally; no escalation.<br/>
          WALL = proven blocker; notify; await decision.<br/>
          COMPLETE = stable minimal state; advance cycle.
        </p>
      </section>

      <!-- Selection -->
      <section class="card" aria-label="Selection">
        <h2>SELECTION</h2>
        <p>Admissibility gate. Inputs must satisfy constraints to enter the engine.</p>

        <div class="row">
          <button class="btn" id="selAdmit">Submit Admissible Input</button>
          <button class="btn" id="selReject">Submit Rejected Input</button>
        </div>

        <div class="divider"></div>
        <div class="kv">
          <div class="k">Selection</div><div class="v" id="selVal">—</div>
        </div>
      </section>

      <!-- Resolution -->
      <section class="card" aria-label="Resolution">
        <h2>RESOLUTION</h2>
        <p>Minimal structural completion. One admitted input resolves.</p>

        <div class="row">
          <button class="btn" id="doResolve">Resolve</button>
          <button class="btn" id="resetResolve">Reset Resolution</button>
        </div>

        <div class="divider"></div>
        <div class="kv">
          <div class="k">Resolution</div><div class="v" id="resVal">—</div>
        </div>
      </section>

      <!-- Commitment -->
      <section class="card" aria-label="Commitment">
        <h2>COMMITMENT</h2>
        <p>No rollback once committed.</p>

        <div class="row">
          <button class="btn" id="doCommit">Commit</button>
          <button class="btn" id="resetAll">Reset Engine</button>
        </div>

        <div class="divider"></div>
        <div class="kv">
          <div class="k">Commitment</div><div class="v" id="comVal">—</div>
        </div>

        <div class="divider"></div>
        <p style="margin:0;color:var(--muted)">
          Rule: Commit is admissible only when Selection=ADMITTED and Resolution=RESOLVED.
        </p>
      </section>
    </div>
  </main>

  <footer>© 2026 Geodiametrics · Engine Sync (v2)</footer>

  <script>
    (function(){
      // Independent namespace for v2
      const NS = "GM_ENGINE_V2";

      const S = {
        cycle: "RUNNING",
        cycleTs: null,
        selection: null,    // "ADMITTED" | "REJECTED"
        resolution: null,   // "RESOLVED"
        commitment: null    // "COMMITTED"
      };

      function load(){
        try{
          const raw = localStorage.getItem(NS);
          if(!raw) return;
          const obj = JSON.parse(raw);
          Object.assign(S, obj || {});
        }catch(e){}
      }
      function save(){
        try{ localStorage.setItem(NS, JSON.stringify(S)); }catch(e){}
      }
      function isoNow(){ return new Date().toISOString(); }

      const elCycleChip = document.getElementById("cycleChip");
      const elCycleTs   = document.getElementById("cycleTs");
      const elSelVal    = document.getElementById("selVal");
      const elResVal    = document.getElementById("resVal");
      const elComVal    = document.getElementById("comVal");

      function render(){
        elCycleChip.textContent = S.cycle || "—";
        elCycleTs.textContent   = S.cycleTs || "—";
        elSelVal.textContent    = S.selection || "—";
        elResVal.textContent    = S.resolution || "—";
        elComVal.textContent    = S.commitment || "—";

        document.querySelectorAll("[data-cycle]").forEach(b=>{
          b.classList.toggle("on", b.getAttribute("data-cycle") === S.cycle);
        });
      }

      // Continuation controls
      document.querySelectorAll("[data-cycle]").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          S.cycle = btn.getAttribute("data-cycle");
          S.cycleTs = isoNow();
          save(); render();
        });
      });

      // Selection
      document.getElementById("selAdmit").addEventListener("click", ()=>{
        S.selection = "ADMITTED";
        save(); render();
      });
      document.getElementById("selReject").addEventListener("click", ()=>{
        S.selection = "REJECTED";
        // Reset downstream automatically
        S.resolution = null;
        S.commitment = null;
        save(); render();
      });

      // Resolution
      document.getElementById("doResolve").addEventListener("click", ()=>{
        if(S.selection !== "ADMITTED"){
          alert("Resolution blocked: Selection must be ADMITTED.");
          return;
        }
        S.resolution = "RESOLVED";
        save(); render();
      });
      document.getElementById("resetResolve").addEventListener("click", ()=>{
        S.resolution = null;
        S.commitment = null;
        save(); render();
      });

      // Commitment
      document.getElementById("doCommit").addEventListener("click", ()=>{
        if(S.selection !== "ADMITTED"){
          alert("Commit blocked: Selection must be ADMITTED.");
          return;
        }
        if(S.resolution !== "RESOLVED"){
          alert("Commit blocked: Resolution must be RESOLVED.");
          return;
        }
        S.commitment = "COMMITTED";
        save(); render();
      });

      // Full reset
      document.getElementById("resetAll").addEventListener("click", ()=>{
        S.selection = null;
        S.resolution = null;
        S.commitment = null;
        save(); render();
      });

      load();
      // If empty, initialize timestamp once
      if(!S.cycleTs) S.cycleTs = isoNow();
      save();
      render();
    })();
  </script>
</body>
</html>
