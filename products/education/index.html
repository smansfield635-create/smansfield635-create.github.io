<!-- TNT — /products/education/index.html
     PRODUCTS · EDUCATION
     UNIVERSAL PRODUCT MODEL (LOCKED):
       4 QUADRANTS → QUADRANT MODAL (3 DOMAINS + RETURN) → DOMAIN MODAL:
         - Tone toggle: FORMAL / INFORMAL
         - 3 bubbles: CONCEPT / LIVE / ROADMAP (tap-to-open)
     LANGUAGE:
       - EN / 中文 / ES (single-language per page via gd_lang)
     STATE:
       - URL: lang/style/time/depth
       - LS: gd_lang/gd_style/gd_time/gd_depth
     LOCKS:
       - Uses /assets/ui.css + /assets/branch.css + /assets/instruments.js
       - No html/body background overrides
       - Tap-safe (no inline onclick)
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PRODUCTS · EDUCATION</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>
<script defer src="/assets/instruments.js"></script>

<style>
a{color:inherit;text-decoration:none}
:root{
  --R:150px;
  --D:184px;
  --goldSoft:rgba(212,175,55,.45);
  --obsA:rgba(12,22,38,.95);
  --obsB:rgba(6,10,16,.98);
  --mut:rgba(255,255,255,.90);
  --mut2:rgba(255,255,255,.74);
}

/* base */
body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
body::before,body::after{pointer-events:none!important}

/* top */
.top-left{
  position:fixed;left:16px;top:16px;z-index:140;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}
.brand{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  z-index:130;text-align:center;
  padding:10px 18px;border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.18);
  pointer-events:none;
}
.brand .t{font-weight:950;font-size:40px;letter-spacing:.25px;line-height:1.05;margin:0}
.brand .s{opacity:.86;font-size:14px;margin:6px 0 0;line-height:1.25}

/* stage */
.stage{
  position:fixed;left:50%;top:56%;
  transform:translate(-50%,-50%);
  width:min(720px,94vw);
  height:min(720px,94vw);
  z-index:60;
}
.outer{
  position:absolute;left:50%;top:50%;
  width:min(680px,92vw);height:min(680px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;opacity:.62;pointer-events:none;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.14), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.42) 0%, rgba(7,11,18,.58) 70%);
  box-shadow:
    0 90px 260px rgba(0,0,0,.55),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -50px 90px rgba(0,0,0,.55);
}
.outer::after{
  content:"";position:absolute;inset:0;border-radius:60px;opacity:.12;pointer-events:none;
  background:repeating-conic-gradient(from 0deg, rgba(255,255,255,.04) 0deg 6deg, transparent 6deg 18deg);
}

/* glossy diamond */
.d{
  width:var(--D);height:var(--D);
  position:absolute;left:50%;top:50%;
  transform-origin:center;border-radius:28px;
  cursor:pointer;pointer-events:auto;touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;
  background:
    radial-gradient(circle at 30% 22%, rgba(255,255,255,.55), transparent 45%),
    radial-gradient(circle at 70% 78%, rgba(0,120,255,.30), transparent 60%),
    linear-gradient(160deg, var(--obsA), var(--obsB));
  border:1px solid rgba(255,255,255,.16);
  box-shadow:
    0 38px 120px rgba(0,0,0,.85),
    0 0 32px rgba(212,175,55,.28),
    inset 0 2px 0 rgba(255,255,255,.25),
    inset 0 -42px 78px rgba(0,0,0,.80);
  transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  overflow:hidden;
}
.d::before{
  content:"";position:absolute;inset:0;border-radius:28px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.65;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.d::after{
  content:"";position:absolute;left:10%;right:10%;top:10%;height:28%;
  border-radius:999px;
  background:linear-gradient(to bottom, rgba(255,255,255,.25), rgba(255,255,255,0));
  transform:rotate(-10deg);
  pointer-events:none;
}
.d:hover{
  transform:translate(-50%,-50%) rotate(45deg) scale(1.02);
  border-color:rgba(212,175,55,.35);
  box-shadow:
    0 44px 140px rgba(0,0,0,.92),
    0 0 44px rgba(212,175,55,.32),
    inset 0 2px 0 rgba(255,255,255,.28),
    inset 0 -46px 86px rgba(0,0,0,.84);
}
.d:active{transform:translate(-50%,-50%) rotate(45deg) scale(.99)}

.d-n{transform:translate(-50%,-50%) translate(0, calc(var(--R)*-1)) rotate(45deg)}
.d-e{transform:translate(-50%,-50%) translate(var(--R),0) rotate(45deg)}
.d-s{transform:translate(-50%,-50%) translate(0,var(--R)) rotate(45deg)}
.d-w{transform:translate(-50%,-50%) translate(calc(var(--R)*-1),0) rotate(45deg)}

.inner{
  transform:rotate(-45deg) translateY(-3px);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  text-align:center;height:100%;padding:14px;gap:8px;
  pointer-events:none;user-select:none;
}
.lab{font-weight:950;font-size:18px;letter-spacing:.6px;text-shadow:0 0 16px rgba(255,255,255,.14)}
.sub{font-size:13px;opacity:.88;line-height:1.25;max-width:18em}

.core{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:60px;height:60px;border-radius:18px;
  background:rgba(0,0,0,.20);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 18px 44px rgba(0,0,0,.55), inset 0 2px 0 rgba(255,255,255,.10);
  display:grid;place-items:center;
  pointer-events:none;
}

/* dock */
.dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:120;width:min(980px,94vw);
  display:flex;justify-content:center;gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  pointer-events:none;
}
.dock .btn{pointer-events:auto}

/* overlay + modals */
.bd{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.72);backdrop-filter:blur(10px);display:none}
.bd.show{display:block}
.modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);width:min(1180px,96vw);height:90vh;display:none;z-index:210}
.modal.show{display:block}
.shell{height:90vh;border-radius:22px;border:1px solid rgba(255,255,255,.14);background:linear-gradient(160deg, rgba(10,18,30,.96), rgba(6,10,16,.98));overflow:hidden;display:flex;flex-direction:column}
.mhead{display:flex;justify-content:space-between;align-items:center;gap:10px;padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08)}
.mtitle{margin:0;font-weight:950;letter-spacing:.3px;font-size:16px}
.mclose{border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;padding:8px 10px}
.mbody{padding:16px;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}

.hint{max-width:980px;margin:0 auto 12px;padding:10px 12px;border-radius:16px;border:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.16);color:rgba(255,255,255,.80);font-size:12.5px;line-height:1.45}
.qgrid{display:grid;gap:14px;grid-template-columns:1fr}
@media (min-width:760px){.qgrid{grid-template-columns:1fr 1fr}}
.smallDiamond{
  width:100%;height:140px;position:relative;border-radius:22px;
  cursor:pointer;pointer-events:auto;touch-action:manipulation;
  background:
    radial-gradient(circle at 30% 22%, rgba(255,255,255,.50), transparent 52%),
    radial-gradient(circle at 70% 78%, rgba(0,120,255,.26), transparent 62%),
    linear-gradient(160deg, rgba(14,24,40,.96), rgba(7,11,18,.98));
  border:1px solid rgba(255,255,255,.16);
  box-shadow:0 22px 70px rgba(0,0,0,.70), inset 0 2px 0 rgba(255,255,255,.22), inset 0 -34px 60px rgba(0,0,0,.70);
}
.smallDiamond::before{
  content:"";position:absolute;inset:0;border-radius:22px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;mask-composite:exclude;
  pointer-events:none;
}
.sdInner{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:14px;pointer-events:none}
.sdT{font-weight:950;letter-spacing:.25px}
.sdS{font-size:12.5px;opacity:.82;margin-top:6px}

.lensbar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:0 0 14px}
.pill{
  padding:10px 14px;border-radius:999px;
  background:linear-gradient(145deg, rgba(17,22,28,.92), rgba(11,15,20,.96));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 14px 36px rgba(0,0,0,.65);
  cursor:pointer;font-weight:900;letter-spacing:.2px;color:#fff;user-select:none;
  -webkit-tap-highlight-color:transparent;
}
.pill.active{border-color:rgba(212,175,55,.60);box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px rgba(212,175,55,.22)}

.bubble{
  border:1px solid rgba(255,255,255,.10);
  border-radius:18px;
  background:rgba(255,255,255,.05);
  padding:14px 14px 12px;
  margin:0 0 12px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
}
.bubble h4{margin:0 0 8px;font-weight:950;letter-spacing:.15px}
.bubble p{margin:0;color:var(--mut2);line-height:1.65;display:none}
.bubble.open p{display:block}

@media (max-width:560px){
  :root{--R:136px;--D:170px}
  .stage{top:54%}
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnBack" href="/products/">BACK</a>
  <a class="btn" id="btnExit" href="/index.html">EXIT</a>
</div>

<div class="brand" aria-hidden="true">
  <div class="t" id="hdrT">Education</div>
  <div class="s" id="hdrS">Programs · Language · Training · Certification</div>
</div>

<div class="stage" aria-label="Education quadrants">
  <div class="outer"></div>

  <div class="d d-n" id="qPrograms" role="button" tabindex="0"><div class="inner"><div class="lab" id="labN">PROGRAMS</div><div class="sub" id="subN">Tracks · outcomes · routines</div></div></div>
  <div class="d d-e" id="qLanguage" role="button" tabindex="0"><div class="inner"><div class="lab" id="labE">LANGUAGE</div><div class="sub" id="subE">Core 1001 · practice</div></div></div>
  <div class="d d-s" id="qTraining" role="button" tabindex="0"><div class="inner"><div class="lab" id="labS">TRAINING</div><div class="sub" id="subS">Masterclasses · reps</div></div></div>
  <div class="d d-w" id="qCertification" role="button" tabindex="0"><div class="inner"><div class="lab" id="labW">CERTIFICATION</div><div class="sub" id="subW">Evidence · tiers</div></div></div>

  <div class="core">◆</div>
</div>

<nav class="dock" aria-label="Bottom navigation">
  <a class="btn" id="dockProducts" href="/products/">PRODUCTS</a>
  <a class="btn" id="dockExplore" href="/explore/">EXPLORE</a>
  <a class="btn" id="dockLaws" href="/laws/">LAWS</a>
  <a class="btn" id="dockGauges" href="/gauges/">GAUGES</a>
</nav>

<div class="bd" id="bd"></div>

<!-- Quadrant Modal -->
<div class="modal" id="quadModal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="quadTitle">EDUCATION</h3>
      <button class="mclose" id="quadClose" aria-label="Close" type="button">✕</button>
    </div>
    <div class="mbody">
      <div class="hint" id="quadHint">Tap a domain to read Concept / Live / Roadmap. Return closes this layer.</div>
      <div class="qgrid" id="quadGrid"></div>
    </div>
  </div>
</div>

<!-- Domain Modal -->
<div class="modal" id="domainModal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="domainTitle">EDUCATION · Domain</h3>
      <button class="mclose" id="domainClose" aria-label="Close" type="button">✕</button>
    </div>
    <div class="mbody">
      <div class="lensbar">
        <div class="pill active" id="toneFormal">FORMAL</div>
        <div class="pill" id="toneInformal">INFORMAL</div>
      </div>

      <div class="hint" id="domainHint">These narratives evolve by time (Concept → Live → Roadmap) and by tone (Formal vs Informal).</div>

      <div class="bubble" id="bConcept"><h4 id="hConcept">Concept</h4><p id="pConcept"></p></div>
      <div class="bubble" id="bLive"><h4 id="hLive">Live</h4><p id="pLive"></p></div>
      <div class="bubble" id="bRoadmap"><h4 id="hRoadmap">Roadmap</h4><p id="pRoadmap"></p></div>
    </div>
  </div>
</div>

<script>
(function(){
  // state
  var qs=new URLSearchParams(location.search);
  var lang  = qs.get("lang")  || localStorage.getItem("gd_lang")  || "en";
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  var depth = qs.get("depth") || localStorage.getItem("gd_depth") || "explore";
  if(time==="trajectory") time="post";
  if(lang!=="en" && lang!=="zh" && lang!=="es") lang="en";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";
  if(depth!=="explore" && depth!=="learn") depth="explore";
  try{
    localStorage.setItem("gd_lang",lang);
    localStorage.setItem("gd_style",style);
    localStorage.setItem("gd_time",time);
    localStorage.setItem("gd_depth",depth);
  }catch(e){}
  document.documentElement.lang=(lang==="zh")?"zh":(lang==="es")?"es":"en";

  function q(){
    var p=new URLSearchParams();
    p.set("lang",lang); p.set("style",style); p.set("time",time); p.set("depth",depth);
    return "?"+p.toString();
  }

  // nav
  document.getElementById("btnBack").href="/products/"+q();
  document.getElementById("btnExit").href="/index.html"+q();
  document.getElementById("dockProducts").href="/products/"+q();
  document.getElementById("dockExplore").href="/explore/"+q();
  document.getElementById("dockLaws").href="/laws/"+q();
  document.getElementById("dockGauges").href="/gauges/"+q();

  // i18n (single-language)
  var UI={
    en:{
      hdrT:"Education", hdrS:"Programs · Language · Training · Certification",
      q:{N:["PROGRAMS","Tracks · outcomes · routines"],E:["LANGUAGE","Core 1001 · practice"],S:["TRAINING","Masterclasses · reps"],W:["CERTIFICATION","Evidence · tiers"]},
      hintA:"Tap a domain to read Concept / Live / Roadmap. Return closes this layer.",
      hintB:"These narratives evolve by time (Concept → Live → Roadmap) and by tone (Formal vs Informal).",
      concept:"Concept", live:"Live", roadmap:"Roadmap", formal:"FORMAL", informal:"INFORMAL",
      ret:"RETURN", dom:"Concept · Live · Roadmap"
    },
    zh:{
      hdrT:"教育", hdrS:"课程 · 语言 · 训练 · 认证",
      q:{N:["课程体系","路径 · 成果 · 例程"],E:["语言","核心1001 · 练习"],S:["训练","大师课 · 反复练"],W:["认证","证据 · 分层"]},
      hintA:"点选域阅读：概念 / 上线 / 路线图。返回会关闭本层。",
      hintB:"内容随时间（概念→上线→路线图）与语气（正式/通俗）演进。",
      concept:"概念", live:"上线", roadmap:"路线图", formal:"正式", informal:"通俗",
      ret:"返回", dom:"概念 · 上线 · 路线图"
    },
    es:{
      hdrT:"Educación", hdrS:"Programas · Lenguaje · Formación · Certificación",
      q:{N:["PROGRAMAS","Rutas · resultados · rutinas"],E:["LENGUAJE","1001 · práctica"],S:["FORMACIÓN","Clases · repeticiones"],W:["CERTIFICACIÓN","Evidencia · niveles"]},
      hintA:"Toca un dominio para leer Concepto / En vivo / Hoja de ruta. RETURN cierra esta capa.",
      hintB:"El contenido evoluciona por tiempo (Concepto → En vivo → Hoja de ruta) y por tono (Formal vs Informal).",
      concept:"Concepto", live:"En vivo", roadmap:"Hoja de ruta", formal:"FORMAL", informal:"INFORMAL",
      ret:"RETURN", dom:"Concepto · En vivo · Hoja de ruta"
    }
  };
  var T = (lang==="zh")?UI.zh:(lang==="es")?UI.es:UI.en;
  document.getElementById("hdrT").textContent=T.hdrT;
  document.getElementById("hdrS").textContent=T.hdrS;
  document.getElementById("labN").textContent=T.q.N[0]; document.getElementById("subN").textContent=T.q.N[1];
  document.getElementById("labE").textContent=T.q.E[0]; document.getElementById("subE").textContent=T.q.E[1];
  document.getElementById("labS").textContent=T.q.S[0]; document.getElementById("subS").textContent=T.q.S[1];
  document.getElementById("labW").textContent=T.q.W[0]; document.getElementById("subW").textContent=T.q.W[1];
  document.getElementById("quadHint").textContent=T.hintA;
  document.getElementById("domainHint").textContent=T.hintB;
  document.getElementById("hConcept").textContent=T.concept;
  document.getElementById("hLive").textContent=T.live;
  document.getElementById("hRoadmap").textContent=T.roadmap;
  document.getElementById("toneFormal").textContent=T.formal;
  document.getElementById("toneInformal").textContent=T.informal;

  // model: 4 quadrants × 3 domains
  var QUADS={
    PROGRAMS:["Curriculum Map","Daily Routines","Checkpoints"],
    LANGUAGE:["Core 1001","Four Levels","Practice Loops"],
    TRAINING:["Masterclasses","Train the Trainer","Rubrics"],
    CERTIFICATION:["Evidence Verification","Tier System","Integrity Discipline"]
  };

  // text generator (evolutive, not merged)
  function textFor(domain, tone, phase){
    // phase: concept/live/roadmap
    // tone: formal/informal
    var d = domain;
    if(lang==="zh"){
      var base={
        "Curriculum Map":"课程地图","Daily Routines":"每日例程","Checkpoints":"检查点",
        "Core 1001":"核心1001词","Four Levels":"四级结构","Practice Loops":"练习循环",
        "Masterclasses":"大师课","Train the Trainer":"培训讲师","Rubrics":"评分规",
        "Evidence Verification":"证据验证","Tier System":"分层体系","Integrity Discipline":"防作弊纪律"
      }[d] || d;
      if(tone==="formal"){
        if(phase==="concept") return "【"+base+"】以可重复的结构表达学习目标：输入被约束，输出可核查，路径可返回。概念层强调：先定义，再训练，再验证，避免“学会了”的幻觉。";
        if(phase==="live") return "【"+base+"】上线层强调可执行：每次练习都有边界、计时不作闸门、结果可复现。你看到的是可操作流程，而不是描述性文字。";
        return "【"+base+"】路线图层强调扩展但不漂移：增加域包与双语一致性，同时保持同一套结构与评估规则，使规模化学习保持稳定。";
      }else{
        if(phase==="concept") return "【"+base+"】先把路画出来，你才不会学着学着迷路：知道学什么、怎么练、怎么算真的会。";
        if(phase==="live") return "【"+base+"】现在就是“能用”：少废话，多练习；每一步都清楚，你做完就知道有没有进步。";
        return "【"+base+"】以后会更大更爽：更多场景包、更多练习法，但你永远不会被改规则搞糊涂。";
      }
    }
    if(lang==="es"){
      if(tone==="formal"){
        if(phase==="concept") return "["+d+"] define una estructura repetible: entradas acotadas, salidas verificables y retorno estable. Concepto: definir → practicar → verificar, sin deriva semántica.";
        if(phase==="live") return "["+d+"] opera con ejecución: rutinas cortas, criterios claros y resultados reproducibles. Lo importante es lo medible, no la narrativa.";
        return "["+d+"] escala sin cambiar reglas: más dominios y bilingüismo consistente, manteniendo la misma arquitectura y evaluación.";
      }else{
        if(phase==="concept") return "["+d+"] es el mapa para no perderte: sabes qué aprender, cómo practicar y cómo comprobarlo.";
        if(phase==="live") return "["+d+"] es “útil hoy”: menos charla, más repeticiones; sales con una mejora real.";
        return "["+d+"] luego crece sin volverse confuso: más packs, misma estructura, misma claridad.";
      }
    }
    // en
    if(tone==="formal"){
      if(phase==="concept") return "["+d+"] defines a repeatable structure: bounded inputs, verifiable outputs, and stable return paths. Concept emphasizes define → practice → verify to prevent drift.";
      if(phase==="live") return "["+d+"] runs as execution: short routines, clear checkpoints, and reproducible results. Live emphasizes what is measurable, not what is promised.";
      return "["+d+"] scales without changing the contract: more domains and bilingual parity while preserving the same structure and evaluation rules.";
    }else{
      if(phase==="concept") return "["+d+"] is the map so you don’t get lost: what to learn, how to practice, and how to know it’s real.";
      if(phase==="live") return "["+d+"] is usable today: fewer words, more reps, and you can feel the improvement quickly.";
      return "["+d+"] grows without confusion: more packs, same structure, same clarity, no moving goalposts.";
    }
  }

  // refs
  var bd=document.getElementById("bd");
  var quadModal=document.getElementById("quadModal");
  var domainModal=document.getElementById("domainModal");
  var quadClose=document.getElementById("quadClose");
  var domainClose=document.getElementById("domainClose");
  var quadTitle=document.getElementById("quadTitle");
  var quadGrid=document.getElementById("quadGrid");
  var domainTitle=document.getElementById("domainTitle");
  var toneFormal=document.getElementById("toneFormal");
  var toneInformal=document.getElementById("toneInformal");
  var bConcept=document.getElementById("bConcept");
  var bLive=document.getElementById("bLive");
  var bRoadmap=document.getElementById("bRoadmap");
  var pConcept=document.getElementById("pConcept");
  var pLive=document.getElementById("pLive");
  var pRoadmap=document.getElementById("pRoadmap");

  var currentQuad=null;
  var currentDomain=null;
  var tone="formal";

  function showBD(){bd.classList.add("show")}
  function hideBD(){bd.classList.remove("show")}
  function closeAll(){quadModal.classList.remove("show");domainModal.classList.remove("show");hideBD()}

  function openQuad(qname){
    currentQuad=qname;
    quadTitle.textContent = (lang==="zh") ? ("教育 · "+T.q[qname==="PROGRAMS"?"N":qname==="LANGUAGE"?"E":qname==="TRAINING"?"S":"W"][0])
                    : (lang==="es") ? ("EDUCACIÓN · "+qname)
                    : ("EDUCATION · "+qname);
    quadGrid.innerHTML="";
    var domains=QUADS[qname]||[];
    domains.forEach(function(d){
      var tile=document.createElement("div");
      tile.className="smallDiamond";
      tile.setAttribute("role","button");
      tile.tabIndex=0;
      tile.innerHTML='<div class="sdInner"><div class="sdT">'+d+'</div><div class="sdS">'+T.dom+'</div></div>';
      function act(){ openDomain(d); }
      tile.addEventListener("click", act);
      tile.addEventListener("keydown", function(e){ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); act(); }});
      quadGrid.appendChild(tile);
    });

    var ret=document.createElement("div");
    ret.className="smallDiamond";
    ret.setAttribute("role","button");
    ret.tabIndex=0;
    ret.innerHTML='<div class="sdInner"><div class="sdT">'+T.ret+'</div><div class="sdS">—</div></div>';
    function r(){ closeAll(); }
    ret.addEventListener("click", r);
    ret.addEventListener("keydown", function(e){ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); r(); }});
    quadGrid.appendChild(ret);

    showBD(); quadModal.classList.add("show");
    domainModal.classList.remove("show");
  }

  function openDomain(dname){
    currentDomain=dname;
    domainTitle.textContent = (lang==="zh") ? ("教育 · "+dname) : (lang==="es") ? ("EDUCACIÓN · "+dname) : ("EDUCATION · "+dname);
    // reset bubbles
    [bConcept,bLive,bRoadmap].forEach(function(b){ b.classList.remove("open"); });
    applyTone(tone);
    quadModal.classList.remove("show");
    showBD(); domainModal.classList.add("show");
  }

  function applyTone(t){
    tone=t;
    toneFormal.classList.toggle("active", tone==="formal");
    toneInformal.classList.toggle("active", tone==="informal");
    pConcept.textContent = textFor(currentDomain, tone, "concept");
    pLive.textContent    = textFor(currentDomain, tone, "live");
    pRoadmap.textContent = textFor(currentDomain, tone, "roadmap");
  }

  function bindBubble(box){
    box.tabIndex=0; box.setAttribute("role","button");
    box.addEventListener("click", function(){ box.classList.toggle("open"); });
    box.addEventListener("keydown", function(e){ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); box.classList.toggle("open"); }});
  }
  bindBubble(bConcept); bindBubble(bLive); bindBubble(bRoadmap);

  // close wiring
  quadClose.addEventListener("click", closeAll);
  domainClose.addEventListener("click", closeAll);
  bd.addEventListener("click", closeAll);
  quadModal.addEventListener("click", function(e){ e.stopPropagation(); });
  domainModal.addEventListener("click", function(e){ e.stopPropagation(); });

  toneFormal.addEventListener("click", function(){ applyTone("formal"); });
  toneInformal.addEventListener("click", function(){ applyTone("informal"); });

  function bindQuad(elId, quad){
    var el=document.getElementById(elId);
    function act(){ openQuad(quad); }
    el.addEventListener("click", act);
    el.addEventListener("keydown", function(e){ if(e.key==="Enter"||e.key===" "){ e.preventDefault(); act(); }});
  }
  bindQuad("qPrograms","PROGRAMS");
  bindQuad("qLanguage","LANGUAGE");
  bindQuad("qTraining","TRAINING");
  bindQuad("qCertification","CERTIFICATION");

})();
</script>

</body>
</html>
