<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Door · Geodiametrics</title>

<link rel="stylesheet" href="/assets/ui.css?v=9004"/>
<link rel="stylesheet" href="/assets/branch.css?v=9004"/>
</head>

<body>
<div class="page">
  <div class="wrap">

    <div class="hero" style="text-align:center;">
      <h1>DOOR</h1>
      <p style="margin-top:12px;">Choose your route.</p>
      <div class="pill" style="margin-top:12px; display:inline-block;">
        LANG: <span id="langLabel">EN</span>
      </div>

      <div style="margin-top:12px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
        <div class="pill btn" id="setEN">EN</div>
        <div class="pill btn" id="setZH">中文</div>
        <a class="pill btn" href="/">BACK</a>
      </div>
    </div>

    <div class="stage" style="margin-top:18px;">
      <div class="platform">

        <a class="diamond top gold" id="goExplore" href="/home/?depth=explore">
          <span><b>Explore</b><small>Surface</small></span>
        </a>

        <a class="diamond right" id="goLearn" href="/home/?depth=learn">
          <span><b>Learn</b><small>Deep</small></span>
        </a>

        <a class="diamond bottom" id="goHome" href="/home/">
          <span><b>Home</b><small>Enter hub</small></span>
        </a>

        <a class="diamond left" id="goLinks" href="/links/">
          <span><b>Links</b><small>Identity</small></span>
        </a>

      </div>
    </div>

    <div class="ink">GEODIAMETRICS</div>
    <footer>CANONICAL · STABLE · © GEODIAMETRICS</footer>

  </div>
</div>

<script>
(() => {
  const qs = new URLSearchParams(location.search || "");
  const normalize = (x) => (String(x||"").toLowerCase().startsWith("zh") ? "zh" : "en");

  const saved = (() => { try { return localStorage.getItem("crp_lang"); } catch(e){ return null; } })();
  const initial = normalize(qs.get("lang") || saved || "en");

  const langLabel = document.getElementById("langLabel");

  function stamp(url, lang){
    const u = new URL(url, location.origin);
    u.searchParams.set("lang", lang);
    return u.pathname + "?" + u.searchParams.toString();
  }

  function apply(lang){
    lang = normalize(lang);
    try { localStorage.setItem("crp_lang", lang); } catch(e){}

    langLabel.textContent = (lang === "zh" ? "中文" : "EN");

    // active pills
    document.getElementById("setEN").classList.toggle("active", lang === "en");
    document.getElementById("setZH").classList.toggle("active", lang === "zh");

    // stamp routes forward
    document.getElementById("goExplore").href = stamp("/home/?depth=explore", lang);
    document.getElementById("goLearn").href = stamp("/home/?depth=learn", lang);
    document.getElementById("goHome").href = stamp("/home/", lang);
    document.getElementById("goLinks").href = stamp("/links/", lang);
  }

  document.getElementById("setEN").addEventListener("click", () => apply("en"));
  document.getElementById("setZH").addEventListener("click", () => apply("zh"));

  apply(initial);

  // keep URL consistent (so bookmarks stay correct)
  const u = new URL(location.href);
  u.searchParams.set("lang", initial);
  history.replaceState(null, "", u.toString());
})();
</script>
</body>
</html>
