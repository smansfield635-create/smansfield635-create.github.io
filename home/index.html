<!-- TNT: /home/index.html
     COMPLETE REWRITE (HUB)
     - Reads GD_LANG + GD_DEPTH
     - Depth controls content:
         SHOP  = surface tiles only
         LEARN = deep nested bubbles (details inside details)
     - Same geometry always: Quadrants (NW/NE/SW/SE) + Plate (N/E/S/W)
     - No jargon in subtitle.
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Home · Geodiametrics</title>

<link rel="stylesheet" href="/assets/ui.css?v=6000"/>
<link rel="stylesheet" href="/assets/branch.css?v=6000"/>

<style>
html,body{height:100%}
body{
  background:
    radial-gradient(1200px 800px at 50% 10%, rgba(160,20,20,.55) 0%, rgba(30,0,0,.55) 35%, rgba(5,7,12,1) 100%);
}

/* Layout */
.wrap{width:min(980px,94vw);display:flex;flex-direction:column;gap:14px;margin:0 auto}
.h{text-align:left;width:min(980px,94vw);margin:0 auto 8px;position:relative;z-index:10}
.h h1{margin:0;font-size:56px;font-weight:900}
.h p{margin:10px 0 0;font-size:20px;opacity:.78}

/* Top pills: show current language + depth + controls */
.topbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:flex-start;position:relative;z-index:10}
.pill{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:999px;background:rgba(0,0,0,.22);border:1px solid rgba(255,255,255,.10);box-shadow:0 18px 46px rgba(0,0,0,.45);font-weight:900;letter-spacing:.08em}
.pill a{text-decoration:none;color:inherit}
.pill-btn{cursor:pointer;user-select:none}
.pill-btn:active{transform:translateY(1px)}
.pill.on{background:rgba(255,255,255,.10);border-color:rgba(255,255,255,.14)}

/* Quadrants */
.section-title{margin-top:8px;font-size:12px;letter-spacing:.22em;text-transform:uppercase;opacity:.55;position:relative;z-index:10}
.quad{display:flex;flex-direction:column;gap:12px;position:relative;z-index:10}
.q{border-radius:22px;background:rgba(0,0,0,.18);border:1px solid rgba(255,255,255,.10);box-shadow:0 26px 70px rgba(0,0,0,.55);overflow:hidden}
.q > summary{list-style:none;cursor:pointer;padding:14px 14px;display:flex;align-items:center;gap:12px}
.q > summary::-webkit-details-marker{display:none}
.qb{min-width:46px;height:30px;display:inline-flex;align-items:center;justify-content:center;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.10);font-weight:900;letter-spacing:.10em}
.qt{font-weight:900}
.qs{opacity:.70;margin-left:auto;text-align:right}
.qbody{padding:0 14px 14px}

/* SHOP tiles (surface) */
.tiles{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:10px}
@media(max-width:720px){.tiles{grid-template-columns:1fr}}
.tile{border-radius:18px;background:rgba(0,0,0,.22);border:1px solid rgba(255,255,255,.08);padding:14px 14px}
.tile b{display:block;font-weight:900}
.tile p{margin:6px 0 0;opacity:.78;line-height:1.55}
.tile a{display:inline-flex;margin-top:10px;padding:10px 12px;border-radius:999px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.10);font-weight:900}

/* LEARN bubbles (deep) */
.tree{display:flex;flex-direction:column;gap:10px;margin-top:10px}
.node{border-radius:18px;background:rgba(0,0,0,.22);border:1px solid rgba(255,255,255,.08);overflow:hidden}
.node > summary{list-style:none;cursor:pointer;padding:14px 14px;display:flex;align-items:center;justify-content:space-between;gap:12px;font-weight:900;letter-spacing:.04em}
.node > summary::-webkit-details-marker{display:none}
.node .hint{opacity:.70;font-weight:800;font-size:12px;letter-spacing:.12em}
.nodeBody{padding:0 14px 14px;opacity:.90;line-height:1.6}
.nodeBody ul{margin:8px 0 0;padding-left:18px}
.nodeBody li{margin:6px 0}
.nodeBody .links{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
.nodeBody .links a{padding:10px 12px;border-radius:999px;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.10);font-weight:900}

/* Plate */
.plateTitle{margin-top:12px}
.stage{margin-top:6px}
.platform{width:min(420px,88vw)}
footer{margin-top:18px}
</style>
</head>

<body class="theme-red">
<div class="shooting-stars"></div>

<div class="page">
  <div class="wrap">

    <div class="h">
      <h1 id="ttl">Home</h1>
      <p id="sub">Pick a direction. Go deeper when you want.</p>
    </div>

    <div class="topbar">
      <div class="pill" id="statePill">EN · SHOP</div>
      <div class="pill pill-btn" id="btnShop">Shop</div>
      <div class="pill pill-btn" id="btnLearn">Learn</div>
      <div class="pill"><a href="/door/">Door</a></div>
      <div class="pill"><a href="/">Change language</a></div>
    </div>

    <div class="section-title" id="qTitle">Quadrants</div>

    <!-- Quadrants (same, content changes by depth) -->
    <div class="quad">

      <details class="q">
        <summary><span class="qb">NW</span><span class="qt" id="nwT">Northwest</span><span class="qs" id="nwS">Structure</span></summary>
        <div class="qbody" id="nwBody"></div>
      </details>

      <details class="q">
        <summary><span class="qb">NE</span><span class="qt" id="neT">Northeast</span><span class="qs" id="neS">Surfaces</span></summary>
        <div class="qbody" id="neBody"></div>
      </details>

      <details class="q">
        <summary><span class="qb">SW</span><span class="qt" id="swT">Southwest</span><span class="qs" id="swS">Measurement</span></summary>
        <div class="qbody" id="swBody"></div>
      </details>

      <details class="q">
        <summary><span class="qb">SE</span><span class="qt" id="seT">Southeast</span><span class="qs" id="seS">Identity</span></summary>
        <div class="qbody" id="seBody"></div>
      </details>

    </div>

    <div class="section-title plateTitle" id="pTitle">Main routes</div>

    <div class="stage">
      <div class="platform">
        <a class="diamond top" href="/laws/"><span id="pN">Laws<small id="pN2">Categories</small></span></a>
        <a class="diamond right" href="/products/"><span id="pE">Products<small id="pE2">Suite</small></span></a>
        <a class="diamond bottom" href="/gauges/"><span id="pS">Gauges<small id="pS2">Instruments</small></span></a>
        <a class="diamond left" href="/links/"><span id="pW">Links<small id="pW2">Identity</small></span></a>
        <a class="diamond mini mini-left" href="/"><span><small id="mL">ROOT</small></span></a>
        <a class="diamond mini mini-right" href="/rgsc/"><span><small id="mR">RGSC</small></span></a>
      </div>
    </div>

    <footer>CANONICAL · STABLE · © GEODIAMETRICS</footer>

  </div>
</div>

<script>
(() => {
  let lang = (localStorage.getItem("GD_LANG") || "en").toLowerCase();
  let depth = (localStorage.getItem("GD_DEPTH") || "shop").toLowerCase();

  const zh = () => lang === "zh";

  const setDepth = (d) => {
    depth = d;
    try{ localStorage.setItem("GD_DEPTH", d); }catch(e){}
    render();
  };

  document.getElementById("btnShop").addEventListener("click", () => setDepth("shop"));
  document.getElementById("btnLearn").addEventListener("click", () => setDepth("learn"));

  function tile(title, desc, href){
    return `
      <div class="tile">
        <b>${escapeHtml(title)}</b>
        <p>${escapeHtml(desc)}</p>
        ${href ? `<a href="${href}">${zh() ? "打开" : "Open"}</a>` : ""}
      </div>
    `;
  }

  function node(title, hint, bodyHtml){
    return `
      <details class="node">
        <summary>
          <span>${escapeHtml(title)}</span>
          <span class="hint">${escapeHtml(hint)}</span>
        </summary>
        <div class="nodeBody">${bodyHtml}</div>
      </details>
    `;
  }

  function render(){
    // Header copy
    document.getElementById("ttl").textContent = zh() ? "主页" : "Home";
    document.getElementById("sub").textContent = zh()
      ? "选择方向。想深入就点学习。"
      : "Pick a direction. Go deeper when you want.";

    document.getElementById("statePill").textContent =
      (zh() ? "中文" : "EN") + " · " + (depth === "learn" ? (zh() ? "学习" : "LEARN") : (zh() ? "浏览" : "SHOP"));

    document.getElementById("btnShop").classList.toggle("on", depth === "shop");
    document.getElementById("btnLearn").classList.toggle("on", depth === "learn");

    document.getElementById("qTitle").textContent = zh() ? "象限" : "Quadrants";
    document.getElementById("pTitle").textContent = zh() ? "主路线" : "Main routes";

    // Quadrant titles
    document.getElementById("nwT").textContent = zh() ? "西北" : "Northwest";
    document.getElementById("neT").textContent = zh() ? "东北" : "Northeast";
    document.getElementById("swT").textContent = zh() ? "西南" : "Southwest";
    document.getElementById("seT").textContent = zh() ? "东南" : "Southeast";

    document.getElementById("nwS").textContent = zh() ? "结构" : "Structure";
    document.getElementById("neS").textContent = zh() ? "界面" : "Surfaces";
    document.getElementById("swS").textContent = zh() ? "测量" : "Measurement";
    document.getElementById("seS").textContent = zh() ? "身份" : "Identity";

    // Plate labels
    document.getElementById("pN").childNodes[0].nodeValue = zh() ? "法则" : "Laws";
    document.getElementById("pN2").textContent = zh() ? "分类" : "Categories";
    document.getElementById("pE").childNodes[0].nodeValue = zh() ? "产品" : "Products";
    document.getElementById("pE2").textContent = zh() ? "套件" : "Suite";
    document.getElementById("pS").childNodes[0].nodeValue = zh() ? "量表" : "Gauges";
    document.getElementById("pS2").textContent = zh() ? "工具" : "Instruments";
    document.getElementById("pW").childNodes[0].nodeValue = zh() ? "链接" : "Links";
    document.getElementById("pW2").textContent = zh() ? "身份" : "Identity";
    document.getElementById("mL").textContent = zh() ? "根" : "ROOT";
    document.getElementById("mR").textContent = "RGSC";

    // Content rendering: SHOP = tiles only; LEARN = nested bubbles
    const nw = document.getElementById("nwBody");
    const ne = document.getElementById("neBody");
    const sw = document.getElementById("swBody");
    const se = document.getElementById("seBody");

    if(depth === "shop"){
      nw.innerHTML = `<div class="tiles">
        ${tile(zh()?"SSG":"SSG", zh()?"语法与规范":"Syntax & specs","/laws/")}
        ${tile(zh()?"DOT.GRID":"DOT.GRID", zh()?"256索引":"256 indexing","/laws/")}
        ${tile(zh()?"术语表":"Glossary", zh()?"缩略语与定义":"Acronyms & definitions","/links/")}
        ${tile(zh()?"结构规则":"Grammar", zh()?"导航规则":"Navigation rules","/home/")}
      </div>`;

      ne.innerHTML = `<div class="tiles">
        ${tile(zh()?"产品":"Products", zh()?"套件与工具":"Suites & tools","/products/")}
        ${tile("PLASMA", zh()?"能源执行":"Energy execution","/products/plasma/")}
        ${tile("RGSC", zh()?"回执与验证":"Receipts & verify","/rgsc/")}
        ${tile(zh()?"下载":"Downloads", zh()?"资料包":"Packs","/products/")}
      </div>`;

      sw.innerHTML = `<div class="tiles">
        ${tile(zh()?"量表":"Gauges", zh()?"测量面板":"Measurement panels","/gauges/")}
        ${tile(zh()?"诊断":"Diagnostics", zh()?"检测与分类":"Detect & classify","/diagnostic/")}
        ${tile(zh()?"规则":"Rules", zh()?"一致性标准":"Integrity standards","/laws/")}
        ${tile(zh()?"回放":"Replay", zh()?"验证输出":"Replay outputs","/rgsc/")}
      </div>`;

      se.innerHTML = `<div class="tiles">
        ${tile("OSF", zh()?"项目注册":"Project registry","/links/")}
        ${tile("ORCID", zh()?"身份锚点":"Identity anchor","/links/")}
        ${tile(zh()?"联系":"Contact", zh()?"直接通道":"Direct channel","/contact/")}
        ${tile(zh()?"引用":"References", zh()?"外部链接":"External links","/links/")}
      </div>`;
    } else {
      nw.innerHTML = `<div class="tree">
        ${node(zh()?"SSG（简化语法几何）":"SSG (Simplified Syntax Geometry)", zh()?"深度":"DEPTH",
          `<p>${zh()?"约束语言：资源/存储/约束/目标/守卫。":"Constraint language: Resources/Stores/Constraints/Goals/Guards."}</p>
           <ul>
            <li>${zh()?"规则：无回执不前进。":"Rule: no advance without receipt."}</li>
            <li>${zh()?"用途：把行为压缩成可审计结构。":"Use: compress behavior into auditable structure."}</li>
           </ul>
           <div class="links"><a href="/laws/">${zh()?"打开法则":"Open Laws"}</a><a href="/links/">${zh()?"打开链接":"Open Links"}</a></div>`)}
        ${node(zh()?"DOT.GRID（256态）":"DOT.GRID (256 states)", zh()?"深度":"DEPTH",
          `<p>${zh()?"每条证据/回执都能路由到一个状态坐标。":"Route evidence/receipts to a stable state coordinate."}</p>
           <ul><li>${zh()?"状态=定位":"State = location"}</li><li>${zh()?"定位=可复现":"Location = reproducible"}</li></ul>`)}
        ${node(zh()?"缩略语与术语表":"Acronyms & Glossary", zh()?"列表":"LIST",
          `<p>${zh()?"这里将列出所有缩略语（按支柱分类）。":"This will list all acronyms (bucketed by pillars)."}</p>
           <ul><li>SSG</li><li>DOT.GRID</li><li>RGSC</li><li>…</li></ul>
           <div class="links"><a href="/links/">${zh()?"打开链接":"Open Links"}</a></div>`)}
      </div>`;

      ne.innerHTML = `<div class="tree">
        ${node(zh()?"产品拆解":"Product Breakdown", zh()?"深度":"DEPTH",
          `<p>${zh()?"按类别拆解：能源/语言/治理/工具。":"Break down by category: energy/language/governance/tools."}</p>
           <ul>
            <li>${zh()?"能源：Solar → Plasma":"Energy: Solar → Plasma"}</li>
            <li>${zh()?"语言：1001词体系":"Language: 1,001-word system"}</li>
            <li>${zh()?"治理：回执与验证":"Governance: receipts & verification"}</li>
           </ul>
           <div class="links"><a href="/products/">${zh()?"打开产品":"Open Products"}</a></div>`)}
        ${node(zh()?"1001词体系":"1,001-word system", zh()?"四部分":"4 PARTS",
          `<ul>
            <li>${zh()?"词汇分类（名词/动词/形容词/功能词）":"Vocabulary buckets (n/v/adj/function)"}</li>
            <li>${zh()?"10类别":"10 categories"}</li>
            <li>${zh()?"4等级":"4 levels"}</li>
            <li>${zh()?"示例与练习":"Examples & drills"}</li>
           </ul>`)}
        ${node("RGSC", zh()?"深度":"DEPTH",
          `<p>${zh()?"回执、验证、回放。":"Receipts, verify, replay."}</p>
           <div class="links"><a href="/rgsc/">${zh()?"打开RGSC":"Open RGSC"}</a></div>`)}
      </div>`;

      sw.innerHTML = `<div class="tree">
        ${node(zh()?"量表":"Gauges", zh()?"深度":"DEPTH",
          `<p>${zh()?"每个量表都是一个可重复的测量面。":"Each gauge is a repeatable measurement surface."}</p>
           <div class="links"><a href="/gauges/">${zh()?"打开量表":"Open Gauges"}</a></div>`)}
        ${node(zh()?"诊断":"Diagnostics", zh()?"深度":"DEPTH",
          `<p>${zh()?"分类、检测、约束下判断。":"Classify, detect, judge under constraint."}</p>
           <div class="links"><a href="/diagnostic/">${zh()?"打开诊断":"Open Diagnostic"}</a></div>`)}
        ${node(zh()?"规则":"Rules", zh()?"清单":"CHECKLIST",
          `<ul>
            <li>${zh()?"一次一选":"One choice at a time"}</li>
            <li>${zh()?"不完整就返回枢纽":"Return to hub if incomplete"}</li>
            <li>${zh()?"无回执不前进":"No receipt, no advance"}</li>
           </ul>`)}
      </div>`;

      se.innerHTML = `<div class="tree">
        ${node("OSF", zh()?"锚点":"ANCHOR",
          `<p>${zh()?"公开注册与预印本。":"Registry and preprints."}</p>
           <div class="links"><a href="/links/">${zh()?"打开链接":"Open Links"}</a></div>`)}
        ${node("ORCID", zh()?"锚点":"ANCHOR",
          `<p>${zh()?"身份与署名。":"Identity and attribution."}</p>`)}
        ${node(zh()?"联系":"Contact", zh()?"通道":"CHANNEL",
          `<p>${zh()?"直接联系入口。":"Direct contact entry."}</p>
           <div class="links"><a href="/contact/">${zh()?"打开联系":"Open Contact"}</a></div>`)}
      </div>`;
    }

    // close all quadrants on render
    document.querySelectorAll(".q").forEach(d => d.open = false);
  }

  function escapeHtml(s){
    return String(s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }

  render();
})();
</script>
</body>
</html>
