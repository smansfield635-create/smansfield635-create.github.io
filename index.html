<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Cardinal Axis · Terminal</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --gold: rgba(212,175,55,.90);
  --gold-soft: rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
  --ink:#ffffff;
  --mut:rgba(255,255,255,.82);
  --mut2:rgba(255,255,255,.68);
}

body{
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  background:
    radial-gradient(circle at 50% 40%, rgba(90,140,255,.10), transparent 60%),
    repeating-linear-gradient(45deg, rgba(255,255,255,.02) 0 1px, transparent 1px 100px),
    linear-gradient(180deg,#b00000 0%,#7a0000 60%,#550000 100%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  color:var(--ink);
}

.panel{
  width:min(860px,92vw);
  padding:52px 34px 40px;
  border-radius:30px;
  position:relative;

  background:
    radial-gradient(circle at 35% 25%, rgba(90,140,255,.12), transparent 55%),
    radial-gradient(circle at 70% 60%, rgba(0,120,255,.08), transparent 60%),
    linear-gradient(160deg,var(--obs2) 0%,var(--obs1) 60%);

  box-shadow:
    0 50px 140px rgba(0,0,0,.85),
    inset 0 2px 0 rgba(255,255,255,.12),
    inset 0 -40px 60px rgba(0,0,0,.65);

  border:1px solid rgba(255,255,255,.08);
}

.panel::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:30px;
  padding:1px;
  background:linear-gradient(135deg, var(--gold-soft), transparent 40%, transparent 60%, var(--gold-soft));
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}

h1{
  font-size:44px;
  margin:0 0 8px 0;
  text-align:center;
  letter-spacing:2px;
}
.subtitle{
  text-align:center;
  color:var(--mut);
  margin:0 0 28px 0;
}

.bubble-grid{
  display:grid;
  gap:18px;
}

.bubble{
  padding:18px 20px;
  border-radius:22px;
  position:relative;
  cursor:pointer;

  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.12), transparent 55%),
    linear-gradient(145deg,var(--obs2),var(--obs1));

  box-shadow:
    0 22px 65px rgba(0,0,0,.78),
    inset 0 2px 0 rgba(255,255,255,.10);

  border:1px solid rgba(255,255,255,.07);
}

.bubble::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:22px;
  padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--gold-soft) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}

.bubble:hover{
  box-shadow:
    0 26px 78px rgba(0,0,0,.86),
    0 0 18px rgba(212,175,55,.18),
    inset 0 2px 0 rgba(255,255,255,.12);
  border-color:rgba(212,175,55,.18);
}

.b-title{
  font-weight:950;
  letter-spacing:.2px;
  margin-bottom:6px;
}
.b-sub{
  color:var(--mut2);
  line-height:1.45;
}

.actions{
  margin-top:26px;
  display:flex;
  justify-content:center;
  gap:14px;
  flex-wrap:wrap;
}

.btn{
  padding:14px 22px;
  border-radius:16px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:white;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 16px 40px rgba(0,0,0,.65);
  text-decoration:none;
  transition:.25s ease;
  position:relative;
  font-weight:800;
  letter-spacing:.2px;
}

.btn::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:16px;
  padding:1px;
  background:linear-gradient(135deg, var(--gold-soft), transparent 60%);
  opacity:.6;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
}

.btn:hover{ box-shadow:0 22px 60px rgba(0,0,0,.85), 0 0 18px var(--gold-soft); }

.mini{
  text-align:center;
  margin-top:14px;
  color:rgba(255,255,255,.55);
  font-size:12px;
  letter-spacing:.8px;
}

/* ===== MODAL (Level 1 + Level 2) ===== */

.backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(8px);
  display:none;
  z-index:200;
}
.backdrop.show{display:block;}

.modal{
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(820px,92vw);
  display:none;
  z-index:210;
}
.modal.show{display:block;}

.modal-card{
  border-radius:26px;
  padding:22px 18px 18px;
  position:relative;

  background:
    radial-gradient(circle at 35% 25%, rgba(90,140,255,.10), transparent 55%),
    linear-gradient(160deg,var(--obs2) 0%,var(--obs1) 65%);

  box-shadow:0 55px 160px rgba(0,0,0,.92);
  border:1px solid rgba(255,255,255,.08);
}
.modal-card::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:26px;
  padding:1px;
  background:linear-gradient(135deg, var(--gold-soft), transparent 40%, transparent 60%, var(--gold-soft));
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}

.modal-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding:0 6px 10px;
  border-bottom:1px solid rgba(255,255,255,.08);
}

.modal-title{
  font-weight:950;
  letter-spacing:.3px;
  margin:0;
  font-size:16px;
}

.modal-close{
  border:0;
  background:transparent;
  color:#fff;
  font-size:18px;
  cursor:pointer;
  padding:8px 10px;
}

.subgrid{
  display:grid;
  gap:14px;
  margin-top:14px;
}

.subbubble{
  padding:16px 18px;
  border-radius:20px;
  position:relative;
  cursor:pointer;

  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.10), transparent 55%),
    linear-gradient(145deg,var(--obs2),var(--obs1));

  border:1px solid rgba(255,255,255,.07);
  box-shadow:0 18px 55px rgba(0,0,0,.78), inset 0 2px 0 rgba(255,255,255,.08);
}

.subbubble::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:20px;
  padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--gold-soft) 50%, transparent 100%);
  opacity:.5;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;
  pointer-events:none;
}

.subbubble:hover{ box-shadow:0 22px 65px rgba(0,0,0,.86), 0 0 14px rgba(212,175,55,.16); border-color:rgba(212,175,55,.16); }

.sub-title{ font-weight:950; margin:0 0 6px; letter-spacing:.2px; }
.sub-sub{ color:var(--mut2); line-height:1.45; margin:0; }

/* Level 2 detail view */
.detail{
  margin-top:14px;
  display:none;
}
.detail.show{display:block;}

.detail-box{
  padding:18px;
  border-radius:22px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 22px 70px rgba(0,0,0,.86), inset 0 2px 0 rgba(255,255,255,.08);
}

.detail-h{
  margin:0 0 10px 0;
  font-weight:950;
  letter-spacing:.2px;
  font-size:16px;
}

.detail-p{
  margin:0 0 12px 0;
  color:var(--mut);
  line-height:1.55;
}

.detail-ul{
  margin:0 0 12px 18px;
  padding:0;
  color:var(--mut2);
}
.detail-ul li{ margin:6px 0; }

.detail-actions{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:center;
  margin-top:10px;
}

.sbtn{
  padding:12px 18px;
  border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:white;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;
  font-weight:900;
}
.sbtn:hover{ box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 14px var(--gold-soft); }

@media (min-width:720px){
  .subgrid{ grid-template-columns:1fr 1fr; }
}
</style>
</head>

<body>
<div class="panel">
  <h1 id="tTitle">CARDINAL AXIS</h1>
  <div class="subtitle" id="tSub">Terminal · Structural Preface</div>

  <!-- Level 0: Primary bubbles -->
  <div class="bubble-grid" id="primaryBubbles"></div>

  <div class="actions">
    <a class="btn" id="btnHome" href="/home/">CONTINUE → HOME</a>
    <a class="btn" id="btnLinks" href="/links/">LINKS</a>
  </div>

  <div class="mini" id="miniKeys">KEYS: gd_lang · gd_depth · gd_style · gd_time</div>
</div>

<!-- Modal -->
<div class="backdrop" id="bd"></div>
<div class="modal" id="modal">
  <div class="modal-card">
    <div class="modal-head">
      <div class="modal-title" id="mTitle">SECTION</div>
      <button class="modal-close" id="mClose">✕</button>
    </div>

    <!-- Level 1: Sub-bubbles -->
    <div class="subgrid" id="subGrid"></div>

    <!-- Level 2: Detail -->
    <div class="detail" id="detail">
      <div class="detail-box">
        <div class="detail-h" id="dTitle"></div>
        <div class="detail-p" id="dPara"></div>
        <ul class="detail-ul" id="dList"></ul>

        <div class="detail-actions">
          <button class="sbtn" id="dBack">BACK</button>
          <button class="sbtn" id="dClose">BACK TO PAGE</button>
          <button class="sbtn" id="dPrev">PREV</button>
          <button class="sbtn" id="dNext">NEXT</button>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
(function(){
  // Lang: query wins, else storage, else en
  const qs = new URLSearchParams(location.search);
  const qLang = qs.get("lang");
  let lang = (qLang==="zh"||qLang==="en") ? qLang : (localStorage.getItem("gd_lang")==="zh" ? "zh" : "en");
  try{ localStorage.setItem("gd_lang", lang); }catch(e){}
  document.documentElement.lang = lang;

  const UI = {
    en:{
      title:"CARDINAL AXIS",
      sub:"Terminal · Structural Preface",
      keys:"KEYS: gd_lang · gd_depth · gd_style · gd_time",
      home:"CONTINUE → HOME",
      links:"LINKS",
      p:[
        {id:"construction", t:"Under construction (safe to explore).", s:"What is stable vs what is expanding."},
        {id:"how", t:"How this system works.", s:"Lenses → Compass → Directional depth."},
        {id:"expect", t:"What to expect moving forward.", s:"North/East/South/West deepen progressively."}
      ],
      sections:{
        construction:{
          title:"Under construction",
          items:[
            {k:"stability", t:"What is stable", s:"The structure won’t drift.", p:"Navigation and lens controls are stable and canonical.", li:["Routes remain consistent across updates.","State keys stay gd_* only.","UI changes won’t break meaning."]},
            {k:"safe", t:"Safe to explore", s:"No dead ends.", p:"You can browse without fear of breaking flows.", li:["Unfinished content shows placeholders.","Links route to known hubs.","No destructive actions exist."]},
            {k:"placeholders", t:"Placeholders", s:"Incomplete areas are marked.", p:"If a section isn’t built yet, it will be visibly incomplete rather than silently wrong.", li:["Clear “under construction” signals.","No misleading content.","Navigation remains usable."]},
            {k:"timeline", t:"What changes over time", s:"Content expands.", p:"The material layer grows while the structure stays fixed.", li:["More bubbles → more depth.","More examples and references.","More bilingual coverage."]}
          ]
        },
        how:{
          title:"How it works",
          items:[
            {k:"lenses", t:"Lenses", s:"Style + Time + Depth + Language.", p:"Lenses change presentation without changing structure.", li:["Style: Formal / Informal","Time: Origin / Now / Post","Depth: Explore / Learn","Language: EN / 中文"]},
            {k:"compass", t:"Compass face", s:"North/East/South/West.", p:"The compass is the interface for directional understanding.", li:["Tap a direction to open its bulletin.","Each direction becomes its own compass over time.","Return paths remain stable."]},
            {k:"state", t:"State keys", s:"gd_* only.", p:"State persists across pages through canonical keys.", li:["gd_lang","gd_depth","gd_style","gd_time"]},
            {k:"safety", t:"No drift rule", s:"Structure first.", p:"We treat structure as canonical; content is layered on top.", li:["No silent renames.","No duplicate meanings.","No broken topology."]}
          ]
        },
        expect:{
          title:"Moving forward",
          items:[
            {k:"dirs", t:"Direction meaning", s:"Four directions, four roles.", p:"Each direction encodes a function in the system.", li:["North stabilizes.","East executes.","South converges.","West contains."]},
            {k:"depth", t:"Depth expansion", s:"Explore → Learn.", p:"Explore gives short summaries; Learn gives full density.", li:["Surface-first browsing.","Deep dives when ready.","Consistent structure across both."]},
            {k:"bilingual", t:"Bilingual growth", s:"EN + 中文.", p:"English is primary; Chinese is canonical structural layer.", li:["Core pages bilingual.","Key terms bilingual.","Expansion continues."]},
            {k:"roadmap", t:"Roadmap", s:"More bubbles, more recursion.", p:"You’ll see each compass direction unfold into its own nested set.", li:["Sub-compasses per direction.","Fruits / resolutions per path.","Unified navigation everywhere."]}
          ]
        }
      },
      buttons:{back:"BACK", backPage:"BACK TO PAGE", prev:"PREV", next:"NEXT"}
    },
    zh:{
      title:"四向轴",
      sub:"终端 · 结构前言",
      keys:"键：gd_lang · gd_depth · gd_style · gd_time",
      home:"继续 → HOME",
      links:"链接",
      p:[
        {id:"construction", t:"施工中（可安全浏览）。", s:"哪些稳定，哪些扩展。"},
        {id:"how", t:"系统如何运作。", s:"透镜 → 指南针 → 方向深化。"},
        {id:"expect", t:"未来预期。", s:"北/东/南/西将逐步深化。"}
      ],
      sections:{
        construction:{
          title:"施工中",
          items:[
            {k:"stability", t:"哪些是稳定的", s:"结构不漂移。", p:"导航与透镜是稳定且规范的。", li:["路径结构保持一致。","状态键只用 gd_*。","UI变化不破坏含义。"]},
            {k:"safe", t:"可安全浏览", s:"不会走到死路。", p:"你可以放心浏览，不会破坏流程。", li:["未完成内容显示占位。","链接只指向已知枢纽。","无破坏性操作。"]},
            {k:"placeholders", t:"占位提示", s:"不完整会被标记。", p:"未构建区域会明确显示“施工中”，而不是悄悄出错。", li:["清晰提示。","避免误导。","导航仍可用。"]},
            {k:"timeline", t:"哪些会变化", s:"内容扩展。", p:"内容层增长，结构层保持不变。", li:["更多气泡与层级。","更多示例与引用。","更多双语覆盖。"]}
          ]
        },
        how:{
          title:"如何运作",
          items:[
            {k:"lenses", t:"透镜", s:"风格 + 时间 + 深度 + 语言。", p:"透镜改变呈现方式，不改变结构。", li:["风格：正式/非正式","时间：起源/当前/未来","深度：浏览/深入","语言：EN/中文"]},
            {k:"compass", t:"指南针面", s:"北/东/南/西。", p:"指南针是方向理解的入口。", li:["点方向打开公告。","每个方向会变成子指南针。","返回路径稳定。"]},
            {k:"state", t:"状态键", s:"仅 gd_*。", p:"状态在页面间通过规范键保持一致。", li:["gd_lang","gd_depth","gd_style","gd_time"]},
            {k:"safety", t:"不漂移规则", s:"结构优先。", p:"结构为规范层，内容在其上扩展。", li:["不静默改名。","不重复含义。","不破坏拓扑。"]}
          ]
        },
        expect:{
          title:"未来预期",
          items:[
            {k:"dirs", t:"方向含义", s:"四向四职能。", p:"每个方向对应系统中的一种作用。", li:["北：稳定","东：执行","南：汇聚","西：约束"]},
            {k:"depth", t:"深度扩展", s:"浏览 → 深入。", p:"浏览提供概览，深入提供完整密度。", li:["先概览。","需要时深入。","结构始终一致。"]},
            {k:"bilingual", t:"双语扩展", s:"EN + 中文。", p:"英文为主，中文为规范结构层。", li:["核心页面双语。","关键术语双语。","持续扩展。"]},
            {k:"roadmap", t:"路线图", s:"更多气泡，更多递归。", p:"每个方向会展开为嵌套路径与最终解析。", li:["方向子指南针。","果实/解析模块。","统一导航。"]}
          ]
        }
      },
      buttons:{back:"返回", backPage:"回到页面", prev:"上一个", next:"下一个"}
    }
  };

  const T = UI[lang] || UI.en;

  // Apply header + buttons
  document.getElementById("tTitle").textContent = T.title;
  document.getElementById("tSub").textContent = T.sub;
  document.getElementById("miniKeys").textContent = T.keys;
  document.getElementById("btnHome").textContent = T.home;
  document.getElementById("btnLinks").textContent = T.links;

  // Primary bubbles
  const primary = document.getElementById("primaryBubbles");
  primary.innerHTML = "";
  T.p.forEach(p=>{
    const div = document.createElement("div");
    div.className = "bubble";
    div.setAttribute("data-section", p.id);
    div.innerHTML = `<div class="b-title">${p.t}</div><div class="b-sub">${p.s}</div>`;
    primary.appendChild(div);
  });

  // Modal controls
  const bd = document.getElementById("bd");
  const modal = document.getElementById("modal");
  const mTitle = document.getElementById("mTitle");
  const mClose = document.getElementById("mClose");
  const subGrid = document.getElementById("subGrid");
  const detail = document.getElementById("detail");
  const dTitle = document.getElementById("dTitle");
  const dPara = document.getElementById("dPara");
  const dList = document.getElementById("dList");
  const dBack = document.getElementById("dBack");
  const dClose = document.getElementById("dClose");
  const dPrev = document.getElementById("dPrev");
  const dNext = document.getElementById("dNext");

  dBack.textContent = T.buttons.back;
  dClose.textContent = T.buttons.backPage;
  dPrev.textContent = T.buttons.prev;
  dNext.textContent = T.buttons.next;

  let currentSection = null;
  let currentIndex = 0;

  function openModal(sectionId){
    currentSection = sectionId;
    currentIndex = 0;
    mTitle.textContent = T.sections[sectionId].title;
    buildSub(sectionId);
    detail.classList.remove("show");
    bd.classList.add("show");
    modal.classList.add("show");
  }

  function closeModal(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    detail.classList.remove("show");
  }

  function buildSub(sectionId){
    const items = T.sections[sectionId].items;
    subGrid.innerHTML = "";
    items.forEach((it, idx)=>{
      const el = document.createElement("div");
      el.className = "subbubble";
      el.setAttribute("data-idx", String(idx));
      el.innerHTML = `<div class="sub-title">${it.t}</div><p class="sub-sub">${it.s}</p>`;
      el.addEventListener("click", ()=>openDetail(idx));
      subGrid.appendChild(el);
    });
  }

  function openDetail(idx){
    const items = T.sections[currentSection].items;
    currentIndex = idx;
    const it = items[idx];
    dTitle.textContent = it.t;
    dPara.textContent = it.p;
    dList.innerHTML = "";
    it.li.forEach(x=>{
      const li = document.createElement("li");
      li.textContent = x;
      dList.appendChild(li);
    });
    detail.classList.add("show");
  }

  function step(dir){
    const items = T.sections[currentSection].items;
    let n = currentIndex + dir;
    if(n < 0) n = items.length - 1;
    if(n >= items.length) n = 0;
    openDetail(n);
  }

  bd.addEventListener("click", closeModal);
  mClose.addEventListener("click", closeModal);
  dClose.addEventListener("click", closeModal);
  dBack.addEventListener("click", ()=>detail.classList.remove("show"));
  dPrev.addEventListener("click", ()=>step(-1));
  dNext.addEventListener("click", ()=>step(1));

  // Primary click
  primary.addEventListener("click", (e)=>{
    const bubble = e.target.closest(".bubble");
    if(!bubble) return;
    openModal(bubble.getAttribute("data-section"));
  });
})();
</script>

</body>
</html>
