<!-- TNT — /explore/innovation/language/grammar/traversal/structure/index.html
     PURPOSE:
       TRAVERSAL → STRUCTURE (consumer-legible)
       Page = 4 bubbles (diamond-of-diamonds)
       Click bubble = centered final modal with 4 bulletins (thorough + interesting)
     RULES:
       - TNT full file
       - ui.css owns field (no html/body background)
       - branch.css untouched
       - State propagation: lang/style/time preserved
       - Top-left: BACK + EXIT
       - Bottom dock: HUB + INNOVATION + PRODUCTS
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>TRAVERSAL · STRUCTURE</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  --R:124px;
  --goldSoft:rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
}

/* Top controls */
.top-left{
  position:fixed;
  left:16px;
  top:16px;
  z-index:90;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}

.btn{
  padding:10px 16px;
  border-radius:14px;
  background:linear-gradient(145deg,var(--obs2),var(--obs1));
  color:white;
  border:1px solid rgba(255,255,255,.08);
  box-shadow:0 14px 36px rgba(0,0,0,.7);
  cursor:pointer;
  font-weight:900;
  letter-spacing:.2px;
  text-decoration:none;
}
.btn:hover{
  box-shadow:0 18px 50px rgba(0,0,0,.9),0 0 14px var(--goldSoft);
}

/* Stage */
.stage{
  position:fixed;
  left:50%;
  top:52%;
  transform:translate(-50%,-50%);
  width:min(560px,92vw);
  height:min(560px,92vw);
  z-index:40;
}

/* Outer gem shell (with subtle red undertone so it stays “in-world”) */
.outer{
  position:absolute;
  left:50%;top:50%;
  width:100%;height:100%;
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  background:
    radial-gradient(circle at 50% 18%, rgba(176,0,0,.18), transparent 60%),
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.14), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.55) 0%, rgba(7,11,18,.75) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 90px 260px rgba(0,0,0,.62),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -50px 90px rgba(0,0,0,.55);
  pointer-events:none;
  opacity:.75;
}

/* Bubble-diamonds (gem) */
.d{
  width:150px;height:150px;
  position:absolute;
  left:50%;top:50%;
  transform-origin:center;
  border-radius:26px;
  cursor:pointer;
  -webkit-tap-highlight-color:transparent;
  background:
    radial-gradient(circle at 35% 25%, rgba(255,255,255,.14), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.18), transparent 60%),
    linear-gradient(160deg, rgba(12,22,38,.92) 0%, rgba(7,11,18,.95) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 28px 84px rgba(0,0,0,.78),
    inset 0 2px 0 rgba(255,255,255,.14),
    inset 0 -28px 44px rgba(0,0,0,.62);
  transition:transform .2s ease, box-shadow .2s ease;
}
.d:hover{
  transform:translate(-50%,-50%) rotate(45deg) scale(1.02);
  box-shadow:
    0 34px 110px rgba(0,0,0,.88),
    0 0 18px rgba(212,175,55,.18);
}

.d-n{ transform:translate(-50%,-50%) translate(0, calc(var(--R) * -1)) rotate(45deg); }
.d-e{ transform:translate(-50%,-50%) translate(var(--R), 0) rotate(45deg); }
.d-s{ transform:translate(-50%,-50%) translate(0, var(--R)) rotate(45deg); }
.d-w{ transform:translate(-50%,-50%) translate(calc(var(--R) * -1), 0) rotate(45deg); }

.inner{
  width:100%;height:100%;
  transform:rotate(-45deg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  padding:16px;
  gap:10px;
  user-select:none;
}

.lab{font-weight:950;letter-spacing:.8px;font-size:16px;}
.sub{font-size:13px;opacity:.86;line-height:1.35;max-width:18em;}

/* Center core */
.core{
  position:absolute;
  left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:64px;height:64px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  box-shadow:0 18px 44px rgba(0,0,0,.62);
  display:grid;
  place-items:center;
  font-weight:950;
  opacity:.92;
  pointer-events:none;
}

/* Bottom dock */
.dock{
  position:fixed;
  left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;
  width:min(900px,94vw);
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  padding:10px 12px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.20);
  backdrop-filter:blur(8px);
}

/* Modal */
.bd{
  position:fixed;
  inset:0;
  z-index:200;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(10px);
  display:none;
}
.bd.show{display:block;}

.modal{
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%);
  width:min(980px,94vw);
  max-height:86vh;
  z-index:210;
  display:none;
}
.modal.show{display:block;}

.shell{
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 50% 14%, rgba(176,0,0,.18), transparent 55%),
    radial-gradient(circle at 38% 28%, rgba(90,140,255,.10), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.95), rgba(7,11,18,.98));
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:auto;
  max-height:86vh;
  padding:18px;
}

.mhead{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  padding:10px 6px 14px;
  border-bottom:1px solid rgba(255,255,255,.08);
  margin-bottom:14px;
}
.mtitle{
  margin:0;
  font-weight:950;
  letter-spacing:.3px;
  font-size:16px;
}
.mclose{
  border:0;
  background:transparent;
  color:#fff;
  font-size:18px;
  cursor:pointer;
  padding:8px 10px;
}

.grid{
  display:grid;
  gap:14px;
}
@media(min-width:920px){
  .grid{ grid-template-columns:1fr 1fr; }
}

.box{
  border-radius:18px;
  padding:16px 16px 14px;
  background:rgba(0,0,0,.22);
  border:1px solid rgba(255,255,255,.08);
  box-shadow:inset 0 1px 0 rgba(255,255,255,.05);
}

.box h4{
  margin:0 0 10px;
  font-weight:950;
  letter-spacing:.2px;
  font-size:14px;
}

.box p{
  margin:0 0 10px;
  opacity:.88;
  line-height:1.55;
}

.box ul{
  margin:0;
  padding-left:18px;
  opacity:.85;
}
.box li{ margin:6px 0; }

.mact{
  display:flex;
  justify-content:center;
  gap:10px;
  flex-wrap:wrap;
  margin-top:14px;
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnBack" href="#">BACK</a>
  <a class="btn" id="btnExit" href="#">EXIT</a>
</div>

<div class="stage" aria-label="Traversal Structure bubbles">
  <div class="outer"></div>

  <div class="d d-n" role="button" tabindex="0" onclick="openModal('Anchor')">
    <div class="inner">
      <div class="lab">ANCHOR</div>
      <div class="sub">The “north star” that keeps meaning stable.</div>
    </div>
  </div>

  <div class="d d-e" role="button" tabindex="0" onclick="openModal('Paths')">
    <div class="inner">
      <div class="lab">PATHS</div>
      <div class="sub">How you move without getting lost.</div>
    </div>
  </div>

  <div class="d d-w" role="button" tabindex="0" onclick="openModal('Signals')">
    <div class="inner">
      <div class="lab">SIGNALS</div>
      <div class="sub">What the system watches and remembers.</div>
    </div>
  </div>

  <div class="d d-s" role="button" tabindex="0" onclick="openModal('Safety')">
    <div class="inner">
      <div class="lab">SAFETY</div>
      <div class="sub">How structure prevents drift and chaos.</div>
    </div>
  </div>

  <div class="core">◆</div>
</div>

<nav class="dock">
  <a class="btn" id="dockHub" href="#">HUB</a>
  <a class="btn" id="dockInnovation" href="#">INNOVATION</a>
  <a class="btn" id="dockProducts" href="#">PRODUCTS</a>
</nav>

<div class="bd" id="bd"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="modalTitle">DETAIL</h3>
      <button class="mclose" id="mClose" type="button" aria-label="Close">✕</button>
    </div>

    <!-- FINAL BLOCK: 4 BULLETINS -->
    <div class="grid">
      <div class="box">
        <h4>What it means</h4>
        <p id="b1p"></p>
        <ul id="b1u"></ul>
      </div>
      <div class="box">
        <h4>How it feels to use</h4>
        <p id="b2p"></p>
        <ul id="b2u"></ul>
      </div>
      <div class="box">
        <h4>Why it matters</h4>
        <p id="b3p"></p>
        <ul id="b3u"></ul>
      </div>
      <div class="box">
        <h4>What’s next</h4>
        <p id="b4p"></p>
        <ul id="b4u"></ul>
      </div>
    </div>

    <div class="mact">
      <button class="btn" id="mReturn" type="button">RETURN</button>
    </div>
  </div>
</div>

<script>
function getState(){
  const qs = new URLSearchParams(window.location.search);
  return {
    lang: qs.get("lang") || localStorage.getItem("gd_lang") || "en",
    style: qs.get("style") || localStorage.getItem("gd_style") || "formal",
    time: qs.get("time") || localStorage.getItem("gd_time") || "now"
  };
}

function q(){
  const s=getState();
  return "lang="+encodeURIComponent(s.lang)+"&style="+encodeURIComponent(s.style)+"&time="+encodeURIComponent(s.time);
}

function fillList(id, arr){
  const ul=document.getElementById(id);
  ul.innerHTML="";
  arr.forEach(t=>{
    const li=document.createElement("li");
    li.textContent=t;
    ul.appendChild(li);
  });
}

const CONTENT = {
  Anchor:{
    b1p:"Structure starts with a single anchor—one stable reference point that doesn’t change when the page changes.",
    b1u:["Names stay consistent.","The map stays readable.","You always know where you are.","You can always return."],
    b2p:"It feels like a compass that never lies—no matter how deep you go, the center still makes sense.",
    b2u:["Less scrolling.","Less hunting.","More clarity.","More confidence."],
    b3p:"Without an anchor, knowledge becomes noise. With an anchor, learning becomes fast and repeatable.",
    b3u:["Stops confusion loops.","Prevents “drift.”","Keeps language consistent.","Keeps navigation safe."],
    b4p:"As this grows, the anchor becomes a public standard: glossary + registry + stable definitions.",
    b4u:["Acronym registry.","Definition sheets.","Cross-links everywhere.","Printable references."]
  },
  Paths:{
    b1p:"Paths are the routes you can take that always behave the same way—like rails on a track.",
    b1u:["Routes carry your settings.","Back always returns.","No dead ends.","No surprise jumps."],
    b2p:"It feels like exploring a city with perfect signage—you can wander, but you can’t get lost.",
    b2u:["Tap, learn, return.","Open, read, close.","Move by curiosity.","Always oriented."],
    b3p:"Paths turn exploration into a consumer-friendly experience instead of a technical manual.",
    b3u:["More approachable.","More playful.","More memorable.","More shareable."],
    b4p:"Next we add richer route choices and “continue where you left off” behavior without chaos.",
    b4u:["Save position tokens.","Safe resume flow.","More branches.","Same structure."]
  },
  Signals:{
    b1p:"Signals are the small markers the system watches: language, lens, time layer—so content stays coherent.",
    b1u:["Language stays selected.","Style stays consistent.","Time layer stays consistent.","Pages don’t reset randomly."],
    b2p:"It feels personalized without being creepy—the site simply remembers how you were reading.",
    b2u:["Faster re-entry.","Less re-clicking.","Fewer settings.","Smoother flow."],
    b3p:"Signals are what make the whole experience feel like one continuous world—not separate pages.",
    b3u:["Uniform behavior.","Uniform look.","Uniform meaning.","Uniform navigation."],
    b4p:"Next we expose “why” only when you ask—keeping the surface simple but depth available.",
    b4u:["Consumer-first text.","Deep optional details.","Guided discovery.","No overload."]
  },
  Safety:{
    b1p:"Safety is the rule that structure must survive change—so new pages don’t break old pages.",
    b1u:["No mixed key namespaces.","No background ownership conflicts.","No hidden routing rules.","No silent overrides."],
    b2p:"It feels reliable—the site doesn’t “randomly change” or “randomly break.”",
    b2u:["Fewer bugs.","Fewer regressions.","Fewer rebuilds.","More momentum."],
    b3p:"Safety is what lets these innovations grow into a real product line without collapsing under complexity.",
    b3u:["Scale without drift.","Consistency under pressure.","Audit-ready structure.","Enterprise-ready discipline."],
    b4p:"Next we add more bubbles and stories, but the safety rules stay frozen.",
    b4u:["More content.","Same contract.","Same geometry.","Same standards."]
  }
};

function openModal(key){
  document.getElementById("modalTitle").textContent = "STRUCTURE · " + key.toUpperCase();

  document.getElementById("b1p").textContent = CONTENT[key].b1p;
  fillList("b1u", CONTENT[key].b1u);

  document.getElementById("b2p").textContent = CONTENT[key].b2p;
  fillList("b2u", CONTENT[key].b2u);

  document.getElementById("b3p").textContent = CONTENT[key].b3p;
  fillList("b3u", CONTENT[key].b3u);

  document.getElementById("b4p").textContent = CONTENT[key].b4p;
  fillList("b4u", CONTENT[key].b4u);

  document.getElementById("bd").classList.add("show");
  document.getElementById("modal").classList.add("show");
}

function closeModal(){
  document.getElementById("bd").classList.remove("show");
  document.getElementById("modal").classList.remove("show");
}

(function(){
  const s=getState();
  // persist canonical keys
  try{
    localStorage.setItem("gd_lang", s.lang);
    localStorage.setItem("gd_style", s.style);
    localStorage.setItem("gd_time", s.time);
  }catch(e){}

  // top nav
  document.getElementById("btnBack").href =
    "/explore/innovation/language/grammar/traversal/index.html?"+q();
  document.getElementById("btnExit").href =
    "/door/?"+q();

  // dock
  document.getElementById("dockHub").href =
    "/home/?"+q();
  document.getElementById("dockInnovation").href =
    "/explore/?"+q();
  document.getElementById("dockProducts").href =
    "/products/?"+q();

  // modal controls
  document.getElementById("bd").addEventListener("click", closeModal);
  document.getElementById("mClose").addEventListener("click", closeModal);
  document.getElementById("mReturn").addEventListener("click", closeModal);

  // keyboard accessibility
  ["Anchor","Paths","Signals","Safety"].forEach(function(k){
    // nothing needed; diamonds use onclick already
  });
})();
</script>

</body>
</html>
