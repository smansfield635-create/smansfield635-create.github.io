<!-- TNT — /explore/innovation/language/grammar/index.html
     GRAMMAR · Traversal Contracts (GEM STANDARD)
     CHANGE (PER YOUR NOTE):
     - KEEP: STYLE + (CONCEPT / NOW / ROADMAP) lenses INSIDE modal
     - REMOVE: the extra inner “FEELS / MATTERS / WORKS / NEXT” tab layer
     - Modal now shows ONLY: 4 bubbles (paragraphs) for the section you clicked
     - Outer diamond (HOW IT FEELS / WHY IT MATTERS / HOW IT WORKS / WHAT’S NEXT) stays as the ONLY section selector
     - Single-language render (EN OR 中文) via gd_lang / ?lang=
     - State propagation: lang/style/time carried through links
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GRAMMAR · Traversal Contracts</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
/* PAGE-LOCAL ONLY — ui.css owns field */
:root{
  --goldSoft:rgba(212,175,55,.35);
  --obs1:#070b12;
  --obs2:#0c1626;
  --mut:rgba(255,255,255,.86);
  --mut2:rgba(255,255,255,.70);
}

/* Top */
.g-top{
  position:fixed;left:16px;top:16px;z-index:90;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}
.g-brand{
  position:fixed;left:50%;top:16px;transform:translateX(-50%);
  z-index:80;text-align:center;
  padding:10px 14px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.16);backdrop-filter:blur(8px);
}
.g-brand .t1{font-weight:950;letter-spacing:1.1px;font-size:12px;opacity:.95}
.g-brand .t2{margin-top:2px;font-size:11px;letter-spacing:.6px;opacity:.72}

/* Stage — gem diamond-of-diamonds (4 sections) */
.g-stage{
  position:fixed;left:50%;top:52%;
  transform:translate(-50%,-50%);
  width:min(720px,94vw);height:min(720px,94vw);
  z-index:40;
}
.g-outer{
  position:absolute;left:50%;top:50%;
  width:min(680px,92vw);height:min(680px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  background:
    radial-gradient(circle at 30% 25%, rgba(255,255,255,.08), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.14), transparent 60%),
    linear-gradient(160deg, rgba(14,24,40,.45) 0%, rgba(7,11,18,.62) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 90px 260px rgba(0,0,0,.62),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -50px 90px rgba(0,0,0,.55);
  pointer-events:none;opacity:.85;
}
.g-outer::after{
  content:"";position:absolute;inset:0;border-radius:60px;
  background:repeating-conic-gradient(from 0deg, rgba(255,255,255,.04) 0deg 6deg, transparent 6deg 18deg);
  opacity:.16;
}

:root{ --R:154px; }
.g-d{
  width:170px;height:170px;
  position:absolute;left:50%;top:50%;
  transform-origin:center;border-radius:26px;
  cursor:pointer;-webkit-tap-highlight-color:transparent;
  background:
    radial-gradient(circle at 35% 25%, rgba(255,255,255,.14), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,80,255,.18), transparent 60%),
    linear-gradient(160deg, rgba(12,22,38,.92) 0%, rgba(7,11,18,.95) 70%);
  border:1px solid rgba(255,255,255,.10);
  box-shadow:
    0 28px 84px rgba(0,0,0,.78),
    inset 0 2px 0 rgba(255,255,255,.14),
    inset 0 -28px 44px rgba(0,0,0,.62);
  transition:transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
}
.g-d::before{
  content:"";position:absolute;inset:0;border-radius:26px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.45;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  pointer-events:none;
}
.g-d::after{
  content:"";position:absolute;left:12%;right:12%;top:10%;height:28%;
  border-radius:999px;
  background:linear-gradient(to bottom, rgba(255,255,255,.16), rgba(255,255,255,0));
  opacity:.85;transform:rotate(-10deg);
  pointer-events:none;
}
.g-d:hover{
  transform:translate(-50%,-50%) rotate(45deg) scale(1.02);
  box-shadow:
    0 34px 110px rgba(0,0,0,.88),
    0 0 18px rgba(212,175,55,.18),
    inset 0 2px 0 rgba(255,255,255,.18),
    inset 0 -32px 52px rgba(0,0,0,.68);
}
.g-d.active{
  border-color:rgba(212,175,55,.70);
  box-shadow:
    0 34px 110px rgba(0,0,0,.88),
    0 0 30px rgba(212,175,55,.40),
    inset 0 2px 0 rgba(255,255,255,.18),
    inset 0 -32px 52px rgba(0,0,0,.68);
}

.g-n{ transform:translate(-50%,-50%) translate(0, calc(var(--R) * -1)) rotate(45deg); }
.g-e{ transform:translate(-50%,-50%) translate(var(--R), 0) rotate(45deg); }
.g-s{ transform:translate(-50%,-50%) translate(0, var(--R)) rotate(45deg); }
.g-w{ transform:translate(-50%,-50%) translate(calc(var(--R) * -1), 0) rotate(45deg); }

.g-in{
  width:100%;height:100%;
  transform:rotate(-45deg);
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  text-align:center;padding:16px;gap:10px;
  pointer-events:none;user-select:none;
}
.g-lab{font-weight:950;letter-spacing:.9px;font-size:16px}
.g-sub{font-size:12.5px;opacity:.84;line-height:1.35;max-width:18em}

.g-core{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:74px;height:74px;border-radius:22px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  box-shadow:0 18px 44px rgba(0,0,0,.62), inset 0 2px 0 rgba(255,255,255,.10);
  display:grid;place-items:center;
  font-weight:950;letter-spacing:.5px;opacity:.92;pointer-events:none;
}

/* Dock */
.g-dock{
  position:fixed;left:50%;
  bottom:max(12px, env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:90;
  width:min(980px,94vw);
  display:flex;justify-content:center;gap:10px;flex-wrap:wrap;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  backdrop-filter:blur(8px);
}

/* Modal */
.bd{
  position:fixed;inset:0;z-index:200;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(10px);
  display:none;
}
.bd.show{display:block;}
.modal{
  position:fixed;left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:min(1100px,94vw);
  max-height:88vh;
  display:none;z-index:210;
}
.modal.show{display:block;}
.shell{
  height:88vh;
  border-radius:26px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 52% 14%, rgba(176,0,0,.16), transparent 55%),
    radial-gradient(circle at 38% 28%, rgba(90,140,255,.12), transparent 55%),
    linear-gradient(145deg, rgba(17,22,28,.90), rgba(11,15,20,.94));
  box-shadow:0 60px 180px rgba(0,0,0,.92);
  overflow:hidden;
  display:flex;flex-direction:column;
}
.mhead{
  display:flex;justify-content:space-between;align-items:center;gap:10px;
  padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.08);
}
.mtitle{margin:0;font-weight:950;letter-spacing:.3px;font-size:16px}
.mclose{border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;padding:8px 10px}

.lensbar{
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;
  padding:10px 12px 12px;border-bottom:1px solid rgba(255,255,255,.08);
}
.chip{
  padding:10px 16px;border-radius:999px;
  background:linear-gradient(145deg, rgba(17,22,28,.92), rgba(11,15,20,.96));
  border:1px solid rgba(255,255,255,.10);
  color:#fff;font-weight:900;letter-spacing:.2px;
  cursor:pointer;box-shadow:0 14px 36px rgba(0,0,0,.65);
}
.chip.active{
  border-color:rgba(212,175,55,.70);
  box-shadow:0 18px 50px rgba(0,0,0,.9), 0 0 16px rgba(212,175,55,.30);
}

.mbody{padding:14px 16px 18px;overflow:auto;-webkit-overflow-scrolling:touch;flex:1 1 auto}

.grid4{display:grid;gap:14px}
@media (min-width:920px){ .grid4{grid-template-columns:1fr 1fr} }

.bubble{
  padding:16px 18px;border-radius:22px;
  background:
    radial-gradient(circle at 30% 30%, rgba(120,160,255,.08), transparent 55%),
    linear-gradient(145deg, rgba(12,22,38,.92), rgba(7,11,18,.95));
  border:1px solid rgba(255,255,255,.10);
  box-shadow:0 18px 60px rgba(0,0,0,.70), inset 0 2px 0 rgba(255,255,255,.06);
  position:relative;
}
.bubble::before{
  content:"";position:absolute;inset:0;border-radius:22px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, rgba(212,175,55,.35) 50%, transparent 100%);
  opacity:.55;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  pointer-events:none;
}
.bh{margin:0 0 8px;font-weight:950;letter-spacing:.2px}
.bp{margin:0;color:var(--mut);line-height:1.55}

.mact{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}

@media (max-width:560px){
  :root{ --R: 136px; }
  .g-d{width:158px;height:158px}
  .g-stage{top:54%}
}
</style>
</head>

<body>

<!-- TOP NAV -->
<div class="g-top">
  <a class="crp-btn" id="btnHub" href="/home/">HUB</a>
  <a class="crp-btn" id="btnBack" href="/explore/innovation/language/">BACK</a>
  <a class="crp-btn" id="btnExit" href="/door/">EXIT</a>
</div>

<!-- BRAND -->
<div class="g-brand">
  <div class="t1" id="brand1">GRAMMAR</div>
  <div class="t2" id="brand2">Traversal contracts · structural language.</div>
</div>

<!-- DIAMOND (4 SECTIONS) -->
<div class="g-stage" aria-label="Grammar sections">
  <div class="g-outer"></div>

  <div class="g-d g-n" id="secA" role="button" tabindex="0">
    <div class="g-in">
      <div class="g-lab" id="aLab">HOW IT FEELS</div>
      <div class="g-sub" id="aSub">User experience under constraint.</div>
    </div>
  </div>

  <div class="g-d g-e" id="secB" role="button" tabindex="0">
    <div class="g-in">
      <div class="g-lab" id="bLab">WHY IT MATTERS</div>
      <div class="g-sub" id="bSub">Safety, coherence, scale.</div>
    </div>
  </div>

  <div class="g-d g-w" id="secC" role="button" tabindex="0">
    <div class="g-in">
      <div class="g-lab" id="cLab">HOW IT WORKS</div>
      <div class="g-sub" id="cSub">Contracts, receipts, routing.</div>
    </div>
  </div>

  <div class="g-d g-s" id="secD" role="button" tabindex="0">
    <div class="g-in">
      <div class="g-lab" id="dLab">WHAT’S NEXT</div>
      <div class="g-sub" id="dSub">Roadmap extensions.</div>
    </div>
  </div>

  <div class="g-core">◆</div>
</div>

<!-- DOCK -->
<nav class="g-dock" aria-label="Bottom navigation">
  <a class="crp-btn" id="dockExplore" href="/explore/">EXPLORE</a>
  <a class="crp-btn" id="dockInnovation" href="/explore/?">INNOVATION</a>
  <a class="crp-btn" id="dockLanguage" href="/explore/innovation/language/">LANGUAGE</a>
  <a class="crp-btn crp-btn-primary" id="dockGrammar" href="/explore/innovation/language/grammar/">GRAMMAR</a>
</nav>

<!-- MODAL -->
<div class="bd" id="bd" aria-hidden="true"></div>

<div class="modal" id="modal" role="dialog" aria-modal="true">
  <div class="shell">
    <div class="mhead">
      <h3 class="mtitle" id="mTitle">GRAMMAR</h3>
      <button class="mclose" id="mClose" aria-label="Close" type="button">✕</button>
    </div>

    <!-- LENSES (ONLY) -->
    <div class="lensbar">
      <button class="chip" id="chipStyle" type="button">STYLE: FORMAL</button>
      <button class="chip" id="chipConcept" data-time="origin" type="button">CONCEPT</button>
      <button class="chip" id="chipNow" data-time="now" type="button">NOW</button>
      <button class="chip" id="chipRoadmap" data-time="post" type="button">ROADMAP</button>
    </div>

    <div class="mbody">
      <div class="grid4">
        <div class="bubble"><h4 class="bh" id="h1"></h4><p class="bp" id="p1"></p></div>
        <div class="bubble"><h4 class="bh" id="h2"></h4><p class="bp" id="p2"></p></div>
        <div class="bubble"><h4 class="bh" id="h3"></h4><p class="bp" id="p3"></p></div>
        <div class="bubble"><h4 class="bh" id="h4"></h4><p class="bp" id="p4"></p></div>
      </div>

      <div class="mact">
        <button class="crp-btn" id="mReturn" type="button">RETURN</button>
        <a class="crp-btn" id="mJumpLang" href="/explore/innovation/language/">JUMP LANGUAGE</a>
        <a class="crp-btn" id="mJumpExplore" href="/explore/">JUMP EXPLORE</a>
      </div>
    </div>
  </div>
</div>

<script>
(function(){
  // ===== state =====
  var qs = new URLSearchParams(location.search);
  var qLang = qs.get("lang");
  var qStyle = qs.get("style");
  var qTime = qs.get("time");

  var lang = (qLang==="zh"||qLang==="en") ? qLang : ((localStorage.getItem("gd_lang")==="zh") ? "zh" : "en");
  var style = (qStyle==="formal"||qStyle==="informal") ? qStyle : (localStorage.getItem("gd_style")||"formal");
  var time = (qTime==="origin"||qTime==="now"||qTime==="post") ? qTime : (localStorage.getItem("gd_time")||"now");
  if(time==="trajectory") time="post";

  try{
    localStorage.setItem("gd_lang", lang);
    localStorage.setItem("gd_style", style);
    localStorage.setItem("gd_time", time);
  }catch(e){}

  function q(){ return "lang="+encodeURIComponent(lang)+"&style="+encodeURIComponent(style)+"&time="+encodeURIComponent(time); }

  function wire(){
    var s=q();
    document.getElementById("btnHub").href="/home/?"+s;
    document.getElementById("btnBack").href="/explore/innovation/language/?"+s;
    document.getElementById("btnExit").href="/door/?"+s;

    document.getElementById("dockExplore").href="/explore/?"+s;
    document.getElementById("dockInnovation").href="/explore/?"+s;
    document.getElementById("dockLanguage").href="/explore/innovation/language/?"+s;
    document.getElementById("dockGrammar").href="/explore/innovation/language/grammar/?"+s;

    document.getElementById("mJumpLang").href="/explore/innovation/language/?"+s;
    document.getElementById("mJumpExplore").href="/explore/?"+s;
  }

  // ===== i18n =====
  var L = {
    en:{
      brand1:"GRAMMAR",
      brand2:"Traversal contracts · structural language.",
      sec:{
        A:{lab:"HOW IT FEELS", sub:"User experience under constraint."},
        B:{lab:"WHY IT MATTERS", sub:"Safety, coherence, scale."},
        C:{lab:"HOW IT WORKS", sub:"Contracts, receipts, routing."},
        D:{lab:"WHAT’S NEXT", sub:"Roadmap extensions."}
      },
      lens:{formal:"FORMAL", informal:"INFORMAL", concept:"CONCEPT", now:"NOW", roadmap:"ROADMAP"},
      ret:"RETURN",
      jLang:"JUMP LANGUAGE",
      jExp:"JUMP EXPLORE"
    },
    zh:{
      brand1:"语法",
      brand2:"遍历契约 · 结构化语言。",
      sec:{
        A:{lab:"使用感", sub:"在约束下的体验。"},
        B:{lab:"重要性", sub:"安全 · 一致性 · 规模。"},
        C:{lab:"工作方式", sub:"契约 · 回执 · 路由。"},
        D:{lab:"下一步", sub:"路线图扩展。"}
      },
      lens:{formal:"正式", informal:"非正式", concept:"概念", now:"当前", roadmap:"路线图"},
      ret:"返回",
      jLang:"跳转语言",
      jExp:"跳转探索"
    }
  };
  var T = (lang==="zh") ? L.zh : L.en;
  document.documentElement.lang = (lang==="zh") ? "zh" : "en";

  document.getElementById("brand1").textContent = T.brand1;
  document.getElementById("brand2").textContent = T.brand2;

  document.getElementById("aLab").textContent = T.sec.A.lab;
  document.getElementById("aSub").textContent = T.sec.A.sub;
  document.getElementById("bLab").textContent = T.sec.B.lab;
  document.getElementById("bSub").textContent = T.sec.B.sub;
  document.getElementById("cLab").textContent = T.sec.C.lab;
  document.getElementById("cSub").textContent = T.sec.C.sub;
  document.getElementById("dLab").textContent = T.sec.D.lab;
  document.getElementById("dSub").textContent = T.sec.D.sub;

  document.getElementById("mReturn").textContent = T.ret;
  document.getElementById("mJumpLang").textContent = T.jLang;
  document.getElementById("mJumpExplore").textContent = T.jExp;

  // ===== content (4 sections × 4 bubbles × time × style) =====
  function C(h,p){ return {h:h, p:p}; }

  var CONTENT = {
    A:{ // FEELS
      origin:{
        formal:[
          C("Orientation stays locked","Language stays selected, so the interface never ‘forgets’ what you chose between pages or returns."),
          C("Tone stays consistent","Formal mode reads like a contract: precise terms, no implied intent, and bounded statements only."),
          C("Time layer stays consistent","Concept view keeps you in foundations, so you don’t bounce into live details unexpectedly."),
          C("Navigation feels reversible","You can go deep, return, and nothing collapses—routes remain stable and recoverable.")
        ],
        informal:[
          C("You don’t get lost","Language sticks. The site doesn’t reset randomly, so you stay oriented."),
          C("It speaks plainly","Informal mode keeps it short and direct—no academic fog."),
          C("Concept keeps it clean","You’re learning the idea, not drowning in implementation detail."),
          C("You can tap around safely","Exploration doesn’t punish you—return paths stay obvious.")
        ]
      },
      now:{
        formal:[
          C("No drift in-session","Active selections persist (gd_*), so the user sees continuity across clicks and pages."),
          C("Live copy is operational","Now view focuses on what is enforced today and where the contract is applied."),
          C("Reading stays scannable","Four bubbles keep density high without turning into walls of text."),
          C("Interaction stays deterministic","Same inputs produce the same outputs; UI never ‘guesses’ what you meant.")
        ],
        informal:[
          C("It feels stable","You can switch around and it stays coherent."),
          C("Now means ‘what’s live’","You see what exists today, not long theory."),
          C("Fast skim, real meaning","Four bubbles give you enough without a scroll marathon."),
          C("It behaves the same every time","No random jumps, no surprise resets.")
        ]
      },
      post:{
        formal:[
          C("Roadmap stays structured","Roadmap is scoped and plugs into the same contract."),
          C("Upgrades won’t break you","New content expands inside the same topology."),
          C("Growth still feels safe","State discipline keeps navigation coherent at scale."),
          C("It becomes a reference surface","Roadmap bubbles explain what changes and what stays invariant.")
        ],
        informal:[
          C("Roadmap is readable","It tells you what’s coming without jargon overload."),
          C("New stuff won’t wreck old stuff","Structure stays the same when features expand."),
          C("Scaling still feels calm","More pages, same rules."),
          C("It turns into a real map","You’ll know where to go next, every time.")
        ]
      }
    },
    B:{ // MATTERS
      origin:{
        formal:[
          C("Prevents silent meaning shifts","Grammar contracts stop terms from changing underneath the user as content evolves."),
          C("Supports audit-grade reading","Formal phrasing keeps ambiguity bounded and claims testable."),
          C("Makes traversal study possible","Grammar defines how concepts connect across nodes, not just within chapters."),
          C("Stops ‘pretty confusion’","Beauty without contract drifts; grammar is the contract.")
        ],
        informal:[
          C("Stops drift","Words don’t change their meaning randomly."),
          C("Makes it trustworthy","Formal mode is careful—no storytelling as fact."),
          C("Lets you learn by moving","You don’t need one long article to ‘get it.’"),
          C("Keeps beauty from lying","Nice UI without rules still confuses people—this prevents that.")
        ]
      },
      now:{
        formal:[
          C("Protects navigation integrity","Routing defined by grammar prevents state forks and mismatched pages."),
          C("Protects the user’s time","Bubbles replace long paragraphs with faster comprehension."),
          C("Protects cross-page coherence","Language/style/time remain stable across the project surface."),
          C("Protects scale readiness","You can add pages without breaking the mental model.")
        ],
        informal:[
          C("Keeps the site from breaking","Rules stop random drift."),
          C("Saves time","You can skim and still understand."),
          C("Keeps your settings","Language/style/time stay consistent."),
          C("Lets you scale fast","Add pages without chaos.")
        ]
      },
      post:{
        formal:[
          C("Enables multi-language growth","EN/中文 remain canonical; overlays can be added without breaking meaning."),
          C("Enables productization","Grammar becomes reusable across products, laws, and gauges."),
          C("Enables consistent onboarding","Users learn the map once and traverse new branches safely."),
          C("Enables verification","Roadmap items tie to evidence, receipts, and reproducible artifacts.")
        ],
        informal:[
          C("More languages later","Without messing up the core."),
          C("Turns into a real product layer","Not just a website trick."),
          C("New users learn fast","They learn the map once."),
          C("Future work can be proven","Not just promised.")
        ]
      }
    },
    C:{ // WORKS
      origin:{
        formal:[
          C("Canonical state keys","gd_lang, gd_style, gd_time persist; internal links carry them forward deterministically."),
          C("Lens separation","Lenses live inside modal only, so the main page stays clean and action-first."),
          C("Contracted copy rules","Style/time must change text meaning, not just button highlights."),
          C("Uniform presentation","All pages reuse the same gem + modal structure for predictable behavior.")
        ],
        informal:[
          C("It saves your settings","Language/style/time stick."),
          C("Lenses stay inside the bubble","Main page stays clean."),
          C("Buttons actually change meaning","Not just a glow—real text changes."),
          C("Everything behaves the same","Same gem pattern everywhere.")
        ]
      },
      now:{
        formal:[
          C("Deterministic routing","The same click produces the same destination; back does not corrupt state."),
          C("Centered modal containment","Backdrop + centered shell prevent scroll-jumps and keep focus."),
          C("Four-bubble density rule","Each section is always 4 bubbles—no empty nodes."),
          C("Roadmap labeling","UI says ROADMAP; internal key remains post for compatibility.")
        ],
        informal:[
          C("Clicks go where they should","No random behavior."),
          C("Modal stays centered","No weird jump scroll."),
          C("No empty bubbles","Always something worth reading."),
          C("Roadmap is Roadmap","Not ‘POST’ on screen.")
        ]
      },
      post:{
        formal:[
          C("Extensible contract","New pages plug into the same propagation and modal lensing."),
          C("Version discipline","Roadmap can point to versioned schemas, receipts, and tests."),
          C("Overlay discipline","Additional languages layer safely while EN/中文 remain anchors."),
          C("Evidence integration","Roadmap bubbles can reference bundles, registries, and audits.")
        ],
        informal:[
          C("Add more pages safely","Same rules."),
          C("Roadmap can be versioned","So it’s real."),
          C("More languages later","Without chaos."),
          C("Future connects to proof","Not just text.")
        ]
      }
    },
    D:{ // NEXT
      origin:{
        formal:[
          C("Define the trunk glossary","Lock the key terms used across Innovation so future pages don’t drift."),
          C("Clone this pattern","Each leaf page copies lens + 4-bubble contract."),
          C("Add executable examples","Small examples that prove the claim, not long essays."),
          C("Connect to products cleanly","Innovation references deployed surfaces without overclaiming.")
        ],
        informal:[
          C("Lock the words","So meanings don’t drift."),
          C("Clone the pattern","Same lenses, same bubbles."),
          C("Show tiny proofs","Short examples that demonstrate."),
          C("Connect clearly","Innovation = future; Products = deployed.")
        ]
      },
      now:{
        formal:[
          C("Build sibling leaves","SSG, DOT.GRID, Acronyms become sibling pages under Language."),
          C("Keep routing deterministic","All links carry lang/style/time."),
          C("Fill before branching deeper","No empty nodes: 4 bubbles before deeper paths."),
          C("Keep jump controls consistent","RETURN + JUMP parent + JUMP explore on every modal.")
        ],
        informal:[
          C("Make the sibling pages","SSG / DOT.GRID / Acronyms."),
          C("Keep links carrying state","Always."),
          C("Fill bubbles first","No empty pages."),
          C("Keep jumps consistent","Return + jump up.")
        ]
      },
      post:{
        formal:[
          C("Expand the other trunks","Execution/Measurement/Governance gain the same leaf structure as Language."),
          C("Keep consumer-legible framing","Readable to the public while still bounded and non-drifting."),
          C("Instrument the build","Add simple route checks to catch 404 immediately."),
          C("Publish a stable index","Innovation becomes encyclopedic traversal, not linear reading.")
        ],
        informal:[
          C("Expand the other trunks","Same pattern."),
          C("Make it readable for normal people","Still accurate."),
          C("Add simple checks","Catch broken links fast."),
          C("Make Innovation a real encyclopedia","Traversal study, not chapters.")
        ]
      }
    }
  };

  // ===== modal logic =====
  var bd=document.getElementById("bd");
  var modal=document.getElementById("modal");
  var mClose=document.getElementById("mClose");
  var mTitle=document.getElementById("mTitle");

  var chipStyle=document.getElementById("chipStyle");
  var chipConcept=document.getElementById("chipConcept");
  var chipNow=document.getElementById("chipNow");
  var chipRoadmap=document.getElementById("chipRoadmap");

  var h1=document.getElementById("h1"),p1=document.getElementById("p1");
  var h2=document.getElementById("h2"),p2=document.getElementById("p2");
  var h3=document.getElementById("h3"),p3=document.getElementById("p3");
  var h4=document.getElementById("h4"),p4=document.getElementById("p4");

  var activeSec="A"; // A/B/C/D from outer diamonds

  function persist(){
    try{ localStorage.setItem("gd_style", style); localStorage.setItem("gd_time", time);}catch(e){}
  }

  function setLensLabels(){
    chipStyle.textContent = "STYLE: " + (style==="formal" ? T.lens.formal : T.lens.informal);
    chipConcept.textContent = T.lens.concept;
    chipNow.textContent = T.lens.now;
    chipRoadmap.textContent = T.lens.roadmap;

    chipConcept.classList.toggle("active", time==="origin");
    chipNow.classList.toggle("active", time==="now");
    chipRoadmap.classList.toggle("active", time==="post");
  }

  function setActiveDiamond(){
    ["secA","secB","secC","secD"].forEach(function(id){
      var on = (id==="secA" && activeSec==="A") ||
               (id==="secB" && activeSec==="B") ||
               (id==="secC" && activeSec==="C") ||
               (id==="secD" && activeSec==="D");
      document.getElementById(id).classList.toggle("active", on);
    });
  }

  function titleForSec(){
    if(activeSec==="A") return T.sec.A.lab;
    if(activeSec==="B") return T.sec.B.lab;
    if(activeSec==="C") return T.sec.C.lab;
    return T.sec.D.lab;
  }

  function render(){
    persist();
    wire();
    setLensLabels();
    setActiveDiamond();

    var bubbles = CONTENT[activeSec][time][style];
    mTitle.textContent = T.brand1 + " · " + titleForSec();

    h1.textContent=bubbles[0].h; p1.textContent=bubbles[0].p;
    h2.textContent=bubbles[1].h; p2.textContent=bubbles[1].p;
    h3.textContent=bubbles[2].h; p3.textContent=bubbles[2].p;
    h4.textContent=bubbles[3].h; p4.textContent=bubbles[3].p;
  }

  function open(secKey){
    activeSec = secKey;
    render();
    bd.classList.add("show");
    modal.classList.add("show");
  }
  function close(){
    bd.classList.remove("show");
    modal.classList.remove("show");
    ["secA","secB","secC","secD"].forEach(function(id){ document.getElementById(id).classList.remove("active"); });
  }

  // Outer diamond clicks
  document.getElementById("secA").onclick=function(){ open("A"); };
  document.getElementById("secB").onclick=function(){ open("B"); };
  document.getElementById("secC").onclick=function(){ open("C"); };
  document.getElementById("secD").onclick=function(){ open("D"); };

  ["secA","secB","secC","secD"].forEach(function(id){
    var el=document.getElementById(id);
    el.addEventListener("keydown", function(e){
      if(e.key==="Enter"||e.key===" "){ e.preventDefault(); el.click(); }
    });
  });

  // Lenses (modal only)
  chipStyle.onclick=function(){ style = (style==="formal") ? "informal" : "formal"; render(); };
  chipConcept.onclick=function(){ time="origin"; render(); };
  chipNow.onclick=function(){ time="now"; render(); };
  chipRoadmap.onclick=function(){ time="post"; render(); };

  // Close
  bd.onclick=close;
  mClose.onclick=close;
  document.getElementById("mReturn").onclick=close;

  // First wire (no open)
  wire();
  setLensLabels();

})();
</script>

</body>
</html>
```0
