<!-- TNT — /door/index.html (DOOR · LANGUAGE SELECT · DUAL DIAMOND OVERLAP · TAP-SAFE · STATE CARRY)
     PURPOSE:
       - Restore Door from scratch with two overlapping language diamonds (EN/中文).
       - Single-language selection sets gd_lang and routes to /index.html with full state (?lang=&style=&time=).
       - Uses only gd_lang/gd_style/gd_time. No new keys.
       - ui.css owns field. branch.css untouched.
-->

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>DOOR · Cardinal Axis</title>

<link rel="stylesheet" href="/assets/ui.css"/>
<link rel="stylesheet" href="/assets/branch.css"/>

<style>
:root{
  /* Overlap geometry */
  --D:210px;      /* diamond size */
  --R:86px;       /* translate distance (smaller than D/2 => overlap) */

  /* Pearlescent lacquer (match your working Energy) */
  --goldSoft:rgba(212,175,55,.45);
  --obsA:rgba(12,22,38,.95);
  --obsB:rgba(6,10,16,.98);
}

/* base */
body{margin:0;color:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
a{text-decoration:none;color:inherit}

/* top-left */
.top-left{
  position:fixed;left:16px;top:16px;z-index:120;
  display:flex;gap:10px;flex-wrap:wrap;align-items:center;
}

/* fixed header (non-interactive) */
.headFixed{
  position:fixed;
  left:50%;
  top:64px;
  transform:translateX(-50%);
  width:min(760px,94vw);
  z-index:110;
  text-align:center;
  pointer-events:none;
}
.kicker{
  margin:0 0 10px 0;
  font-size:12px;
  letter-spacing:3px;
  text-transform:uppercase;
  opacity:.78;
  text-shadow:0 18px 60px rgba(0,0,0,.60);
}
.title{
  margin:0;
  font-size:52px;
  font-weight:950;
  letter-spacing:.2px;
  line-height:1.02;
  text-shadow:0 18px 60px rgba(0,0,0,.60);
}
.sub{
  margin:10px auto 0;
  max-width:56ch;
  opacity:.84;
  font-size:16px;
  line-height:1.35;
  text-shadow:0 18px 60px rgba(0,0,0,.55);
}

/* stage */
.stage{
  position:fixed;
  left:50%;
  top:56%;
  transform:translate(-50%,-50%);
  width:min(560px,92vw);
  height:min(560px,92vw);
  z-index:60;
  pointer-events:none;
}

/* subtle outer shell for presence (visual only) */
.outer{
  position:absolute;left:50%;top:50%;
  width:min(560px,92vw);height:min(560px,92vw);
  transform:translate(-50%,-50%) rotate(45deg);
  border-radius:60px;
  border:1px solid rgba(255,255,255,.10);
  background:
    radial-gradient(circle at 50% 14%, rgba(176,0,0,.18), transparent 55%),
    radial-gradient(circle at 40% 25%, rgba(90,140,255,.10), transparent 55%),
    linear-gradient(160deg, rgba(14,24,40,.38) 0%, rgba(7,11,18,.56) 70%);
  box-shadow:
    0 90px 260px rgba(0,0,0,.55),
    inset 0 2px 0 rgba(255,255,255,.10),
    inset 0 -50px 90px rgba(0,0,0,.50);
  opacity:.55;
  pointer-events:none;
}
.outer::after{
  content:"";
  position:absolute;inset:0;border-radius:60px;
  background:repeating-conic-gradient(from 0deg, rgba(212,175,55,.04) 0deg 6deg, transparent 6deg 18deg);
  opacity:.12;
  pointer-events:none;
}

/* diamonds */
.d{
  width:var(--D);height:var(--D);
  position:absolute;left:50%;top:50%;
  transform-origin:center;
  border-radius:28px;
  cursor:pointer;
  pointer-events:auto;
  touch-action:manipulation;
  -webkit-tap-highlight-color:transparent;

  background:
    radial-gradient(circle at 30% 22%, rgba(255,255,255,.45), transparent 48%),
    radial-gradient(circle at 70% 78%, rgba(0,120,255,.25), transparent 60%),
    linear-gradient(160deg, var(--obsA), var(--obsB));

  border:1px solid rgba(255,255,255,.16);
  box-shadow:
    0 38px 120px rgba(0,0,0,.82),
    0 0 32px rgba(212,175,55,.22),
    inset 0 2px 0 rgba(255,255,255,.22),
    inset 0 -40px 72px rgba(0,0,0,.78);

  transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease;
  overflow:hidden;
}
.d::before{
  content:"";
  position:absolute;inset:0;border-radius:28px;padding:1px;
  background:linear-gradient(120deg, transparent 0%, var(--goldSoft) 50%, transparent 100%);
  opacity:.60;
  -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask-composite:xor; mask-composite:exclude;
  pointer-events:none;
}
.d::after{
  content:"";
  position:absolute;left:10%;right:10%;top:10%;height:28%;
  border-radius:999px;
  background:linear-gradient(to bottom, rgba(255,255,255,.22), rgba(255,255,255,0));
  transform:rotate(-10deg);
  pointer-events:none;
}
.d:hover{
  border-color:rgba(212,175,55,.28);
  box-shadow:
    0 44px 140px rgba(0,0,0,.90),
    0 0 40px rgba(212,175,55,.26),
    inset 0 2px 0 rgba(255,255,255,.24),
    inset 0 -48px 86px rgba(0,0,0,.82);
}
.d:active{ transform:translate(-50%,-50%) rotate(45deg) scale(.99); }

.d-en{ transform:translate(-50%,-50%) translate(0, calc(var(--R) * -1)) rotate(45deg); z-index:2; }
.d-zh{ transform:translate(-50%,-50%) translate(0, var(--R)) rotate(45deg); z-index:1; }

/* inner label */
.inner{
  width:100%;height:100%;
  transform:rotate(-45deg);
  display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  text-align:center;
  padding:16px;
  gap:8px;
  pointer-events:none;
  user-select:none;
}
.lab{
  font-weight:950;
  letter-spacing:.9px;
  font-size:20px;
  text-shadow:0 0 18px rgba(255,255,255,.10);
}
.hint{
  font-size:12.5px;
  opacity:.82;
}

/* footer */
.footer{
  position:fixed;
  left:50%;
  bottom:calc(18px + env(safe-area-inset-bottom));
  transform:translateX(-50%);
  z-index:85;
  width:min(760px,94vw);
  text-align:center;
  opacity:.74;
  font-size:13px;
  line-height:1.35;
  pointer-events:none;
  text-shadow:0 18px 60px rgba(0,0,0,.55);
}

/* responsive */
@media (max-width:520px){
  :root{ --D:200px; --R:78px; }
  .title{ font-size:46px; }
  .sub{ font-size:15px; }
  .headFixed{ top:56px; }
  .stage{ top:58%; }
}
</style>
</head>

<body>

<div class="top-left">
  <a class="btn" id="btnExit" href="/home/">EXIT</a>
</div>

<div class="headFixed" aria-hidden="true">
  <p class="kicker" id="kicker">CARDINAL AXIS</p>
  <h1 class="title" id="title">Select language</h1>
  <p class="sub" id="subtitle">Choose a canonical language to enter the system.</p>
</div>

<div class="stage" aria-label="Language diamonds">
  <div class="outer"></div>

  <div class="d d-en" id="pickEN" role="button" tabindex="0" aria-label="English">
    <div class="inner">
      <div class="lab">ENGLISH</div>
      <div class="hint">Tap to enter</div>
    </div>
  </div>

  <div class="d d-zh" id="pickZH" role="button" tabindex="0" aria-label="Chinese">
    <div class="inner">
      <div class="lab">中文</div>
      <div class="hint">点按进入</div>
    </div>
  </div>
</div>

<div class="footer" id="foot">Coherence-based traversal study · under construction · safe to explore</div>

<script>
(function(){
  // URL → STATE HYDRATION (gd_* only)
  var qs = new URLSearchParams(location.search);
  var style = qs.get("style") || localStorage.getItem("gd_style") || "formal";
  var time  = qs.get("time")  || localStorage.getItem("gd_time")  || "now";
  if(time==="trajectory") time="post";
  if(style!=="formal" && style!=="informal") style="formal";
  if(time!=="origin" && time!=="now" && time!=="post") time="now";

  function go(lang){
    try{
      localStorage.setItem("gd_lang", lang);
      localStorage.setItem("gd_style", style);
      localStorage.setItem("gd_time", time);
    }catch(e){}
    var q = "lang="+encodeURIComponent(lang)+"&style="+encodeURIComponent(style)+"&time="+encodeURIComponent(time);
    window.location.href = "/index.html?"+q;
  }

  // EXIT preserves current state (fallback lang=en)
  (function(){
    var curLang = qs.get("lang") || localStorage.getItem("gd_lang") || "en";
    if(curLang!=="en" && curLang!=="zh") curLang="en";
    var q = "lang="+encodeURIComponent(curLang)+"&style="+encodeURIComponent(style)+"&time="+encodeURIComponent(time);
    document.getElementById("btnExit").href = "/home/?"+q;
  })();

  function bind(el, lang){
    el.addEventListener("click", function(){ go(lang); });
    el.addEventListener("keydown", function(e){
      if(e.key==="Enter"||e.key===" "){ e.preventDefault(); go(lang); }
    });
  }

  bind(document.getElementById("pickEN"), "en");
  bind(document.getElementById("pickZH"), "zh");
})();
</script>

</body>
</html>
